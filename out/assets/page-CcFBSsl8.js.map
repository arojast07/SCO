{"version":3,"file":"page-CcFBSsl8.js","sources":["../../src/pages/cotizaciones/components/CotizacionesLayout.tsx","../../src/pages/cotizaciones/components/CotizacionForm.tsx","../../src/pages/cotizaciones/components/CotizacionesFilters.tsx","../../src/pages/cotizaciones/components/CotizacionesTable.tsx","../../src/pages/cotizaciones/page.tsx"],"sourcesContent":["\nimport { ReactNode, useState } from 'react';\nimport Sidebar from '../../../components/feature/Sidebar';\nimport TopBar from '../../../components/feature/TopBar';\nimport MobileNav from '../../../components/feature/MobileNav';\n\ninterface CotizacionesLayoutProps {\n  children: ReactNode;\n}\n\nexport function CotizacionesLayout({ children }: CotizacionesLayoutProps) {\n  const [sidebarOpen, setSidebarOpen] = useState(false);\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex\">\n      {/* Sidebar */}\n      <Sidebar isOpen={sidebarOpen} onClose={() => setSidebarOpen(false)} />\n\n      {/* Contenido principal */}\n      <div className=\"flex-1 flex flex-col min-w-0\">\n        {/* TopBar */}\n        <TopBar onMenuClick={() => setSidebarOpen(true)} />\n        \n        {/* Contenido */}\n        <main className=\"flex-1 p-4 lg:p-6 pb-20 lg:pb-6 overflow-auto\">\n          <div className=\"max-w-7xl mx-auto\">\n            {children}\n          </div>\n        </main>\n      </div>\n\n      {/* Navegaci√≥n m√≥vil */}\n      <MobileNav />\n    </div>\n  );\n}","\nimport { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\nimport { CotizacionFormData, CotizacionItem } from '../../../types/cotizacion';\nimport { formatCurrency, formatNumber, parseCurrency } from '../../../lib/currency';\nimport { CotizacionService } from '../../../services/cotizacionService';\n\ninterface Cliente {\n  id: number;\n  nombre_razon_social: string;\n  identificacion: string;\n  correo_principal?: string;\n}\n\ninterface Producto {\n  id_producto: number;\n  codigo_producto: string;\n  descripcion_producto: string;\n  costo_total_bom: number;\n}\n\ninterface CotizacionFormProps {\n  cotizacion?: any;\n  onSubmit: (data: CotizacionFormData) => void;\n  onCancel: () => void;\n  isOpen: boolean;\n}\n\nexport function CotizacionForm({ cotizacion, onSubmit, onCancel, isOpen }: CotizacionFormProps) {\n  const [formData, setFormData] = useState<CotizacionFormData>({\n    cliente_id: '',\n    estado: 'borrador',\n    fecha_emision: new Date().toISOString().split('T')[0],\n    fecha_vencimiento: '',\n    moneda: 'CRC',\n    tipo_cambio: 520,\n    descuento_global: 0,\n    descuento_valor: 0,\n    impuestos: 0,\n    flete: 0,\n    otros: 0,\n    subtotal: 0,\n    total: 0,\n    items: []\n  });\n\n  const [clientes, setClientes] = useState<Cliente[]>([]);\n  const [clientesFiltrados, setClientesFiltrados] = useState<Cliente[]>([]);\n  const [busquedaCliente, setBusquedaCliente] = useState('');\n  const [mostrarListaClientes, setMostrarListaClientes] = useState(false);\n  const [clienteSeleccionado, setClienteSeleccionado] = useState<Cliente | null>(null);\n\n  const [productos, setProductos] = useState<Producto[]>([]);\n  const [productosFiltrados, setProductosFiltrados] = useState<Producto[]>([]);\n  const [busquedaProducto, setBusquedaProducto] = useState('');\n  const [mostrarListaProductos, setMostrarListaProductos] = useState(false);\n\n  const [loading, setLoading] = useState(false);\n  const [actualizandoTipoCambio, setActualizandoTipoCambio] = useState(false);\n  const [mensajeTipoCambio, setMensajeTipoCambio] = useState('Tipo de cambio seg√∫n Banco Central de Costa Rica (BCCR). Haga clic en actualizar para obtener el valor m√°s reciente.');\n\n  // Cargar datos cuando se abre el modal\n  useEffect(() => {\n    if (isOpen) {\n      cargarClientes();\n      cargarProductos();\n      obtenerTipoCambio();\n      \n      // Configurar fecha de vencimiento por defecto (hoy + 15 d√≠as)\n      const fechaVencimiento = new Date();\n      fechaVencimiento.setDate(fechaVencimiento.getDate() + 15);\n      \n      if (cotizacion) {\n        // MODO EDICI√ìN: Cargar datos de la cotizaci√≥n existente\n        console.log('Cargando cotizaci√≥n para editar:', cotizacion);\n        cargarDatosCotizacion(cotizacion);\n      } else {\n        // MODO CREACI√ìN: Configurar valores por defecto\n        setFormData(prev => ({\n          ...prev,\n          fecha_vencimiento: fechaVencimiento.toISOString().split('T')[0]\n        }));\n      }\n    }\n  }, [cotizacion, isOpen]);\n\n  // Funci√≥n para cargar datos de cotizaci√≥n existente\n  const cargarDatosCotizacion = async (cotizacionData: any) => {\n    try {\n      console.log('Datos de cotizaci√≥n recibidos:', cotizacionData);\n      \n      // Cargar datos b√°sicos de la cotizaci√≥n\n      setFormData({\n        cliente_id: cotizacionData.cliente_id?.toString() || '',\n        estado: cotizacionData.estado || 'borrador',\n        fecha_emision: cotizacionData.fecha_emision || new Date().toISOString().split('T')[0],\n        fecha_vencimiento: cotizacionData.fecha_vencimiento || '',\n        moneda: cotizacionData.moneda || 'CRC',\n        tipo_cambio: cotizacionData.tipo_cambio || 520,\n        descuento_global: cotizacionData.descuento_global || 0,\n        descuento_valor: cotizacionData.descuento_valor || 0,\n        impuestos: cotizacionData.impuestos || 0,\n        flete: cotizacionData.flete || 0,\n        otros: cotizacionData.otros || 0,\n        subtotal: cotizacionData.subtotal || 0,\n        total: cotizacionData.total || 0,\n        items: [] // Se cargar√° despu√©s\n      });\n\n      // Configurar cliente seleccionado\n      if (cotizacionData.clientes) {\n        setClienteSeleccionado(cotizacionData.clientes);\n        setBusquedaCliente(cotizacionData.clientes.nombre_razon_social);\n      }\n\n      // Cargar items de la cotizaci√≥n con informaci√≥n completa\n      if (cotizacionData.id) {\n        await cargarItemsCotizacion(cotizacionData.id);\n      }\n      \n    } catch (error) {\n      console.error('Error cargando datos de cotizaci√≥n:', error);\n    }\n  };\n\n  // Funci√≥n para cargar items de la cotizaci√≥n con informaci√≥n de productos\n  const cargarItemsCotizacion = async (cotizacionId: number) => {\n    try {\n      console.log('Cargando items de cotizaci√≥n:', cotizacionId);\n      \n      // Primero obtener los items de la cotizaci√≥n\n      const { data: items, error } = await supabase\n        .from('cotizacion_items')\n        .select('*')\n        .eq('cotizacion_id', cotizacionId);\n\n      if (error) {\n        console.error('Error cargando items:', error);\n        return;\n      }\n\n      console.log('Items cargados:', items);\n\n      if (items && items.length > 0) {\n        // Obtener los IDs √∫nicos de productos\n        const productosIds = [...new Set(items.map(item => item.producto_id))].filter(id => id);\n        \n        let productosInfo: any[] = [];\n        \n        // Si hay productos, cargar su informaci√≥n por separado\n        if (productosIds.length > 0) {\n          const { data: productos, error: productosError } = await supabase\n            .from('productos')\n            .select('id_producto, codigo_producto, descripcion_producto, costo_total_bom')\n            .in('id_producto', productosIds);\n\n          if (!productosError && productos) {\n            productosInfo = productos;\n          }\n        }\n\n        // Formatear items con informaci√≥n de productos\n        const itemsFormateados = items.map((item: any) => {\n          // Buscar informaci√≥n del producto\n          const productoInfo = productosInfo.find(p => p.id_producto === item.producto_id);\n          \n          return {\n            producto_id: item.producto_id,\n            cantidad: item.cantidad || 1,\n            precio_unitario: item.precio_unitario || 0,\n            descuento: item.descuento || 0,\n            subtotal: item.subtotal || item.total_linea || 0,\n            // Agregar informaci√≥n del producto para mostrar en la tabla\n            producto_info: productoInfo || {\n              codigo_producto: 'N/A',\n              descripcion_producto: item.descripcion || `Producto ID: ${item.producto_id}`,\n              costo_total_bom: item.precio_unitario || 0\n            }\n          };\n        });\n\n        console.log('Items formateados:', itemsFormateados);\n\n        setFormData(prev => ({\n          ...prev,\n          items: itemsFormateados\n        }));\n\n        // Recalcular totales con los items cargados\n        calcularTotales(itemsFormateados);\n      }\n      \n    } catch (error) {\n      console.error('Error cargando items de cotizaci√≥n:', error);\n    }\n  };\n\n  const cargarClientes = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('clientes')\n        .select('id, nombre_razon_social, identificacion, correo_principal')\n        .order('nombre_razon_social');\n\n      if (error) throw error;\n      setClientes(data || []);\n    } catch (error) {\n      console.error('Error cargando clientes:', error);\n    }\n  };\n\n  const cargarProductos = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('productos')\n        .select('id_producto, codigo_producto, descripcion_producto, costo_total_bom')\n        .order('descripcion_producto');\n\n      if (error) throw error;\n      setProductos(data || []);\n    } catch (error) {\n      console.error('Error cargando productos:', error);\n    }\n  };\n\n  const obtenerTipoCambio = async () => {\n    try {\n      setActualizandoTipoCambio(true);\n      \n      // Usar el nuevo m√©todo del servicio para obtener tipo de cambio del BCCR\n      const tipoCambio = await CotizacionService.obtenerTipoCambioBCCR();\n      \n      setFormData(prev => ({\n        ...prev,\n        tipo_cambio: tipoCambio\n      }));\n      \n      // Actualizar el mensaje informativo\n      setMensajeTipoCambio(`üí∞ Tipo de cambio actualizado seg√∫n BCCR: ‚Ç°${formatNumber(tipoCambio)} por USD`);\n    } catch (error) {\n      console.error('Error obteniendo tipo de cambio:', error);\n      setMensajeTipoCambio('‚ùå Error al obtener tipo de cambio del BCCR. Usando valor por defecto.');\n    } finally {\n      setActualizandoTipoCambio(false);\n    }\n  };\n\n  const filtrarClientes = (busqueda: string) => {\n    setBusquedaCliente(busqueda);\n    \n    if (busqueda.length === 0) {\n      setClientesFiltrados([]);\n      setMostrarListaClientes(false);\n      setClienteSeleccionado(null);\n      setFormData(prev => ({ ...prev, cliente_id: '' }));\n      return;\n    }\n\n    const filtrados = clientes.filter(cliente =>\n      cliente.nombre_razon_social.toLowerCase().includes(busqueda.toLowerCase()) ||\n      cliente.identificacion.includes(busqueda)\n    );\n\n    setClientesFiltrados(filtrados);\n    setMostrarListaClientes(filtrados.length > 0);\n  };\n\n  const seleccionarCliente = (cliente: Cliente) => {\n    setClienteSeleccionado(cliente);\n    setBusquedaCliente(cliente.nombre_razon_social);\n    setMostrarListaClientes(false);\n    setFormData(prev => ({ ...prev, cliente_id: cliente.id.toString() }));\n  };\n\n  const filtrarProductos = (busqueda: string) => {\n    setBusquedaProducto(busqueda);\n    \n    if (busqueda.length === 0) {\n      setProductosFiltrados([]);\n      setMostrarListaProductos(false);\n      return;\n    }\n\n    const filtrados = productos.filter(producto =>\n      producto.descripcion_producto.toLowerCase().includes(busqueda.toLowerCase()) ||\n      producto.codigo_producto.toLowerCase().includes(busqueda.toLowerCase())\n    );\n\n    setProductosFiltrados(filtrados);\n    setMostrarListaProductos(filtrados.length > 0);\n  };\n\n  const agregarProducto = (producto: Producto) => {\n    const nuevoItem: CotizacionItem = {\n      producto_id: producto.id_producto,\n      cantidad: 1,\n      precio_unitario: producto.costo_total_bom || 0,\n      descuento: 0,\n      subtotal: producto.costo_total_bom || 0\n    };\n\n    const nuevosItems = [...formData.items, nuevoItem];\n    setFormData(prev => ({\n      ...prev,\n      items: nuevosItems\n    }));\n\n    setBusquedaProducto('');\n    setMostrarListaProductos(false);\n    calcularTotales(nuevosItems);\n  };\n\n  const actualizarItem = (index: number, campo: keyof CotizacionItem, valor: any) => {\n    const nuevosItems = [...formData.items];\n    nuevosItems[index] = { ...nuevosItems[index], [campo]: valor };\n\n    // Recalcular total del item\n    if (campo === 'cantidad' || campo === 'precio_unitario' || campo === 'descuento') {\n      const item = nuevosItems[index];\n      const subtotalItem = item.cantidad * item.precio_unitario;\n      const descuentoItem = subtotalItem * (item.descuento / 100);\n      item.subtotal = subtotalItem - descuentoItem;\n    }\n\n    setFormData(prev => ({ ...prev, items: nuevosItems }));\n    calcularTotales(nuevosItems);\n  };\n\n  const eliminarItem = (index: number) => {\n    const nuevosItems = formData.items.filter((_, i) => i !== index);\n    setFormData(prev => ({ ...prev, items: nuevosItems }));\n    calcularTotales(nuevosItems);\n  };\n\n  const calcularTotales = (items: CotizacionItem[]) => {\n    const subtotal = items.reduce((sum, item) => sum + (item.subtotal || 0), 0);\n    const descuentoValor = subtotal * (formData.descuento_global / 100);\n    const baseImponible = subtotal - descuentoValor;\n    const impuestos = baseImponible * 0.13; // 13% IVA\n    const total = baseImponible + impuestos + formData.flete + formData.otros;\n\n    setFormData(prev => ({\n      ...prev,\n      subtotal,\n      descuento_valor: descuentoValor,\n      impuestos,\n      total\n    }));\n  };\n\n  const handleInputChange = (campo: keyof CotizacionFormData, valor: any) => {\n    setFormData(prev => {\n      const newData = { ...prev, [campo]: valor };\n      \n      // Recalcular totales si cambian campos que afectan el c√°lculo\n      if (['descuento_global', 'flete', 'otros'].includes(campo)) {\n        const subtotal = newData.items.reduce((sum, item) => sum + (item.subtotal || 0), 0);\n        const descuentoValor = subtotal * (newData.descuento_global / 100);\n        const baseImponible = subtotal - descuentoValor;\n        const impuestos = baseImponible * 0.13;\n        const total = baseImponible + impuestos + newData.flete + newData.otros;\n\n        return {\n          ...newData,\n          subtotal,\n          descuento_valor: descuentoValor,\n          impuestos,\n          total\n        };\n      }\n      \n      return newData;\n    });\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!formData.cliente_id) {\n      alert('Por favor seleccione un cliente');\n      return;\n    }\n\n    if (formData.items.length === 0) {\n      alert('Por favor agregue al menos un producto');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      await onSubmit(formData);\n    } catch (error) {\n      console.error('Error guardando cotizaci√≥n:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const obtenerProductoPorId = (productoId: number) => {\n    // Primero buscar en la lista de productos cargados\n    const producto = productos.find(p => p.id_producto === productoId);\n    if (producto) return producto;\n    \n    // Si no se encuentra, buscar en los items formateados que tienen producto_info\n    const item = formData.items.find(item => item.producto_id === productoId);\n    if (item && (item as any).producto_info) {\n      const info = (item as any).producto_info;\n      return {\n        id_producto: productoId,\n        codigo_producto: info.codigo_producto,\n        descripcion_producto: info.descripcion_producto,\n        costo_total_bom: info.costo_total_bom\n      };\n    }\n    \n    return null;\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto\">\n        <div className=\"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">\n            {cotizacion ? 'Editar Cotizaci√≥n' : 'Nueva Cotizaci√≥n'}\n            {cotizacion && (\n              <span className=\"ml-2 text-sm text-gray-500\">\n                ({cotizacion.codigo})\n              </span>\n            )}\n          </h2>\n          <button\n            onClick={onCancel}\n            className=\"text-gray-400 hover:text-gray-600 cursor-pointer\"\n          >\n            <i className=\"ri-close-line text-2xl\"></i>\n          </button>\n        </div>\n\n        <div className=\"p-6\">\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              {/* Cliente */}\n              <div className=\"relative\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Cliente *\n                </label>\n                <input\n                  type=\"text\"\n                  value={busquedaCliente}\n                  onChange={(e) => filtrarClientes(e.target.value)}\n                  placeholder=\"Buscar cliente por nombre o identificaci√≥n...\"\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  required\n                />\n                \n                {mostrarListaClientes && (\n                  <div className=\"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto\">\n                    {clientesFiltrados.map((cliente) => (\n                      <div\n                        key={cliente.id}\n                        onClick={() => seleccionarCliente(cliente)}\n                        className=\"px-3 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0\"\n                      >\n                        <div className=\"font-medium\">{cliente.nombre_razon_social}</div>\n                        <div className=\"text-sm text-gray-500\">{cliente.identificacion}</div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n                \n                {clienteSeleccionado && (\n                  <div className=\"mt-2 p-2 bg-green-50 border border-green-200 rounded text-sm\">\n                    <i className=\"ri-check-line text-green-600 mr-1\"></i>\n                    Cliente seleccionado: <strong>{clienteSeleccionado.nombre_razon_social}</strong>\n                  </div>\n                )}\n              </div>\n\n              {/* Estado */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Estado\n                </label>\n                <select\n                  value={formData.estado}\n                  onChange={(e) => handleInputChange('estado', e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                >\n                  <option value=\"borrador\">Borrador</option>\n                  <option value=\"enviada\">Enviada</option>\n                  <option value=\"aceptada\">Aceptada</option>\n                  <option value=\"rechazada\">Rechazada</option>\n                  <option value=\"vencida\">Vencida</option>\n                </select>\n              </div>\n\n              {/* Fecha de Emisi√≥n */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Fecha de Emisi√≥n\n                </label>\n                <input\n                  type=\"date\"\n                  value={formData.fecha_emision}\n                  onChange={(e) => handleInputChange('fecha_emision', e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  required\n                />\n              </div>\n\n              {/* Fecha de Vencimiento */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Fecha de Vencimiento\n                </label>\n                <input\n                  type=\"date\"\n                  value={formData.fecha_vencimiento}\n                  onChange={(e) => handleInputChange('fecha_vencimiento', e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                />\n                <p className=\"text-xs text-gray-500 mt-1\">\n                  Sugerencia: {new Date(Date.now() + 15 * 24 * 60 * 60 * 1000).toLocaleDateString('es-ES')} (15 d√≠as desde hoy)\n                </p>\n              </div>\n\n              {/* Moneda */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Moneda\n                </label>\n                <select\n                  value={formData.moneda}\n                  onChange={(e) => handleInputChange('moneda', e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                >\n                  <option value=\"CRC\">Colones (CRC)</option>\n                  <option value=\"USD\">D√≥lares (USD)</option>\n                </select>\n              </div>\n\n              {/* Tipo de Cambio */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Tipo de Cambio\n                </label>\n                <div className=\"flex gap-2\">\n                  <input\n                    type=\"number\"\n                    step=\"0.01\"\n                    value={formData.tipo_cambio}\n                    onChange={(e) => setFormData(prev => ({ ...prev, tipo_cambio: parseFloat(e.target.value) || 0 }))}\n                    className=\"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    placeholder=\"520.00\"\n                  />\n                  <button\n                    type=\"button\"\n                    onClick={obtenerTipoCambio}\n                    disabled={actualizandoTipoCambio}\n                    className=\"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap\"\n                  >\n                    {actualizandoTipoCambio ? (\n                      <i className=\"ri-loader-4-line animate-spin\"></i>\n                    ) : (\n                      <i className=\"ri-refresh-line\"></i>\n                    )}\n                  </button>\n                </div>\n                <p className=\"text-xs text-gray-500 mt-1\">\n                  {mensajeTipoCambio}\n                </p>\n              </div>\n            </div>\n\n            {/* Productos */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Buscar Producto\n              </label>\n              <div className=\"relative\">\n                <input\n                  type=\"text\"\n                  value={busquedaProducto}\n                  onChange={(e) => filtrarProductos(e.target.value)}\n                  placeholder=\"Buscar producto por c√≥digo o nombre...\"\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                />\n                \n                {mostrarListaProductos && (\n                  <div className=\"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto\">\n                    {productosFiltrados.map((producto) => (\n                      <div\n                        key={producto.id_producto}\n                        onClick={() => agregarProducto(producto)}\n                        className=\"px-3 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0\"\n                      >\n                        <div className=\"font-medium\">{producto.descripcion_producto}</div>\n                        <div className=\"text-sm text-gray-500\">\n                          C√≥digo: {producto.codigo_producto} | Precio: ‚Ç°{formatNumber(producto.costo_total_bom)}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* Lista de Items */}\n            {formData.items.length > 0 && (\n              <div>\n                <h3 className=\"text-lg font-medium text-gray-900 mb-4\">\n                  Productos Agregados ({formData.items.length})\n                </h3>\n                <div className=\"overflow-x-auto\">\n                  <table className=\"min-w-full divide-y divide-gray-200\">\n                    <thead className=\"bg-gray-50\">\n                      <tr>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                          Producto\n                        </th>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                          Cantidad\n                        </th>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                          Precio Unit.\n                        </th>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                          Descuento %\n                        </th>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                          Total\n                        </th>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                          Acciones\n                        </th>\n                      </tr>\n                    </thead>\n                    <tbody className=\"bg-white divide-y divide-gray-200\">\n                      {formData.items.map((item, index) => {\n                        const producto = obtenerProductoPorId(item.producto_id);\n                        return (\n                          <tr key={index} className=\"hover:bg-gray-50\">\n                            <td className=\"px-6 py-4 whitespace-nowrap\">\n                              <div>\n                                <div className=\"text-sm font-medium text-gray-900\">\n                                  {producto?.descripcion_producto || 'Producto no encontrado'}\n                                </div>\n                                <div className=\"text-sm text-gray-500\">\n                                  C√≥digo: {producto?.codigo_producto || 'N/A'}\n                                </div>\n                              </div>\n                            </td>\n                            <td className=\"px-6 py-4 whitespace-nowrap\">\n                              <input\n                                type=\"number\"\n                                value={item.cantidad}\n                                onChange={(e) => actualizarItem(index, 'cantidad', parseInt(e.target.value) || 0)}\n                                className=\"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                                min=\"1\"\n                              />\n                            </td>\n                            <td className=\"px-6 py-4 whitespace-nowrap\">\n                              <input\n                                type=\"number\"\n                                value={item.precio_unitario}\n                                onChange={(e) => actualizarItem(index, 'precio_unitario', parseFloat(e.target.value) || 0)}\n                                className=\"w-28 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                                step=\"0.01\"\n                              />\n                            </td>\n                            <td className=\"px-6 py-4 whitespace-nowrap\">\n                              <input\n                                type=\"number\"\n                                value={item.descuento}\n                                onChange={(e) => actualizarItem(index, 'descuento', parseFloat(e.target.value) || 0)}\n                                className=\"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                                min=\"0\"\n                                max=\"100\"\n                                step=\"0.01\"\n                              />\n                            </td>\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\n                              ‚Ç°{formatNumber(item.subtotal || 0)}\n                            </td>\n                            <td className=\"px-6 py-4 whitespace-nowrap\">\n                              <button\n                                type=\"button\"\n                                onClick={() => eliminarItem(index)}\n                                className=\"text-red-600 hover:text-red-900 cursor-pointer p-1 hover:bg-red-50 rounded\"\n                                title=\"Eliminar producto\"\n                              >\n                                <i className=\"ri-delete-bin-line\"></i>\n                              </button>\n                            </td>\n                          </tr>\n                        );\n                      })}\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n            )}\n\n            {formData.items.length === 0 && (\n              <div className=\"text-center py-8 text-gray-500 bg-gray-50 rounded-lg\">\n                <i className=\"ri-shopping-cart-line text-4xl mb-2\"></i>\n                <p className=\"font-medium\">No hay productos agregados</p>\n                <p className=\"text-sm\">Use la barra de b√∫squeda para agregar productos</p>\n              </div>\n            )}\n\n            {/* Totales */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Descuento Global (%)\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={formData.descuento_global}\n                    onChange={(e) => handleInputChange('descuento_global', parseFloat(e.target.value) || 0)}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    min=\"0\"\n                    max=\"100\"\n                    step=\"0.01\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Flete\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={formData.flete}\n                    onChange={(e) => handleInputChange('flete', parseFloat(e.target.value) || 0)}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    step=\"0.01\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Otros\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={formData.otros}\n                    onChange={(e) => handleInputChange('otros', parseFloat(e.target.value) || 0)}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    step=\"0.01\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"bg-gray-50 p-4 rounded-lg\">\n                <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Resumen</h3>\n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between\">\n                    <span>Subtotal:</span>\n                    <span>‚Ç°{formatNumber(formData.subtotal)}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Descuento ({formData.descuento_global}%):</span>\n                    <span>-‚Ç°{formatNumber(formData.descuento_valor)}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Impuestos (13%):</span>\n                    <span>‚Ç°{formatNumber(formData.impuestos)}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Flete:</span>\n                    <span>‚Ç°{formatNumber(formData.flete)}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Otros:</span>\n                    <span>‚Ç°{formatNumber(formData.otros)}</span>\n                  </div>\n                  <div className=\"border-t pt-2 flex justify-between font-bold text-lg\">\n                    <span>Total:</span>\n                    <span>‚Ç°{formatNumber(formData.total)}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {/* Botones */}\n            <div className=\"flex justify-end space-x-4 pt-6 border-t border-gray-200\">\n              <button\n                type=\"button\"\n                onClick={onCancel}\n                className=\"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 whitespace-nowrap cursor-pointer\"\n              >\n                Cancelar\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 whitespace-nowrap cursor-pointer\"\n              >\n                {loading ? (\n                  <>\n                    <i className=\"ri-loader-4-line animate-spin mr-2\"></i>\n                    Guardando...\n                  </>\n                ) : (\n                  <>\n                    <i className={cotizacion ? \"ri-save-line mr-2\" : \"ri-add-line mr-2\"}></i>\n                    {cotizacion ? 'Actualizar' : 'Crear'} Cotizaci√≥n\n                  </>\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default CotizacionForm;\n","\nimport { useState, useEffect, useRef } from 'react';\nimport { CotizacionFilters } from '../../../types/cotizacion';\nimport { Cliente } from '../../../types/cliente';\nimport { ClienteService } from '../../../services/clienteService';\n\ninterface CotizacionesFiltersProps {\n  filters: CotizacionFilters;\n  onFiltersChange: (filters: CotizacionFilters) => void;\n}\n\nexport function CotizacionesFilters({ filters, onFiltersChange }: CotizacionesFiltersProps) {\n  if (!filters) return null;\n\n  const [showAdvanced, setShowAdvanced] = useState(false);\n  const [clientes, setClientes] = useState<Cliente[]>([]);\n  const [clientesBusqueda, setClientesBusqueda] = useState('');\n  const [clienteSeleccionado, setClienteSeleccionado] = useState<Cliente | null>(null);\n  const [showClientesDropdown, setShowClientesDropdown] = useState(false);\n  const [clientesFiltrados, setClientesFiltrados] = useState<Cliente[]>([]);\n  const [searchTimer, setSearchTimer] = useState<NodeJS.Timeout | null>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  // Cargar clientes\n  useEffect(() => {\n    const cargarClientes = async () => {\n      try {\n        const data = await ClienteService.obtenerClientes({});\n        setClientes(data);\n      } catch (error) {\n        console.error('Error cargando clientes:', error);\n      }\n    };\n    cargarClientes();\n  }, []);\n\n  // Sincronizar cliente seleccionado con filtros\n  useEffect(() => {\n    if (filters?.cliente_id && clientes.length > 0) {\n      const cliente = clientes.find(c => c.id === parseInt(filters.cliente_id!));\n      if (cliente) {\n        setClienteSeleccionado(cliente);\n        setClientesBusqueda(`${cliente.nombre_razon_social} - ${cliente.identificacion}`);\n      }\n    } else {\n      setClienteSeleccionado(null);\n      setClientesBusqueda('');\n    }\n  }, [filters?.cliente_id, clientes]);\n\n  // Cerrar dropdown al hacer clic fuera\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setShowClientesDropdown(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  const handleFilterChange = (key: keyof CotizacionFilters, value: any) => {\n    onFiltersChange({\n      ...filters,\n      [key]: value || undefined\n    });\n  };\n\n  // Manejar b√∫squeda en tiempo real\n  const handleSearchChange = (value: string) => {\n    handleFilterChange('search', value);\n  };\n\n  const handleClienteBusquedaChange = (valor: string) => {\n    setClientesBusqueda(valor);\n    \n    // Limpiar timer anterior\n    if (searchTimer) {\n      clearTimeout(searchTimer);\n    }\n    \n    // Si se borra el campo, limpiar selecci√≥n\n    if (!valor.trim()) {\n      setClienteSeleccionado(null);\n      handleFilterChange('cliente_id', '');\n      setShowClientesDropdown(false);\n      setClientesFiltrados([]);\n      return;\n    }\n    \n    // Configurar nuevo timer para b√∫squeda\n    const timer = setTimeout(() => {\n      const filtrados = clientes.filter(cliente =>\n        cliente.nombre_razon_social.toLowerCase().includes(valor.toLowerCase()) ||\n        cliente.identificacion.toLowerCase().includes(valor.toLowerCase())\n      ).slice(0, 10); // Limitar a 10 resultados\n      \n      setClientesFiltrados(filtrados);\n      setShowClientesDropdown(filtrados.length > 0);\n    }, 300);\n    \n    setSearchTimer(timer);\n  };\n\n  const seleccionarCliente = (cliente: Cliente) => {\n    setClienteSeleccionado(cliente);\n    setClientesBusqueda(`${cliente.nombre_razon_social} - ${cliente.identificacion}`);\n    setShowClientesDropdown(false);\n    handleFilterChange('cliente_id', cliente.id?.toString());\n  };\n\n  const limpiarCliente = () => {\n    setClienteSeleccionado(null);\n    setClientesBusqueda('');\n    setShowClientesDropdown(false);\n    handleFilterChange('cliente_id', '');\n  };\n\n  const clearFilters = () => {\n    onFiltersChange({});\n    setShowAdvanced(false);\n    setClienteSeleccionado(null);\n    setClientesBusqueda('');\n    setShowClientesDropdown(false);\n  };\n\n  const hasActiveFilters = filters?.search || filters?.cliente_id || filters?.estado || \n                          filters?.moneda || filters?.fecha_desde || filters?.fecha_hasta;\n\n  return (\n    <div className=\"bg-white p-4 rounded-lg border border-gray-200 space-y-4\">\n      {/* B√∫squeda principal */}\n      <div className=\"flex flex-col sm:flex-row gap-4\">\n        <div className=\"flex-1\">\n          <div className=\"relative\">\n            <i className=\"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\"></i>\n            <input\n              type=\"text\"\n              placeholder=\"Buscar por n√∫mero, cliente, descripci√≥n...\"\n              value={filters?.search || ''}\n              onChange={(e) => handleSearchChange(e.target.value)}\n              className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm\"\n            />\n          </div>\n        </div>\n        \n        <div className=\"flex gap-2\">\n          <button\n            onClick={() => setShowAdvanced(!showAdvanced)}\n            className=\"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center whitespace-nowrap\"\n          >\n            <i className=\"ri-filter-line mr-2\"></i>\n            Filtros\n            <i className={`ri-arrow-${showAdvanced ? 'up' : 'down'}-s-line ml-1`}></i>\n          </button>\n          \n          {hasActiveFilters && (\n            <button\n              onClick={clearFilters}\n              className=\"px-4 py-2 text-red-600 border border-red-300 rounded-lg hover:bg-red-50 transition-colors flex items-center whitespace-nowrap\"\n            >\n              <i className=\"ri-close-line mr-2\"></i>\n              Limpiar\n            </button>\n          )}\n        </div>\n      </div>\n\n      {/* Filtros avanzados */}\n      {showAdvanced && (\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 pt-4 border-t border-gray-200\">\n          {/* Cliente con autocompletado */}\n          <div className=\"relative\" ref={dropdownRef}>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Cliente\n            </label>\n            <div className=\"relative\">\n              <input\n                type=\"text\"\n                placeholder=\"Buscar cliente...\"\n                value={clientesBusqueda}\n                onChange={(e) => handleClienteBusquedaChange(e.target.value)}\n                onFocus={() => {\n                  if (clientesFiltrados.length > 0) {\n                    setShowClientesDropdown(true);\n                  }\n                }}\n                className=\"w-full px-3 py-2 pr-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm\"\n              />\n              \n              {clienteSeleccionado && (\n                <button\n                  onClick={limpiarCliente}\n                  className=\"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600\"\n                >\n                  <i className=\"ri-close-line\"></i>\n                </button>\n              )}\n            </div>\n\n            {/* Dropdown de clientes */}\n            {showClientesDropdown && clientesFiltrados.length > 0 && (\n              <div className=\"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto\">\n                {clientesFiltrados.map((cliente) => (\n                  <button\n                    key={cliente.id}\n                    onClick={() => seleccionarCliente(cliente)}\n                    className=\"w-full px-3 py-2 text-left hover:bg-gray-50 focus:bg-gray-50 focus:outline-none border-b border-gray-100 last:border-b-0\"\n                  >\n                    <div className=\"text-sm font-medium text-gray-900\">\n                      {cliente.nombre_razon_social}\n                    </div>\n                    <div className=\"text-xs text-gray-600\">\n                      {cliente.identificacion}\n                    </div>\n                  </button>\n                ))}\n              </div>\n            )}\n\n            {showClientesDropdown && clientesBusqueda && clientesFiltrados.length === 0 && (\n              <div className=\"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg p-3\">\n                <div className=\"text-sm text-gray-500 text-center\">\n                  No se encontraron clientes\n                </div>\n              </div>\n            )}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Estado\n            </label>\n            <select\n              value={filters?.estado || ''}\n              onChange={(e) => handleFilterChange('estado', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm\"\n            >\n              <option value=\"\">Todos</option>\n              <option value=\"borrador\">Borrador</option>\n              <option value=\"enviada\">Enviada</option>\n              <option value=\"aceptada\">Aceptada</option>\n              <option value=\"rechazada\">Rechazada</option>\n              <option value=\"vencida\">Vencida</option>\n            </select>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Moneda\n            </label>\n            <select\n              value={filters?.moneda || ''}\n              onChange={(e) => handleFilterChange('moneda', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm\"\n            >\n              <option value=\"\">Todas</option>\n              <option value=\"CRC\">Colones (‚Ç°)</option>\n              <option value=\"USD\">D√≥lares ($)</option>\n              <option value=\"EUR\">Euros (‚Ç¨)</option>\n            </select>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Fecha Desde\n            </label>\n            <input\n              type=\"date\"\n              value={filters?.fecha_desde || ''}\n              onChange={(e) => handleFilterChange('fecha_desde', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Fecha Hasta\n            </label>\n            <input\n              type=\"date\"\n              value={filters?.fecha_hasta || ''}\n              onChange={(e) => handleFilterChange('fecha_hasta', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm\"\n            />\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","import { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Cotizacion } from '../../../types/cotizacion';\nimport { formatCurrency } from '../../../lib/currency';\nimport { supabase } from '../../../lib/supabase';\nimport { Link } from 'react-router-dom';\n\nexport function CotizacionesTable({\n  cotizaciones,\n  loading,\n  onEditar,\n  onEliminar,\n  onDuplicar,\n  onCambiarEstado,\n  onDescargarPDF\n}: CotizacionesTableProps) {\n  const navigate = useNavigate();\n  const [menuAbierto, setMenuAbierto] = useState<number | null>(null);\n  const [modalEnvio, setModalEnvio] = useState<{ abierto: boolean; cotizacion: any }>({\n    abierto: false,\n    cotizacion: null\n  });\n  const [datosEnvio, setDatosEnvio] = useState({\n    destinatario: '',\n    asunto: '',\n    mensaje: ''\n  });\n  const [enviandoCorreo, setEnviandoCorreo] = useState(false);\n\n  const getEstadoColor = (estado: string) => {\n    switch (estado) {\n      case 'borrador':\n        return 'bg-gray-100 text-gray-800';\n      case 'enviada':\n        return 'bg-blue-100 text-blue-800';\n      case 'aceptada':\n        return 'bg-green-100 text-green-800';\n      case 'rechazada':\n        return 'bg-red-100 text-red-800';\n      case 'vencida':\n        return 'bg-orange-100 text-orange-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getEstadoTexto = (estado: string) => {\n    switch (estado) {\n      case 'borrador':\n        return 'Borrador';\n      case 'enviada':\n        return 'Enviada';\n      case 'aceptada':\n        return 'Aceptada';\n      case 'rechazada':\n        return 'Rechazada';\n      case 'vencida':\n        return 'Vencida';\n      default:\n        return estado;\n    }\n  };\n\n  const formatFecha = (fecha: string) => {\n    return new Date(fecha).toLocaleDateString('es-CR');\n  };\n\n  const toggleMenu = (id: number) => {\n    setMenuAbierto(menuAbierto === id ? null : id);\n  };\n\n  const generarPDF = async (cotizacion: any) => {\n    try {\n      console.log('Generando PDF para cotizaci√≥n:', cotizacion.id);\n      \n      const { data: cotizacionData, error: cotizacionError } = await supabase\n        .from('cotizaciones')\n        .select(`\n          *,\n          clientes (\n            id,\n            nombre_razon_social,\n            identificacion,\n            correo_principal,\n            telefono_numero,\n            otras_senas,\n            barrio\n          )\n        `)\n        .eq('id', cotizacion.id)\n        .single();\n\n      if (cotizacionError) {\n        console.error('Error obteniendo cotizaci√≥n:', cotizacionError);\n        alert('Error al obtener los datos de la cotizaci√≥n');\n        return;\n      }\n\n      console.log('Cotizaci√≥n obtenida para PDF:', cotizacionData);\n\n      const { data: itemsData, error: itemsError } = await supabase\n        .from('cotizacion_items')\n        .select('*')\n        .eq('cotizacion_id', cotizacion.id);\n\n      if (itemsError) {\n        console.error('Error obteniendo items:', itemsError);\n        alert('Error al obtener los items de la cotizaci√≥n');\n        return;\n      }\n\n      const productIds = itemsData?.map(item => item.producto_id).filter(Boolean) || [];\n      let productosData = [];\n      \n      if (productIds.length > 0) {\n        const { data: productos, error: productosError } = await supabase\n          .from('productos')\n          .select('id_producto, codigo_producto, descripcion_producto, costo_total_bom')\n          .in('id_producto', productIds);\n\n        if (!productosError) {\n          productosData = productos || [];\n        }\n      }\n\n      const itemsConProductos = itemsData?.map(item => {\n        const producto = productosData.find(p => p.id_producto === item.producto_id);\n        return {\n          ...item,\n          productos: producto || null\n        };\n      }) || [];\n\n      const cotizacionCompleta = {\n        ...cotizacionData,\n        cotizacion_items: itemsConProductos\n      };\n\n      const htmlContent = generarHTMLPDF(cotizacionCompleta);\n      \n      const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });\n      const url = URL.createObjectURL(blob);\n      \n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `cotizacion-${cotizacionCompleta.codigo}.html`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      \n      URL.revokeObjectURL(url);\n      \n    } catch (error) {\n      console.error('Error generando PDF:', error);\n      alert('Error al generar el PDF');\n    }\n  };\n\n  const generarHTMLParaImpresion = (cotizacion: any) => {\n    const cliente = cotizacion.clientes || {};\n    const items = cotizacion.cotizacion_items || [];\n    \n    const direccion = [\n      cliente.otras_senas,\n      cliente.barrio\n    ].filter(Boolean).join(', ') || 'No especificada';\n\n    return `\n<!DOCTYPE html>\n<html lang=\"es\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Cotizaci√≥n ${cotizacion.codigo}</title>\n    <style>\n        * { margin: 0; padding: 0; box-sizing: border-box; }\n        body { font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; color: #333; }\n        .container { max-width: 800px; margin: 0 auto; padding: 20px; }\n        .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #2563eb; padding-bottom: 20px; }\n        .company-name { font-size: 24px; font-weight: bold; color: #2563eb; margin-bottom: 5px; }\n        .document-title { font-size: 18px; color: #666; }\n        .info-section { display: flex; justify-content: space-between; margin-bottom: 30px; }\n        .info-box { width: 48%; }\n        .info-title { font-weight: bold; color: #2563eb; margin-bottom: 10px; font-size: 14px; }\n        .info-content { background: #f8fafc; padding: 15px; border-radius: 5px; }\n        .table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }\n        .table th, .table td { border: 1px solid #e2e8f0; padding: 8px; text-align: left; }\n        .table th { background: #2563eb; color: white; font-weight: bold; }\n        .table tr:nth-child(even) { background: #f8fafc; }\n        .totals { margin-top: 20px; }\n        .totals-table { width: 300px; margin-left: auto; }\n        .total-row { font-weight: bold; background: #2563eb !important; color: white; }\n        .footer { margin-top: 40px; text-align: center; color: #666; font-size: 10px; }\n        \n        @media print {\n            body { font-size: 11px; }\n            .container { padding: 10px; }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <div class=\"company-name\">Mi Empresa</div>\n            <div class=\"document-title\">COTIZACI√ìN</div>\n        </div>\n\n        <div class=\"info-section\">\n            <div class=\"info-box\">\n                <div class=\"info-title\">INFORMACI√ìN DEL CLIENTE</div>\n                <div class=\"info-content\">\n                    <strong>Cliente:</strong> ${cliente.nombre_razon_social || 'No especificado'}<br>\n                    <strong>Identificaci√≥n:</strong> ${cliente.identificacion || 'No especificada'}<br>\n                    <strong>Correo:</strong> ${cliente.correo_principal || 'No especificado'}<br>\n                    <strong>Tel√©fono:</strong> ${cliente.telefono_numero || 'No especificado'}<br>\n                    <strong>Direcci√≥n:</strong> ${direccion}\n                </div>\n            </div>\n            <div class=\"info-box\">\n                <div class=\"info-title\">INFORMACI√ìN DE LA COTIZACI√ìN</div>\n                <div class=\"info-content\">\n                    <strong>C√≥digo:</strong> ${cotizacion.codigo}<br>\n                    <strong>Fecha Emisi√≥n:</strong> ${new Date(cotizacion.fecha_emision).toLocaleDateString('es-ES')}<br>\n                    <strong>Fecha Vencimiento:</strong> ${new Date(cotizacion.fecha_vencimiento).toLocaleDateString('es-ES')}<br>\n                    <strong>Estado:</strong> ${cotizacion.estado.toUpperCase()}<br>\n                    <strong>Moneda:</strong> ${cotizacion.moneda}\n                </div>\n            </div>\n        </div>\n\n        <table class=\"table\">\n            <thead>\n                <tr>\n                    <th>C√≥digo</th>\n                    <th>Descripci√≥n</th>\n                    <th>Cantidad</th>\n                    <th>Precio Unit.</th>\n                    <th>Descuento</th>\n                    <th>Total</th>\n                </tr>\n            </thead>\n            <tbody>\n                ${items.map(item => `\n                    <tr>\n                        <td>${item.productos?.codigo_producto || item.codigo_producto || 'N/A'}</td>\n                        <td>${item.productos?.descripcion_producto || item.descripcion_producto || 'Producto sin descripci√≥n'}</td>\n                        <td>${item.cantidad || 0}</td>\n                        <td>${formatCurrency(item.precio_unitario || 0, cotizacion.moneda)}</td>\n                        <td>${item.descuento_porcentaje || 0}%</td>\n                        <td>${formatCurrency(item.total_linea || 0, cotizacion.moneda)}</td>\n                    </tr>\n                `).join('')}\n            </tbody>\n        </table>\n\n        <div class=\"totals\">\n            <table class=\"table totals-table\">\n                <tr>\n                    <td><strong>Subtotal:</strong></td>\n                    <td>${formatCurrency(cotizacion.subtotal || 0, cotizacion.moneda)}</td>\n                </tr>\n                <tr>\n                    <td><strong>Descuento:</strong></td>\n                    <td>${formatCurrency(cotizacion.descuento_valor || 0, cotizacion.moneda)}</td>\n                </tr>\n                <tr>\n                    <td><strong>Flete:</strong></td>\n                    <td>${formatCurrency(cotizacion.flete || 0, cotizacion.moneda)}</td>\n                </tr>\n                <tr>\n                    <td><strong>Impuestos:</strong></td>\n                    <td>${formatCurrency(cotizacion.impuestos || 0, cotizacion.moneda)}</td>\n                </tr>\n                <tr>\n                    <td><strong>Otros:</strong></td>\n                    <td>${formatCurrency(cotizacion.otros || 0, cotizacion.moneda)}</td>\n                </tr>\n                <tr class=\"total-row\">\n                    <td><strong>TOTAL:</strong></td>\n                    <td><strong>${formatCurrency(cotizacion.total || 0, cotizacion.moneda)}</strong></td>\n                </tr>\n            </table>\n        </div>\n\n        <div class=\"footer\">\n            <p>Cotizaci√≥n generada el ${new Date().toLocaleDateString('es-ES')} a las ${new Date().toLocaleTimeString('es-ES')}</p>\n            <p>Este documento es una cotizaci√≥n y no constituye una factura</p>\n        </div>\n    </div>\n</body>\n</html>`;\n  };\n\n  const generarHTMLPDF = (cotizacion: any) => {\n    const cliente = cotizacion.clientes || {};\n    const items = cotizacion.cotizacion_items || [];\n\n    const direccion = [\n      cliente.otras_senas,\n      cliente.barrio\n    ].filter(Boolean).join(', ') || 'No especificada';\n\n    // Funci√≥n para formatear n√∫meros correctamente\n    const formatearMoneda = (valor: any) => {\n      const numero = parseFloat(valor) || 0;\n      return numero.toLocaleString('es-CR', {\n        minimumFractionDigits: 2,\n        maximumFractionDigits: 2\n      });\n    };\n\n    return `\n<!DOCTYPE html>\n<html lang=\"es\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Cotizaci√≥n ${cotizacion.codigo}</title>\n    <style>\n        * { margin: 0; padding: 0; box-sizing: border-box; }\n        body { font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; color: #333; }\n        .container { max-width: 800px; margin: 0 auto; padding: 20px; }\n        .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #5AAB8E; padding-bottom: 20px; }\n        .company-logo { width: 120px; height: auto; margin-bottom: 10px; }\n        .company-name { font-size: 24px; font-weight: bold; color: #5AAB8E; margin-bottom: 5px; }\n        .document-title { font-size: 18px; color: #666; }\n        .info-section { display: flex; justify-content: space-between; margin-bottom: 30px; }\n        .info-box { width: 48%; }\n        .info-title { font-weight: bold; color: #5AAB8E; margin-bottom: 10px; font-size: 14px; }\n        .info-content { background: #f8fafc; padding: 15px; border-radius: 5px; }\n        .table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }\n        .table th, .table td { border: 1px solid #e2e8f0; padding: 8px; text-align: left; }\n        .table th { background: #5AAB8E; color: white; font-weight: bold; }\n        .table tr:nth-child(even) { background: #f8fafc; }\n        .totals { margin-top: 20px; }\n        .totals-table { width: 300px; margin-left: auto; }\n        .total-row { font-weight: bold; background: #5AAB8E !important; color: white; }\n        .footer { margin-top: 40px; text-align: center; color: #666; font-size: 10px; }\n        \n        @media print {\n            body { font-size: 11px; }\n            .container { padding: 10px; }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <img src=\"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRYi7j4OFVRmD2T0m6NyFHqYa96zun92AUTIA&s\" alt=\"SCO Logo\" class=\"company-logo\">\n            <div class=\"company-name\">SCO</div>\n            <div class=\"document-title\">COTIZACI√ìN</div>\n        </div>\n\n        <div class=\"info-section\">\n            <div class=\"info-box\">\n                <div class=\"info-title\">INFORMACI√ìN DEL CLIENTE</div>\n                <div class=\"info-content\">\n                    <strong>Cliente:</strong> ${cliente.nombre_razon_social || 'No especificado'}<br>\n                    <strong>Identificaci√≥n:</strong> ${cliente.identificacion || 'No especificada'}<br>\n                    <strong>Correo:</strong> ${cliente.correo_principal || 'No especificado'}<br>\n                    <strong>Tel√©fono:</strong> ${cliente.telefono_numero || 'No especificado'}<br>\n                    <strong>Direcci√≥n:</strong> ${direccion}\n                </div>\n            </div>\n            <div class=\"info-box\">\n                <div class=\"info-title\">INFORMACI√ìN DE LA COTIZACI√ìN</div>\n                <div class=\"info-content\">\n                    <strong>C√≥digo:</strong> ${cotizacion.codigo}<br>\n                    <strong>Fecha Emisi√≥n:</strong> ${new Date(cotizacion.fecha_emision).toLocaleDateString('es-ES')}<br>\n                    <strong>Fecha Vencimiento:</strong> ${new Date(cotizacion.fecha_vencimiento).toLocaleDateString('es-ES')}<br>\n                    <strong>Estado:</strong> ${cotizacion.estado.toUpperCase()}<br>\n                    <strong>Moneda:</strong> ${cotizacion.moneda}\n                </div>\n            </div>\n        </div>\n\n        <table class=\"table\">\n            <thead>\n                <tr>\n                    <th>C√≥digo</th>\n                    <th>Descripci√≥n</th>\n                    <th>Cantidad</th>\n                    <th>Precio Unit.</th>\n                    <th>Descuento</th>\n                    <th>Total</th>\n                </tr>\n            </thead>\n            <tbody>\n                ${items.map(item => `\n                    <tr>\n                        <td>${item.productos?.codigo_producto || item.codigo_producto || 'N/A'}</td>\n                        <td>${item.productos?.descripcion_producto || item.descripcion_producto || 'Producto sin descripci√≥n'}</td>\n                        <td>${item.cantidad || 0}</td>\n                        <td>‚Ç°${formatearMoneda(item.precio_unitario || 0)}</td>\n                        <td>${item.descuento_porcentaje || item.descuento || 0}%</td>\n                        <td>‚Ç°${formatearMoneda(item.total_linea || item.subtotal || 0)}</td>\n                    </tr>\n                `).join('')}\n            </tbody>\n        </table>\n\n        <div class=\"totals\">\n            <table class=\"table totals-table\">\n                <tr>\n                    <td><strong>Subtotal:</strong></td>\n                    <td>‚Ç°${formatearMoneda(cotizacion.subtotal || 0)}</td>\n                </tr>\n                <tr>\n                    <td><strong>Descuento:</strong></td>\n                    <td>‚Ç°${formatearMoneda(cotizacion.descuento_valor || 0)}</td>\n                </tr>\n                <tr>\n                    <td><strong>Flete:</strong></td>\n                    <td>‚Ç°${formatearMoneda(cotizacion.flete || 0)}</td>\n                </tr>\n                <tr>\n                    <td><strong>Impuestos:</strong></td>\n                    <td>‚Ç°${formatearMoneda(cotizacion.impuestos || 0)}</td>\n                </tr>\n                <tr>\n                    <td><strong>Otros:</strong></td>\n                    <td>‚Ç°${formatearMoneda(cotizacion.otros || 0)}</td>\n                </tr>\n                <tr class=\"total-row\">\n                    <td><strong>TOTAL:</strong></td>\n                    <td><strong>‚Ç°${formatearMoneda(cotizacion.total || 0)}</strong></td>\n                </tr>\n            </table>\n        </div>\n\n        <div class=\"footer\">\n            <p>Cotizaci√≥n generada el ${new Date().toLocaleDateString('es-ES')} a las ${new Date().toLocaleTimeString('es-ES')}</p>\n            <p>Este documento es una cotizaci√≥n y no constituye una factura</p>\n        </div>\n    </div>\n</body>\n</html>`;\n  };\n\n  const abrirModalEnvio = (cotizacion: any) => {\n    const correoCliente = cotizacion.clientes?.correo_principal || '';\n    const asuntoDefault = `Cotizaci√≥n ${cotizacion.codigo} - ${cotizacion.clientes?.nombre_razon_social || 'Cliente'}`;\n    const mensajeDefault = `Estimado/a cliente,\n\nAdjunto encontrar√° la cotizaci√≥n ${cotizacion.codigo} con los detalles de los productos y servicios solicitados.\n\nEsta cotizaci√≥n tiene una validez hasta el ${cotizacion.fecha_vencimiento ? new Date(cotizacion.fecha_vencimiento).toLocaleDateString('es-ES') : 'fecha indicada'}.\n\nSi tiene alguna consulta o requiere modificaciones, no dude en contactarnos.\n\nQuedamos atentos a su respuesta.\n\nSaludos cordiales,\nEquipo de Ventas`;\n\n    setDatosEnvio({\n      destinatario: correoCliente,\n      asunto: asuntoDefault,\n      mensaje: mensajeDefault\n    });\n    \n    setModalEnvio({ abierto: true, cotizacion });\n    setMenuAbierto(null);\n  };\n\n  const cerrarModalEnvio = () => {\n    setModalEnvio({ abierto: false, cotizacion: null });\n    setDatosEnvio({ destinatario: '', asunto: '', mensaje: '' });\n  };\n\n  const enviarCotizacionPorCorreo = async () => {\n    if (!datosEnvio.destinatario.trim()) {\n      alert('Por favor ingrese un correo electr√≥nico de destino');\n      return;\n    }\n\n    if (!datosEnvio.asunto.trim()) {\n      alert('Por favor ingrese un asunto para el correo');\n      return;\n    }\n\n    try {\n      setEnviandoCorreo(true);\n\n      const htmlCotizacion = await generarHTMLParaEnvio(modalEnvio.cotizacion);\n\n      const mailtoLink = `mailto:${datosEnvio.destinatario}?subject=${encodeURIComponent(datosEnvio.asunto)}&body=${encodeURIComponent(datosEnvio.mensaje + '\\n\\nNota: La cotizaci√≥n detallada se encuentra adjunta en formato PDF.')}`;\n      \n      window.open(mailtoLink);\n      \n      const blob = new Blob([htmlCotizacion], { type: 'text/html;charset=utf-8' });\n      const url = URL.createObjectURL(blob);\n      \n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `cotizacion-${modalEnvio.cotizacion.codigo}.html`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      URL.revokeObjectURL(url);\n\n      alert('Se ha abierto su cliente de correo y descargado la cotizaci√≥n. Por favor adjunte el archivo descargado al correo.');\n      \n      cerrarModalEnvio();\n    } catch (error) {\n      console.error('Error enviando cotizaci√≥n:', error);\n      alert('Error al preparar el env√≠o de la cotizaci√≥n');\n    } finally {\n      setEnviandoCorreo(false);\n    }\n  };\n\n  const generarHTMLParaEnvio = async (cotizacion: any) => {\n    try {\n      const { data: cotizacionData, error: cotizacionError } = await supabase\n        .from('cotizaciones')\n        .select(`\n          *,\n          clientes (\n            id,\n            nombre_razon_social,\n            identificacion,\n            correo_principal,\n            telefono_numero,\n            otras_senas,\n            barrio\n          )\n        `)\n        .eq('id', cotizacion.id)\n        .single();\n\n      if (cotizacionError) {\n        throw new Error('Error obteniendo datos de la cotizaci√≥n');\n      }\n\n      const { data: itemsData, error: itemsError } = await supabase\n        .from('cotizacion_items')\n        .select('*')\n        .eq('cotizacion_id', cotizacion.id);\n\n      if (itemsError) {\n        throw new Error('Error obteniendo items de la cotizaci√≥n');\n      }\n\n      const productIds = itemsData?.map(item => item.producto_id).filter(Boolean) || [];\n      let productosData = [];\n      \n      if (productIds.length > 0) {\n        const { data: productos, error: productosError } = await supabase\n          .from('productos')\n          .select('id_producto, codigo_producto, descripcion_producto, costo_total_bom')\n          .in('id_producto', productIds);\n\n        if (!productosError) {\n          productosData = productos || [];\n        }\n      }\n\n      const itemsConProductos = itemsData?.map(item => {\n        const producto = productosData.find(p => p.id_producto === item.producto_id);\n        return {\n          ...item,\n          productos: producto || null\n        };\n      }) || [];\n\n      const cotizacionCompleta = {\n        ...cotizacionData,\n        cotizacion_items: itemsConProductos\n      };\n\n      return generarHTMLPDF(cotizacionCompleta);\n    } catch (error) {\n      console.error('Error generando HTML para env√≠o:', error);\n      throw error;\n    }\n  };\n\n  const verCotizacionDetallada = (cotizacionId: number) => {\n    navigate(`/cotizaciones/${cotizacionId}/detallada`);\n    setMenuAbierto(null);\n  };\n\n  const descargarPDFDetallado = async (cotizacion: any) => {\n    try {\n      // Generar PDF usando la misma l√≥gica pero optimizada para descarga\n      const { data: cotizacionData, error: cotizacionError } = await supabase\n        .from('cotizaciones')\n        .select(`\n          *,\n          clientes (\n            id,\n            nombre_razon_social,\n            identificacion,\n            correo_principal,\n            telefono_numero,\n            otras_senas,\n            barrio\n          )\n        `)\n        .eq('id', cotizacion.id)\n        .single();\n\n      if (cotizacionError) {\n        console.error('Error obteniendo cotizaci√≥n:', cotizacionError);\n        alert('Error al obtener los datos de la cotizaci√≥n');\n        return;\n      }\n\n      const { data: itemsData, error: itemsError } = await supabase\n        .from('cotizacion_items')\n        .select('*')\n        .eq('cotizacion_id', cotizacion.id);\n\n      if (itemsError) {\n        console.error('Error obteniendo items:', itemsError);\n        alert('Error al obtener los items de la cotizaci√≥n');\n        return;\n      }\n\n      const productIds = itemsData?.map(item => item.producto_id).filter(Boolean) || [];\n      let productosData = [];\n      \n      if (productIds.length > 0) {\n        const { data: productos, error: productosError } = await supabase\n          .from('productos')\n          .select('id_producto, codigo_producto, descripcion_producto, costo_total_bom')\n          .in('id_producto', productIds);\n\n        if (!productosError) {\n          productosData = productos || [];\n        }\n      }\n\n      const itemsConProductos = itemsData?.map(item => {\n        const producto = productosData.find(p => p.id_producto === item.producto_id);\n        return {\n          ...item,\n          productos: producto || null\n        };\n      }) || [];\n\n      const cotizacionCompleta = {\n        ...cotizacionData,\n        cotizacion_items: itemsConProductos\n      };\n\n      const htmlContent = generarHTMLPDF(cotizacionCompleta);\n      \n      const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });\n      const url = URL.createObjectURL(blob);\n      \n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `COT-${cotizacionCompleta.codigo}-detallada.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      \n      URL.revokeObjectURL(url);\n      setMenuAbierto(null);\n      \n    } catch (error) {\n      console.error('Error generando PDF:', error);\n      alert('Error al generar el PDF');\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"bg-white rounded-lg shadow-sm border\">\n        <div className=\"p-8 text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto\"></div>\n          <p className=\"mt-2 text-gray-600\">Cargando cotizaciones...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (cotizaciones.length === 0) {\n    return (\n      <div className=\"bg-white rounded-lg shadow-sm border\">\n        <div className=\"p-8 text-center\">\n          <i className=\"ri-file-list-3-line text-4xl text-gray-400 mb-4\"></i>\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No hay cotizaciones</h3>\n          <p className=\"text-gray-600\">No se encontraron cotizaciones con los filtros aplicados.</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <div className=\"bg-white rounded-lg shadow-sm border overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full divide-y divide-gray-200\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  C√≥digo\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Cliente\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Estado\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Fecha Emisi√≥n\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Vencimiento\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Total\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Moneda\n                </th>\n                <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Acciones\n                </th>\n              </tr>\n            </thead>\n            <tbody className=\"bg-white divide-y divide-gray-200\">\n              {cotizaciones.map((cotizacion) => (\n                <tr key={cotizacion.id} className=\"hover:bg-gray-50\">\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"text-sm font-medium text-gray-900\">\n                      {cotizacion.codigo}\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"text-sm text-gray-900\">\n                      {cotizacion.clientes?.nombre_razon_social || 'Sin cliente'}\n                    </div>\n                    <div className=\"text-sm text-gray-500\">\n                      {cotizacion.clientes?.identificacion || ''}\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getEstadoColor(cotizacion.estado)}`}>\n                      {getEstadoTexto(cotizacion.estado)}\n                    </span>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {formatFecha(cotizacion.fecha_emision)}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {cotizacion.fecha_vencimiento ? formatFecha(cotizacion.fecha_vencimiento) : '-'}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\n                    {formatCurrency(cotizacion.total, cotizacion.moneda)}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {cotizacion.moneda}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                    <div className=\"relative\">\n                      <button\n                        onClick={() => toggleMenu(cotizacion.id!)}\n                        className=\"text-gray-400 hover:text-gray-600 cursor-pointer\"\n                      >\n                        <i className=\"ri-more-2-fill\"></i>\n                      </button>\n                      \n                      {menuAbierto === cotizacion.id && (\n                        <div className=\"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10 border\">\n                          <div className=\"py-1\">\n                            {/* Opci√≥n especial para cotizaciones del optimizador */}\n                            {cotizacion.metadata?.tipo === 'optimizador' && (\n                              <button\n                                onClick={() => {\n                                  console.log('[COTIZACIONES] Navegando a cotizaci√≥n optimizador:', cotizacion.id);\n                                  navigate(`/cotizaciones/optimizador/${cotizacion.id}`);\n                                  setMenuAbierto(null);\n                                }}\n                                className=\"block w-full text-left px-4 py-2 text-sm text-teal-700 hover:bg-teal-50 cursor-pointer font-medium\"\n                              >\n                                <i className=\"ri-scissors-cut-line mr-2\"></i>\n                                Ver Optimizador\n                              </button>\n                            )}\n                            \n                            <button\n                              onClick={() => {\n                                onEditar(cotizacion);\n                                setMenuAbierto(null);\n                              }}\n                              className=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer\"\n                            >\n                              <i className=\"ri-edit-line mr-2\"></i>\n                              Editar\n                            </button>\n                            \n                            <button\n                              onClick={() => {\n                                generarPDF(cotizacion);\n                                setMenuAbierto(null);\n                              }}\n                              className=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer\"\n                            >\n                              <i className=\"ri-printer-line mr-2\"></i>\n                              Imprimir\n                            </button>\n\n                            <button\n                              onClick={() => abrirModalEnvio(cotizacion)}\n                              className=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer\"\n                            >\n                              <i className=\"ri-mail-send-line mr-2\"></i>\n                              Enviar\n                            </button>\n                            \n                            <button\n                              onClick={() => verCotizacionDetallada(cotizacion.id!)}\n                              className=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer\"\n                            >\n                              <i className=\"ri-file-text-line mr-2\"></i>\n                              Ver Detallada\n                            </button>\n\n                            <button\n                              onClick={() => descargarPDFDetallado(cotizacion)}\n                              className=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer\"\n                            >\n                              <i className=\"ri-download-line mr-2\"></i>\n                              Descargar PDF\n                            </button>\n                            \n                            <button\n                              onClick={() => {\n                                onDuplicar(cotizacion.id!);\n                                setMenuAbierto(null);\n                              }}\n                              className=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer\"\n                            >\n                              <i className=\"ri-file-copy-line mr-2\"></i>\n                              Duplicar\n                            </button>\n\n                            {cotizacion.estado === 'borrador' && (\n                              <button\n                                onClick={() => {\n                                  onCambiarEstado(cotizacion.id!, 'enviada');\n                                  setMenuAbierto(null);\n                                }}\n                                className=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer\"\n                              >\n                                <i className=\"ri-send-plane-line mr-2\"></i>\n                                Marcar como Enviada\n                              </button>\n                            )}\n\n                            {cotizacion.estado === 'enviada' && (\n                              <>\n                                <button\n                                  onClick={() => {\n                                    onCambiarEstado(cotizacion.id!, 'aceptada');\n                                    setMenuAbierto(null);\n                                  }}\n                                  className=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer\"\n                                >\n                                  <i className=\"ri-check-line mr-2\"></i>\n                                  Marcar Aceptada\n                                </button>\n                                <button\n                                  onClick={() => {\n                                    onCambiarEstado(cotizacion.id!, 'rechazada');\n                                    setMenuAbierto(null);\n                                  }}\n                                  className=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer\"\n                                >\n                                  <i className=\"ri-close-line mr-2\"></i>\n                                  Marcar Rechazada\n                                </button>\n                              </>\n                            )}\n\n                            <div className=\"border-t border-gray-100\"></div>\n                            \n                            <button\n                              onClick={() => {\n                                onEliminar(cotizacion.id!);\n                                setMenuAbierto(null);\n                              }}\n                              className=\"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50 cursor-pointer\"\n                            >\n                              <i className=\"ri-delete-bin-line mr-2\"></i>\n                              Eliminar\n                            </button>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      {/* Modal de Env√≠o por Correo */}\n      {modalEnvio.abierto && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\n            <div className=\"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center\">\n              <h2 className=\"text-xl font-semibold text-gray-900\">\n                Enviar Cotizaci√≥n por Correo\n              </h2>\n              <button\n                onClick={cerrarModalEnvio}\n                className=\"text-gray-400 hover:text-gray-600 cursor-pointer\"\n              >\n                <i className=\"ri-close-line text-2xl\"></i>\n              </button>\n            </div>\n\n            <div className=\"p-6\">\n              <div className=\"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n                <div className=\"flex items-center\">\n                  <i className=\"ri-information-line text-blue-600 mr-2\"></i>\n                  <span className=\"text-sm text-blue-800\">\n                    Cotizaci√≥n: <strong>{modalEnvio.cotizacion?.codigo}</strong> - \n                    Cliente: <strong>{modalEnvio.cotizacion?.clientes?.nombre_razon_social}</strong>\n                  </span>\n                </div>\n              </div>\n\n              <form onSubmit={(e) => { e.preventDefault(); enviarCotizacionPorCorreo(); }} className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Correo de destino *\n                  </label>\n                  <input\n                    type=\"email\"\n                    value={datosEnvio.destinatario}\n                    onChange={(e) => setDatosEnvio(prev => ({ ...prev, destinatario: e.target.value }))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    placeholder=\"cliente@ejemplo.com\"\n                    required\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Asunto *\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={datosEnvio.asunto}\n                    onChange={(e) => setDatosEnvio(prev => ({ ...prev, asunto: e.target.value }))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    required\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Mensaje\n                  </label>\n                  <textarea\n                    value={datosEnvio.mensaje}\n                    onChange={(e) => setDatosEnvio(prev => ({ ...prev, mensaje: e.target.value }))}\n                    rows={8}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    placeholder=\"Escriba su mensaje aqu√≠...\"\n                  />\n                </div>\n\n                <div className=\"flex justify-end space-x-4 pt-4 border-top border-gray-200\">\n                  <button\n                    type=\"button\"\n                    onClick={cerrarModalEnvio}\n                    className=\"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 whitespace-nowrap cursor-pointer\"\n                  >\n                    Cancelar\n                  </button>\n                  <button\n                    type=\"submit\"\n                    disabled={enviandoCorreo}\n                    className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 whitespace-nowrap cursor-pointer\"\n                  >\n                    {enviandoCorreo ? (\n                      <>\n                        <i className=\"ri-loader-4-line animate-spin mr-2\"></i>\n                        Preparando...\n                      </>\n                    ) : (\n                      <>\n                        <i className=\"ri-mail-send-line mr-2\"></i>\n                        Enviar Cotizaci√≥n\n                      </>\n                    )}\n                  </button>\n                </div>\n              </form>\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n}\n","import React, { useState, useEffect } from 'react';\nimport { CotizacionesLayout } from './components/CotizacionesLayout';\nimport CotizacionForm from './components/CotizacionForm';\nimport { CotizacionesFilters } from './components/CotizacionesFilters';\nimport { CotizacionesTable } from './components/CotizacionesTable';\nimport { Cotizacion, CotizacionFilters as FilterType } from '../../types/cotizacion';\nimport { CotizacionService } from '../../services/cotizacionService';\nimport ConfirmationDialog from '../../components/base/ConfirmationDialog';\n\nconst CotizacionesPage: React.FC = () => {\n  const [showForm, setShowForm] = useState(false);\n  const [editingCotizacion, setEditingCotizacion] = useState<Cotizacion | null>(null);\n  const [cotizaciones, setCotizaciones] = useState<Cotizacion[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [filters, setFilters] = useState<FilterType>({});\n  const [currentPage, setCurrentPage] = useState(1);\n  const [itemsPerPage, setItemsPerPage] = useState(10);\n  const [confirmDialog, setConfirmDialog] = useState<{\n    isOpen: boolean;\n    cotizacionId: number | null;\n  }>({\n    isOpen: false,\n    cotizacionId: null\n  });\n\n  // Cargar cotizaciones\n  useEffect(() => {\n    cargarCotizaciones();\n  }, [filters, currentPage, itemsPerPage]);\n\n  const cargarCotizaciones = async () => {\n    try {\n      setLoading(true);\n      const data = await CotizacionService.obtenerCotizaciones(filters);\n      setCotizaciones(data);\n    } catch (error) {\n      console.error('Error cargando cotizaciones:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Filtrar cotizaciones en tiempo real\n  const cotizacionesFiltradas = cotizaciones.filter(cotizacion => {\n    let cumpleFiltros = true;\n\n    // B√∫squeda general\n    if (filters.search) {\n      const searchTerm = filters.search.toLowerCase();\n      cumpleFiltros = cumpleFiltros && (\n        cotizacion.numero?.toString().includes(searchTerm) ||\n        cotizacion.codigo?.toLowerCase().includes(searchTerm) ||\n        cotizacion.clientes?.nombre_razon_social?.toLowerCase().includes(searchTerm) ||\n        cotizacion.clientes?.identificacion?.toLowerCase().includes(searchTerm) ||\n        cotizacion.descripcion?.toLowerCase().includes(searchTerm) ||\n        cotizacion.observaciones?.toLowerCase().includes(searchTerm)\n      );\n    }\n\n    // Filtro por cliente\n    if (filters.cliente_id) {\n      cumpleFiltros = cumpleFiltros && cotizacion.cliente_id?.toString() === filters.cliente_id;\n    }\n\n    // Filtro por estado\n    if (filters.estado) {\n      cumpleFiltros = cumpleFiltros && cotizacion.estado === filters.estado;\n    }\n\n    // Filtro por moneda\n    if (filters.moneda) {\n      cumpleFiltros = cumpleFiltros && cotizacion.moneda === filters.moneda;\n    }\n\n    // Filtro por fecha desde\n    if (filters.fecha_desde) {\n      cumpleFiltros = cumpleFiltros && new Date(cotizacion.fecha_emision) >= new Date(filters.fecha_desde);\n    }\n\n    // Filtro por fecha hasta\n    if (filters.fecha_hasta) {\n      cumpleFiltros = cumpleFiltros && new Date(cotizacion.fecha_emision) <= new Date(filters.fecha_hasta);\n    }\n\n    return cumpleFiltros;\n  });\n\n  // Paginaci√≥n\n  const totalItems = cotizacionesFiltradas.length;\n  const totalPages = Math.ceil(totalItems / itemsPerPage);\n  const startIndex = (currentPage - 1) * itemsPerPage;\n  const endIndex = startIndex + itemsPerPage;\n  const cotizacionesPaginadas = cotizacionesFiltradas.slice(startIndex, endIndex);\n\n  // Estad√≠sticas\n  const stats = {\n    total: cotizacionesFiltradas.length,\n    borradores: cotizacionesFiltradas.filter(c => c.estado === 'borrador').length,\n    enviadas: cotizacionesFiltradas.filter(c => c.estado === 'enviada').length,\n    aceptadas: cotizacionesFiltradas.filter(c => c.estado === 'aceptada').length,\n    rechazadas: cotizacionesFiltradas.filter(c => c.estado === 'rechazada').length,\n  };\n\n  const handleFormSubmit = async (values: Cotizacion) => {\n    try {\n      if (editingCotizacion) {\n        await CotizacionService.actualizarCotizacion(editingCotizacion.id!, values);\n      } else {\n        await CotizacionService.crearCotizacion(values);\n      }\n      await cargarCotizaciones();\n    } catch (error) {\n      console.error('Error guardando cotizaci√≥n:', error);\n    } finally {\n      setShowForm(false);\n      setEditingCotizacion(null);\n    }\n  };\n\n  const handleEditar = (cotizacion: Cotizacion) => {\n    setEditingCotizacion(cotizacion);\n    setShowForm(true);\n  };\n\n  const handleEliminar = async (id: number) => {\n    setConfirmDialog({\n      isOpen: true,\n      cotizacionId: id\n    });\n  };\n\n  const confirmarEliminar = async () => {\n    if (confirmDialog.cotizacionId) {\n      try {\n        await CotizacionService.eliminarCotizacion(confirmDialog.cotizacionId);\n        await cargarCotizaciones();\n      } catch (error) {\n        console.error('Error eliminando cotizaci√≥n:', error);\n      } finally {\n        setConfirmDialog({ isOpen: false, cotizacionId: null });\n      }\n    }\n  };\n\n  const cancelarEliminar = () => {\n    setConfirmDialog({ isOpen: false, cotizacionId: null });\n  };\n\n  const handleDuplicar = async (id: number) => {\n    try {\n      await CotizacionService.duplicarCotizacion(id);\n      await cargarCotizaciones();\n    } catch (error) {\n      console.error('Error duplicando cotizaci√≥n:', error);\n    }\n  };\n\n  const handleCambiarEstado = async (id: number, nuevoEstado: string) => {\n    try {\n      await CotizacionService.cambiarEstado(id, nuevoEstado);\n      await cargarCotizaciones();\n    } catch (error) {\n      console.error('Error cambiando estado:', error);\n    }\n  };\n\n  const handleFiltersChange = (newFilters: FilterType) => {\n    setFilters(newFilters);\n    setCurrentPage(1); // Reset a la primera p√°gina al cambiar filtros\n  };\n\n  const handlePageChange = (page: number) => {\n    setCurrentPage(page);\n  };\n\n  const handleItemsPerPageChange = (items: number) => {\n    setItemsPerPage(items);\n    setCurrentPage(1);\n  };\n\n  return (\n    <CotizacionesLayout>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n          <div>\n            <h1 className=\"text-2xl font-bold text-gray-900\">Cotizaciones</h1>\n            <p className=\"text-gray-600\">Gestiona las cotizaciones de tu empresa</p>\n          </div>\n          <button\n            onClick={() => setShowForm(true)}\n            className=\"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors flex items-center justify-center whitespace-nowrap\"\n          >\n            <i className=\"ri-add-line mr-2\"></i>\n            Nueva Cotizaci√≥n\n          </button>\n        </div>\n\n        {/* Estad√≠sticas */}\n        <div className=\"grid grid-cols-2 sm:grid-cols-5 gap-4\">\n          <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\n            <div className=\"flex items-center\">\n              <div className=\"p-2 bg-blue-100 rounded-lg\">\n                <i className=\"ri-file-list-3-line text-blue-600\"></i>\n              </div>\n              <div className=\"ml-3\">\n                <p className=\"text-sm font-medium text-gray-600\">Total</p>\n                <p className=\"text-lg font-semibold text-gray-900\">{stats.total}</p>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\n            <div className=\"flex items-center\">\n              <div className=\"p-2 bg-gray-100 rounded-lg\">\n                <i className=\"ri-draft-line text-gray-600\"></i>\n              </div>\n              <div className=\"ml-3\">\n                <p className=\"text-sm font-medium text-gray-600\">Borradores</p>\n                <p className=\"text-lg font-semibold text-gray-900\">{stats.borradores}</p>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\n            <div className=\"flex items-center\">\n              <div className=\"p-2 bg-blue-100 rounded-lg\">\n                <i className=\"ri-send-plane-line text-blue-600\"></i>\n              </div>\n              <div className=\"ml-3\">\n                <p className=\"text-sm font-medium text-gray-600\">Enviadas</p>\n                <p className=\"text-lg font-semibold text-gray-900\">{stats.enviadas}</p>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\n            <div className=\"flex items-center\">\n              <div className=\"p-2 bg-green-100 rounded-lg\">\n                <i className=\"ri-check-line text-green-600\"></i>\n              </div>\n              <div className=\"ml-3\">\n                <p className=\"text-sm font-medium text-gray-600\">Aceptadas</p>\n                <p className=\"text-lg font-semibold text-gray-900\">{stats.aceptadas}</p>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\n            <div className=\"flex items-center\">\n              <div className=\"p-2 bg-red-100 rounded-lg\">\n                <i className=\"ri-close-line text-red-600\"></i>\n              </div>\n              <div className=\"ml-3\">\n                <p className=\"text-sm font-medium text-gray-600\">Rechazadas</p>\n                <p className=\"text-lg font-semibold text-gray-900\">{stats.rechazadas}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Filtros */}\n        <CotizacionesFilters\n          filters={filters}\n          onFiltersChange={handleFiltersChange}\n        />\n\n        {/* Controles de paginaci√≥n superiores */}\n        <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 bg-white p-4 rounded-lg border border-gray-200\">\n          <div className=\"flex items-center gap-4\">\n            <span className=\"text-sm text-gray-700\">\n              Mostrando {startIndex + 1} - {Math.min(endIndex, totalItems)} de {totalItems} cotizaciones\n            </span>\n          </div>\n          \n          <div className=\"flex items-center gap-4\">\n            <div className=\"flex items-center gap-2\">\n              <label className=\"text-sm text-gray-700\">Mostrar:</label>\n              <select\n                value={itemsPerPage}\n                onChange={(e) => handleItemsPerPageChange(Number(e.target.value))}\n                className=\"px-3 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-teal-500 focus:border-transparent\"\n              >\n                <option value={10}>10</option>\n                <option value={25}>25</option>\n                <option value={50}>50</option>\n              </select>\n            </div>\n\n            {totalPages > 1 && (\n              <div className=\"flex items-center gap-1\">\n                <button\n                  onClick={() => handlePageChange(1)}\n                  disabled={currentPage === 1}\n                  className=\"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  <i className=\"ri-skip-back-line\"></i>\n                </button>\n                <button\n                  onClick={() => handlePageChange(currentPage - 1)}\n                  disabled={currentPage === 1}\n                  className=\"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  <i className=\"ri-arrow-left-s-line\"></i>\n                </button>\n                \n                {/* P√°ginas numeradas */}\n                {Array.from({ length: Math.min(5, totalPages) }, (_, i) => {\n                  const pageNum = Math.max(1, Math.min(totalPages - 4, currentPage - 2)) + i;\n                  if (pageNum <= totalPages) {\n                    return (\n                      <button\n                        key={pageNum}\n                        onClick={() => handlePageChange(pageNum)}\n                        className={`px-3 py-1 text-sm border rounded ${\n                          currentPage === pageNum\n                            ? 'bg-teal-600 text-white border-teal-600'\n                            : 'border-gray-300 hover:bg-gray-50'\n                        }`}\n                      >\n                        {pageNum}\n                      </button>\n                    );\n                  }\n                  return null;\n                })}\n                \n                <button\n                  onClick={() => handlePageChange(currentPage + 1)}\n                  disabled={currentPage === totalPages}\n                  className=\"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  <i className=\"ri-arrow-right-s-line\"></i>\n                </button>\n                <button\n                  onClick={() => handlePageChange(totalPages)}\n                  disabled={currentPage === totalPages}\n                  className=\"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  <i className=\"ri-skip-forward-line\"></i>\n                </button>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Tabla */}\n        <CotizacionesTable\n          cotizaciones={cotizacionesPaginadas}\n          loading={loading}\n          onEditar={handleEditar}\n          onEliminar={handleEliminar}\n          onDuplicar={handleDuplicar}\n          onCambiarEstado={handleCambiarEstado}\n          onDescargarPDF={() => {}}\n        />\n\n        {/* Controles de paginaci√≥n inferiores */}\n        {totalPages > 1 && (\n          <div className=\"flex justify-center\">\n            <div className=\"flex items-center gap-1\">\n              <button\n                onClick={() => handlePageChange(1)}\n                disabled={currentPage === 1}\n                className=\"px-3 py-2 text-sm border border-gray-300 rounded-l hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                Primera\n              </button>\n              <button\n                onClick={() => handlePageChange(currentPage - 1)}\n                disabled={currentPage === 1}\n                className=\"px-3 py-2 text-sm border-t border-b border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                Anterior\n              </button>\n              \n              <span className=\"px-4 py-2 text-sm border-t border-b border-gray-300 bg-gray-50\">\n                P√°gina {currentPage} de {totalPages}\n              </span>\n              \n              <button\n                onClick={() => handlePageChange(currentPage + 1)}\n                disabled={currentPage === totalPages}\n                className=\"px-3 py-2 text-sm border-t border-b border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                Siguiente\n              </button>\n              <button\n                onClick={() => handlePageChange(totalPages)}\n                disabled={currentPage === totalPages}\n                className=\"px-3 py-2 text-sm border border-gray-300 rounded-r hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                √öltima\n              </button>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Modal de formulario */}\n      {showForm && (\n        <CotizacionForm\n          cotizacion={editingCotizacion}\n          onSubmit={handleFormSubmit}\n          onCancel={() => {\n            setShowForm(false);\n            setEditingCotizacion(null);\n          }}\n          isOpen={showForm}\n        />\n      )}\n\n      {/* Modal de confirmaci√≥n de eliminaci√≥n */}\n      <ConfirmationDialog\n        isOpen={confirmDialog.isOpen}\n        type=\"danger\"\n        title=\"Eliminar Cotizaci√≥n\"\n        message=\"¬øEst√° seguro de que desea eliminar esta cotizaci√≥n? Esta acci√≥n no se puede deshacer.\"\n        confirmText=\"Eliminar\"\n        cancelText=\"Cancelar\"\n        onConfirm={confirmarEliminar}\n        onCancel={cancelarEliminar}\n      />\n    </CotizacionesLayout>\n  );\n};\n\nexport default CotizacionesPage;\n"],"names":["CotizacionesLayout","children","sidebarOpen","setSidebarOpen","useState","jsxs","jsx","Sidebar","TopBar","MobileNav","CotizacionForm","cotizacion","onSubmit","onCancel","isOpen","formData","setFormData","clientes","setClientes","clientesFiltrados","setClientesFiltrados","busquedaCliente","setBusquedaCliente","mostrarListaClientes","setMostrarListaClientes","clienteSeleccionado","setClienteSeleccionado","productos","setProductos","productosFiltrados","setProductosFiltrados","busquedaProducto","setBusquedaProducto","mostrarListaProductos","setMostrarListaProductos","loading","setLoading","actualizandoTipoCambio","setActualizandoTipoCambio","mensajeTipoCambio","setMensajeTipoCambio","useEffect","cargarClientes","cargarProductos","obtenerTipoCambio","fechaVencimiento","cargarDatosCotizacion","prev","cotizacionData","cargarItemsCotizacion","error","cotizacionId","items","supabase","productosIds","item","id","productosInfo","productosError","itemsFormateados","productoInfo","p","calcularTotales","data","tipoCambio","CotizacionService","formatNumber","filtrarClientes","busqueda","filtrados","cliente","seleccionarCliente","filtrarProductos","producto","agregarProducto","nuevoItem","nuevosItems","actualizarItem","index","campo","valor","subtotalItem","descuentoItem","eliminarItem","_","i","subtotal","sum","descuentoValor","baseImponible","impuestos","total","handleInputChange","newData","handleSubmit","e","obtenerProductoPorId","productoId","info","Fragment","CotizacionesFilters","filters","onFiltersChange","showAdvanced","setShowAdvanced","clientesBusqueda","setClientesBusqueda","showClientesDropdown","setShowClientesDropdown","searchTimer","setSearchTimer","dropdownRef","useRef","ClienteService","c","handleClickOutside","event","handleFilterChange","key","value","handleSearchChange","handleClienteBusquedaChange","timer","limpiarCliente","clearFilters","hasActiveFilters","CotizacionesTable","cotizaciones","onEditar","onEliminar","onDuplicar","onCambiarEstado","onDescargarPDF","navigate","useNavigate","menuAbierto","setMenuAbierto","modalEnvio","setModalEnvio","datosEnvio","setDatosEnvio","enviandoCorreo","setEnviandoCorreo","getEstadoColor","estado","getEstadoTexto","formatFecha","fecha","toggleMenu","generarPDF","cotizacionError","itemsData","itemsError","productIds","productosData","itemsConProductos","cotizacionCompleta","htmlContent","generarHTMLPDF","blob","url","link","direccion","formatearMoneda","abrirModalEnvio","correoCliente","asuntoDefault","mensajeDefault","cerrarModalEnvio","enviarCotizacionPorCorreo","htmlCotizacion","generarHTMLParaEnvio","mailtoLink","verCotizacionDetallada","descargarPDFDetallado","CotizacionesPage","showForm","setShowForm","editingCotizacion","setEditingCotizacion","setCotizaciones","setFilters","currentPage","setCurrentPage","itemsPerPage","setItemsPerPage","confirmDialog","setConfirmDialog","cargarCotizaciones","cotizacionesFiltradas","cumpleFiltros","searchTerm","totalItems","totalPages","startIndex","endIndex","cotizacionesPaginadas","stats","handleFormSubmit","values","handleEditar","handleEliminar","confirmarEliminar","cancelarEliminar","handleDuplicar","handleCambiarEstado","nuevoEstado","handleFiltersChange","newFilters","handlePageChange","page","handleItemsPerPageChange","pageNum","ConfirmationDialog"],"mappings":"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"}