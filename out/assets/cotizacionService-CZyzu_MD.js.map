{"version":3,"file":"cotizacionService-CZyzu_MD.js","sources":["../../src/services/cotizacionService.ts"],"sourcesContent":["// Import statements\nimport { supabase } from '../lib/supabase';\n\nclass CotizacionService {\n  /**\n   * Obtener tipo de cambio del Banco Central de Costa Rica (BCCR)\n   */\n  static async obtenerTipoCambioBCCR(): Promise<number> {\n    try {\n      console.log('üí± [COTIZACI√ìN SERVICE] Obteniendo tipo de cambio del BCCR...');\n\n      // Intentar obtener el tipo de cambio desde la API del BCCR\n      // Nota: Esta es una implementaci√≥n b√°sica. En producci√≥n, deber√≠as usar\n      // un Edge Function para manejar CORS y autenticaci√≥n\n      \n      try {\n        const response = await fetch('https://gee.bccr.fi.cr/indicadoreseconomicos/Cuadros/frmVerCatCuadro.aspx?idioma=1&CodCuadro=%20400');\n        \n        if (response.ok) {\n          // Si la API responde, intentar parsear el tipo de cambio\n          // Por ahora, retornamos un valor por defecto\n          console.log('‚úÖ [COTIZACI√ìN SERVICE] Tipo de cambio obtenido del BCCR');\n          return 540.00; // Valor por defecto\n        }\n      } catch (apiError) {\n        console.warn('‚ö†Ô∏è [COTIZACI√ìN SERVICE] No se pudo conectar con BCCR, usando valor por defecto');\n      }\n\n      // Si falla la API, usar un valor por defecto razonable\n      const tipoCambioDefault = 540.00;\n      console.log('üí± [COTIZACI√ìN SERVICE] Usando tipo de cambio por defecto:', tipoCambioDefault);\n      \n      return tipoCambioDefault;\n    } catch (error) {\n      console.error('‚ùå [COTIZACI√ìN SERVICE] Error obteniendo tipo de cambio:', error);\n      // En caso de error, retornar un valor por defecto\n      return 540.00;\n    }\n  }\n\n  /**\n   * Obtener todas las cotizaciones con filtros opcionales\n   */\n  static async obtenerCotizaciones(filters?: any) {\n    try {\n      console.log('üìã [COTIZACI√ìN SERVICE] Obteniendo cotizaciones...', filters);\n\n      let query = supabase\n        .from('cotizaciones')\n        .select(`\n          *,\n          clientes (\n            id,\n            nombre_razon_social,\n            identificacion,\n            correo_principal,\n            telefono_numero\n          )\n        `)\n        .order('created_at', { ascending: false });\n\n      // Aplicar filtros si existen\n      if (filters?.cliente_id) {\n        query = query.eq('cliente_id', filters.cliente_id);\n      }\n\n      if (filters?.estado) {\n        query = query.eq('estado', filters.estado);\n      }\n\n      if (filters?.moneda) {\n        query = query.eq('moneda', filters.moneda);\n      }\n\n      if (filters?.fecha_desde) {\n        query = query.gte('fecha_emision', filters.fecha_desde);\n      }\n\n      if (filters?.fecha_hasta) {\n        query = query.lte('fecha_emision', filters.fecha_hasta);\n      }\n\n      const { data, error } = await query;\n\n      if (error) throw error;\n\n      console.log('‚úÖ [COTIZACI√ìN SERVICE] Cotizaciones obtenidas:', data?.length || 0);\n      \n      // üîç LOG: Verificar metadata en las cotizaciones\n      if (data && data.length > 0) {\n        const cotizacionesConMetadata = data.filter(c => c.metadata);\n        console.log('üîç [METADATA CHECK] Cotizaciones con metadata:', cotizacionesConMetadata.length);\n        \n        cotizacionesConMetadata.forEach(c => {\n          console.log('üîç [METADATA CHECK] Cotizaci√≥n:', {\n            id: c.id,\n            codigo: c.codigo,\n            metadata_tipo: c.metadata?.tipo,\n            metadata_completa: c.metadata\n          });\n        });\n      }\n      \n      return data || [];\n    } catch (error) {\n      console.error('‚ùå [COTIZACI√ìN SERVICE] Error obteniendo cotizaciones:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Obtener una cotizaci√≥n por ID\n   */\n  static async obtenerCotizacionPorId(id: number) {\n    try {\n      console.log('üìã [COTIZACI√ìN SERVICE] Obteniendo cotizaci√≥n ID:', id);\n\n      const { data, error } = await supabase\n        .from('cotizaciones')\n        .select(`\n          *,\n          clientes (\n            id,\n            nombre_razon_social,\n            identificacion,\n            correo_principal,\n            telefono_numero,\n            otras_senas\n          )\n        `)\n        .eq('id', id)\n        .single();\n\n      if (error) throw error;\n\n      console.log('‚úÖ [COTIZACI√ìN SERVICE] Cotizaci√≥n obtenida:', data);\n      return data;\n    } catch (error) {\n      console.error('‚ùå [COTIZACI√ìN SERVICE] Error obteniendo cotizaci√≥n:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Actualizar cotizaci√≥n existente\n   */\n  static async actualizarCotizacion(id: number, cotizacionData: any) {\n    try {\n      console.log('üìã [COTIZACI√ìN SERVICE] Actualizando cotizaci√≥n ID:', id);\n\n      const cotizacionFormatted = {\n        cliente_id: parseInt(cotizacionData.cliente_id),\n        estado: cotizacionData.estado,\n        fecha_emision: cotizacionData.fecha_emision,\n        fecha_vencimiento: cotizacionData.fecha_vencimiento,\n        moneda: cotizacionData.moneda,\n        tipo_cambio: this.formatNumericValue(cotizacionData.tipo_cambio, 'exchange'),\n        descuento_global: this.formatNumericValue(cotizacionData.descuento_global || 0, 'percentage'),\n        descuento_valor: this.formatNumericValue(cotizacionData.descuento_valor || 0, 'currency'),\n        impuestos: this.formatNumericValue(cotizacionData.impuestos, 'tax'),\n        flete: this.formatNumericValue(cotizacionData.flete || 0, 'currency'),\n        otros: this.formatNumericValue(cotizacionData.otros || 0, 'currency'),\n        subtotal: this.formatNumericValue(cotizacionData.subtotal, 'currency'),\n        total: this.formatNumericValue(cotizacionData.total, 'currency'),\n        updated_at: new Date().toISOString()\n      };\n\n      const { data, error } = await supabase\n        .from('cotizaciones')\n        .update(cotizacionFormatted)\n        .eq('id', id)\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      // Actualizar items si se proporcionan\n      if (cotizacionData.items && cotizacionData.items.length > 0) {\n        // Eliminar items existentes\n        await supabase\n          .from('cotizacion_items')\n          .delete()\n          .eq('cotizacion_id', id);\n\n        // Insertar nuevos items\n        const items = cotizacionData.items.map((item: any) => ({\n          cotizacion_id: id,\n          producto_id: item.producto_id,\n          tipo_item: item.tipo_item || 'normal',\n          descripcion: item.descripcion,\n          cantidad: this.formatNumericValue(item.cantidad, 'quantity'),\n          precio_unitario: this.formatNumericValue(item.precio_unitario, 'quantity'),\n          descuento: this.formatNumericValue(item.descuento || 0, 'item_discount'),\n          subtotal: this.formatNumericValue(item.subtotal, 'quantity')\n        }));\n\n        await supabase\n          .from('cotizacion_items')\n          .insert(items);\n      }\n\n      console.log('‚úÖ [COTIZACI√ìN SERVICE] Cotizaci√≥n actualizada');\n      return data;\n    } catch (error) {\n      console.error('‚ùå [COTIZACI√ìN SERVICE] Error actualizando cotizaci√≥n:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Eliminar cotizaci√≥n\n   */\n  static async eliminarCotizacion(id: number) {\n    try {\n      console.log('üìã [COTIZACI√ìN SERVICE] Eliminando cotizaci√≥n ID:', id);\n\n      // Primero eliminar items\n      await supabase\n        .from('cotizacion_items')\n        .delete()\n        .eq('cotizacion_id', id);\n\n      // Luego eliminar cotizaci√≥n\n      const { error } = await supabase\n        .from('cotizaciones')\n        .delete()\n        .eq('id', id);\n\n      if (error) throw error;\n\n      console.log('‚úÖ [COTIZACI√ìN SERVICE] Cotizaci√≥n eliminada');\n    } catch (error) {\n      console.error('‚ùå [COTIZACI√ìN SERVICE] Error eliminando cotizaci√≥n:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Duplicar cotizaci√≥n\n   */\n  static async duplicarCotizacion(id: number) {\n    try {\n      console.log('üìã [COTIZACI√ìN SERVICE] Duplicando cotizaci√≥n ID:', id);\n\n      // Obtener cotizaci√≥n original\n      const { data: cotizacionOriginal, error: errorCotizacion } = await supabase\n        .from('cotizaciones')\n        .select('*')\n        .eq('id', id)\n        .single();\n\n      if (errorCotizacion) throw errorCotizacion;\n\n      // Obtener items originales\n      const { data: itemsOriginales, error: errorItems } = await supabase\n        .from('cotizacion_items')\n        .select('*')\n        .eq('cotizacion_id', id);\n\n      if (errorItems) throw errorItems;\n\n      // Crear nueva cotizaci√≥n\n      const timestamp = Date.now();\n      const codigo = `COT-${timestamp.toString().slice(-8)}`;\n\n      const nuevaCotizacion = {\n        ...cotizacionOriginal,\n        id: undefined,\n        codigo,\n        estado: 'borrador',\n        created_at: new Date().toISOString(),\n        updated_at: new Date().toISOString()\n      };\n\n      const { data: cotizacionCreada, error: errorCrear } = await supabase\n        .from('cotizaciones')\n        .insert(nuevaCotizacion)\n        .select()\n        .single();\n\n      if (errorCrear) throw errorCrear;\n\n      // Duplicar items\n      if (itemsOriginales && itemsOriginales.length > 0) {\n        const nuevosItems = itemsOriginales.map((item: any) => ({\n          ...item,\n          id: undefined,\n          cotizacion_id: cotizacionCreada.id\n        }));\n\n        await supabase\n          .from('cotizacion_items')\n          .insert(nuevosItems);\n      }\n\n      console.log('‚úÖ [COTIZACI√ìN SERVICE] Cotizaci√≥n duplicada');\n      return cotizacionCreada;\n    } catch (error) {\n      console.error('‚ùå [COTIZACI√ìN SERVICE] Error duplicando cotizaci√≥n:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Cambiar estado de cotizaci√≥n\n   */\n  static async cambiarEstado(id: number, nuevoEstado: string) {\n    try {\n      console.log('üìã [COTIZACI√ìN SERVICE] Cambiando estado de cotizaci√≥n ID:', id, 'a', nuevoEstado);\n\n      const { data, error } = await supabase\n        .from('cotizaciones')\n        .update({ \n          estado: nuevoEstado,\n          updated_at: new Date().toISOString()\n        })\n        .eq('id', id)\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      console.log('‚úÖ [COTIZACI√ìN SERVICE] Estado cambiado');\n      return data;\n    } catch (error) {\n      console.error('‚ùå [COTIZACI√ìN SERVICE] Error cambiando estado:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Crear nueva cotizaci√≥n\n   */\n  static async crearCotizacion(cotizacionData: any) {\n    try {\n      console.log('üìã [COTIZACI√ìN SERVICE] Creando cotizaci√≥n...', {\n        tiene_metadata: !!cotizacionData.metadata,\n        tipo: cotizacionData.metadata?.tipo,\n        items_optimizador_count: cotizacionData.items_optimizador?.length || 0,\n        items_inventario_count: cotizacionData.items_inventario?.length || 0,\n        items_count: cotizacionData.items?.length || 0\n      });\n\n      // üîç LOG DETALLADO: Verificar metadata\n      if (cotizacionData.metadata) {\n        console.log('üîç [OPT_QUOTE_DEBUG] Metadata recibida:', {\n          tipo: cotizacionData.metadata.tipo,\n          proyecto_id: cotizacionData.metadata.proyecto_id,\n          margen_utilidad: cotizacionData.metadata.margen_utilidad\n        });\n      }\n\n      // Generar c√≥digo de cotizaci√≥n autom√°tico basado en timestamp\n      const timestamp = Date.now();\n      const codigo = `COT-${timestamp.toString().slice(-8)}`;\n\n      // Formatear valores num√©ricos para evitar overflow con tipos espec√≠ficos\n      const cotizacionFormatted = {\n        codigo,\n        cliente_id: parseInt(cotizacionData.cliente_id),\n        estado: cotizacionData.estado,\n        fecha_emision: cotizacionData.fecha_emision,\n        fecha_vencimiento: cotizacionData.fecha_vencimiento,\n        moneda: cotizacionData.moneda,\n        tipo_cambio: this.formatNumericValue(cotizacionData.tipo_cambio, 'exchange'),\n        descuento_global: this.formatNumericValue(cotizacionData.descuento_global || 0, 'percentage'),\n        descuento_valor: this.formatNumericValue(cotizacionData.descuento_valor || 0, 'currency'),\n        impuestos: this.formatNumericValue(cotizacionData.impuestos, 'tax'),\n        flete: this.formatNumericValue(cotizacionData.flete || 0, 'currency'),\n        otros: this.formatNumericValue(cotizacionData.otros || 0, 'currency'),\n        subtotal: this.formatNumericValue(cotizacionData.subtotal, 'currency'),\n        total: this.formatNumericValue(cotizacionData.total, 'currency'),\n        metadata: cotizacionData.metadata || null,\n        created_at: new Date().toISOString()\n      };\n\n      console.log('üíæ [COTIZACI√ìN SERVICE] Guardando cotizaci√≥n con metadata:', {\n        tiene_metadata: !!cotizacionFormatted.metadata,\n        metadata_tipo: cotizacionFormatted.metadata?.tipo\n      });\n\n      // Crear cotizaci√≥n\n      const { data: cotizacion, error: cotizacionError } = await supabase\n        .from('cotizaciones')\n        .insert(cotizacionFormatted)\n        .select()\n        .single();\n\n      if (cotizacionError) throw cotizacionError;\n\n      console.log('‚úÖ [COTIZACI√ìN SERVICE] Cotizaci√≥n creada:', {\n        id: cotizacion.id,\n        codigo: cotizacion.codigo,\n        tiene_metadata: !!cotizacion.metadata,\n        metadata_tipo: cotizacion.metadata?.tipo\n      });\n\n      // üÜï PROCESAR ITEMS - Soporta dos estructuras:\n      // 1. items_optimizador + items_inventario (nueva estructura del optimizador)\n      // 2. items (estructura tradicional)\n      \n      const itemsOptimizador = cotizacionData.items_optimizador || [];\n      const itemsInventario = cotizacionData.items_inventario || [];\n      const itemsTradicionales = cotizacionData.items || [];\n\n      const totalItems = itemsOptimizador.length + itemsInventario.length + itemsTradicionales.length;\n\n      if (totalItems > 0) {\n        console.log('üì¶ [COTIZACI√ìN SERVICE] Procesando items...', {\n          items_optimizador: itemsOptimizador.length,\n          items_inventario: itemsInventario.length,\n          items_tradicionales: itemsTradicionales.length,\n          total: totalItems\n        });\n\n        const itemsParaGuardar = [];\n\n        // üÜï PROCESAR ITEMS DEL OPTIMIZADOR\n        if (itemsOptimizador.length > 0) {\n          console.log('üéØ [OPT_QUOTE_SAVE] Procesando items del OPTIMIZADOR');\n          \n          itemsOptimizador.forEach((item: any, index: number) => {\n            // Construir texto de tapacantos\n            const tapacantos = [];\n            if (item.tapacanto_superior) tapacantos.push(`Sup: ${item.tapacanto_superior}`);\n            if (item.tapacanto_inferior) tapacantos.push(`Inf: ${item.tapacanto_inferior}`);\n            if (item.tapacanto_izquierdo) tapacantos.push(`Izq: ${item.tapacanto_izquierdo}`);\n            if (item.tapacanto_derecho) tapacantos.push(`Der: ${item.tapacanto_derecho}`);\n            \n            const tapacantosText = tapacantos.length > 0 ? tapacantos.join(', ') : 'Sin tapacantos';\n\n            // Construir texto de material\n            const materialText = item.material_codigo && item.material_nombre \n              ? `${item.material_codigo} - ${item.material_nombre}`\n              : item.material_codigo || item.material_nombre || 'Sin especificar';\n\n            // Construir texto de dimensiones\n            const dimensionesText = item.largo && item.ancho \n              ? `${item.largo} √ó ${item.ancho} mm`\n              : '-';\n\n            // üîß LOG: Verificar datos CNC recibidos\n            console.log(`üîç [CNC SAVE] Item ${index + 1} \"${item.descripcion}\":`, {\n              cnc1_codigo: item.cnc1_codigo,\n              cnc1_cantidad: item.cnc1_cantidad,\n              cnc2_codigo: item.cnc2_codigo,\n              cnc2_cantidad: item.cnc2_cantidad,\n              costo_cnc: item.costo_cnc\n            });\n\n            const itemData = {\n              cotizacion_id: cotizacion.id,\n              producto_id: null,\n              tipo_item: 'optimizador',\n              descripcion: item.descripcion || `Pieza ${index + 1}`,\n              dimensiones: dimensionesText,\n              material: materialText,\n              tapacantos: tapacantosText,\n              cnc1: '', // Dejar vac√≠o (legacy)\n              cnc2: '', // Dejar vac√≠o (legacy)\n              cantidad: this.formatNumericValue(item.cantidad, 'quantity'),\n              precio_unitario: this.formatNumericValue(item.precio_unitario, 'quantity'),\n              descuento: this.formatNumericValue(item.descuento || 0, 'item_discount'),\n              subtotal: this.formatNumericValue(item.subtotal, 'quantity'),\n              datos_optimizador: {\n                descripcion: item.descripcion,\n                largo: item.largo,\n                ancho: item.ancho,\n                material_codigo: item.material_codigo,\n                material_nombre: item.material_nombre,\n                veta: item.veta,\n                tapacanto_superior: item.tapacanto_superior,\n                tapacanto_inferior: item.tapacanto_inferior,\n                tapacanto_izquierdo: item.tapacanto_izquierdo,\n                tapacanto_derecho: item.tapacanto_derecho,\n                // üîß GUARDAR CNC CON ESTRUCTURA FIJA\n                cnc1_codigo: item.cnc1_codigo || '',\n                cnc1_cantidad: item.cnc1_cantidad || 0,\n                cnc2_codigo: item.cnc2_codigo || '',\n                cnc2_cantidad: item.cnc2_cantidad || 0,\n                // üîß GUARDAR COSTOS CALCULADOS\n                costo_material: item.costo_material || 0,\n                costo_tapacantos: item.costo_tapacantos || 0,\n                costo_cnc: item.costo_cnc || 0,\n                costo_total: item.costo_total || 0\n              }\n            };\n\n            itemsParaGuardar.push(itemData);\n          });\n        }\n\n        // üÜï PROCESAR ITEMS DEL INVENTARIO\n        if (itemsInventario.length > 0) {\n          console.log('üì¶ [INVENTORY_ITEMS] Procesando items del INVENTARIO');\n          \n          itemsInventario.forEach((item: any) => {\n            const itemData = {\n              cotizacion_id: cotizacion.id,\n              producto_id: item.inventario_id || null,\n              tipo_item: 'optimizador',\n              descripcion: `${item.codigo} - ${item.descripcion}`,\n              dimensiones: null,\n              material: null,\n              tapacantos: null,\n              cnc1: null,\n              cnc2: null,\n              cantidad: this.formatNumericValue(item.cantidad, 'quantity'),\n              precio_unitario: this.formatNumericValue(item.precio_unitario, 'quantity'),\n              descuento: this.formatNumericValue(item.descuento || 0, 'item_discount'),\n              subtotal: this.formatNumericValue(item.subtotal, 'quantity'),\n              datos_optimizador: null\n            };\n\n            itemsParaGuardar.push(itemData);\n          });\n        }\n\n        // PROCESAR ITEMS TRADICIONALES (compatibilidad con cotizaciones normales)\n        if (itemsTradicionales.length > 0) {\n          console.log('üìù [COTIZACI√ìN] Procesando items TRADICIONALES');\n          \n          // Obtener informaci√≥n de productos\n          const productosIds = itemsTradicionales\n            .map((item: any) => item.producto_id)\n            .filter((id: any) => id);\n\n          let productos = [];\n          if (productosIds.length > 0) {\n            const { data: productosData } = await supabase\n              .from('productos')\n              .select('id_producto, descripcion_producto')\n              .in('id_producto', productosIds);\n            productos = productosData || [];\n          }\n\n          itemsTradicionales.forEach((item: any) => {\n            const producto = productos.find((p: any) => p.id_producto === item.producto_id);\n            const itemData = {\n              cotizacion_id: cotizacion.id,\n              producto_id: item.producto_id,\n              tipo_item: 'normal',\n              descripcion: producto?.descripcion_producto || `Producto ID: ${item.producto_id}`,\n              dimensiones: null,\n              material: null,\n              tapacantos: null,\n              cnc1: null,\n              cnc2: null,\n              cantidad: this.formatNumericValue(item.cantidad, 'quantity'),\n              precio_unitario: this.formatNumericValue(item.precio_unitario, 'quantity'),\n              descuento: this.formatNumericValue(item.descuento || 0, 'item_discount'),\n              subtotal: this.formatNumericValue(item.subtotal, 'quantity'),\n              datos_optimizador: null\n            };\n\n            itemsParaGuardar.push(itemData);\n          });\n        }\n\n        console.log('üíæ [COTIZACI√ìN SERVICE] Guardando items en BD...', {\n          total_items: itemsParaGuardar.length,\n          items_optimizador: itemsParaGuardar.filter(i => i.tipo_item === 'optimizador').length,\n          items_inventario: itemsParaGuardar.filter(i => i.tipo_item === 'inventario').length,\n          items_normales: itemsParaGuardar.filter(i => i.tipo_item === 'normal').length\n        });\n\n        const { error: itemsError } = await supabase\n          .from('cotizacion_items')\n          .insert(itemsParaGuardar);\n\n        if (itemsError) {\n          console.error('‚ùå [COTIZACI√ìN SERVICE] Error guardando items:', itemsError);\n          throw itemsError;\n        }\n\n        console.log('‚úÖ [COTIZACI√ìN SERVICE] Items guardados correctamente');\n      }\n\n      return cotizacion;\n    } catch (error) {\n      console.error('‚ùå [COTIZACI√ìN SERVICE] Error creando cotizaci√≥n:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Formatear valores num√©ricos seg√∫n el tipo para evitar overflow\n   */\n  private static formatNumericValue(value: any, type: 'exchange' | 'percentage' | 'tax' | 'currency' | 'quantity' | 'item_discount'): number {\n    if (value === null || value === undefined || value === '') {\n      return 0;\n    }\n\n    const numValue = parseFloat(value);\n\n    if (isNaN(numValue)) {\n      console.warn(`‚ö†Ô∏è [COTIZACI√ìN SERVICE] Valor num√©rico inv√°lido para tipo ${type}:`, value);\n      return 0;\n    }\n\n    // Validar rangos seg√∫n el tipo\n    switch (type) {\n      case 'exchange':\n      case 'percentage':\n      case 'tax':\n        return Math.min(Math.max(numValue, 0), 999.99);\n      \n      case 'currency':\n      case 'quantity':\n      case 'item_discount':\n        return Math.min(Math.max(numValue, 0), 999999.99);\n      \n      default:\n        return Math.min(Math.max(numValue, 0), 999999.99);\n    }\n  }\n}\n\n// ‚úÖ Exportar tanto como default como named export para compatibilidad\nexport { CotizacionService };\nexport default CotizacionService;\n"],"names":["CotizacionService","tipoCambioDefault","error","filters","query","supabase","data","cotizacionesConMetadata","c","id","cotizacionData","cotizacionFormatted","items","item","cotizacionOriginal","errorCotizacion","itemsOriginales","errorItems","codigo","nuevaCotizacion","cotizacionCreada","errorCrear","nuevosItems","nuevoEstado","cotizacion","cotizacionError","itemsOptimizador","itemsInventario","itemsTradicionales","totalItems","itemsParaGuardar","index","tapacantos","tapacantosText","materialText","dimensionesText","itemData","productosIds","productos","productosData","producto","p","i","itemsError","value","type","numValue"],"mappings":"wCAGA,MAAMA,CAAkB,CAItB,aAAa,uBAAyC,CACpD,GAAI,CACF,QAAQ,IAAI,+DAA+D,EAM3E,GAAI,CAGF,IAFiB,MAAM,MAAM,qGAAqG,GAErH,GAGX,eAAQ,IAAI,yDAAyD,EAC9D,GAEX,MAAmB,CACjB,QAAQ,KAAK,gFAAgF,CAC/F,CAGA,MAAMC,EAAoB,IAC1B,eAAQ,IAAI,6DAA8DA,CAAiB,EAEpFA,CACT,OAASC,EAAO,CACd,eAAQ,MAAM,0DAA2DA,CAAK,EAEvE,GACT,CACF,CAKA,aAAa,oBAAoBC,EAAe,CAC9C,GAAI,CACF,QAAQ,IAAI,qDAAsDA,CAAO,EAEzE,IAAIC,EAAQC,EACT,KAAK,cAAc,EACnB,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SASP,EACA,MAAM,aAAc,CAAE,UAAW,GAAO,EAGvCF,GAAS,aACXC,EAAQA,EAAM,GAAG,aAAcD,EAAQ,UAAU,GAG/CA,GAAS,SACXC,EAAQA,EAAM,GAAG,SAAUD,EAAQ,MAAM,GAGvCA,GAAS,SACXC,EAAQA,EAAM,GAAG,SAAUD,EAAQ,MAAM,GAGvCA,GAAS,cACXC,EAAQA,EAAM,IAAI,gBAAiBD,EAAQ,WAAW,GAGpDA,GAAS,cACXC,EAAQA,EAAM,IAAI,gBAAiBD,EAAQ,WAAW,GAGxD,KAAM,CAAE,KAAAG,EAAM,MAAAJ,CAAA,EAAU,MAAME,EAE9B,GAAIF,EAAO,MAAMA,EAKjB,GAHA,QAAQ,IAAI,iDAAkDI,GAAM,QAAU,CAAC,EAG3EA,GAAQA,EAAK,OAAS,EAAG,CAC3B,MAAMC,EAA0BD,EAAK,OAAOE,GAAKA,EAAE,QAAQ,EAC3D,QAAQ,IAAI,iDAAkDD,EAAwB,MAAM,EAE5FA,EAAwB,QAAQC,GAAK,CACnC,QAAQ,IAAI,kCAAmC,CAC7C,GAAIA,EAAE,GACN,OAAQA,EAAE,OACV,cAAeA,EAAE,UAAU,KAC3B,kBAAmBA,EAAE,QAAA,CACtB,CACH,CAAC,CACH,CAEA,OAAOF,GAAQ,CAAA,CACjB,OAASJ,EAAO,CACd,cAAQ,MAAM,wDAAyDA,CAAK,EACtEA,CACR,CACF,CAKA,aAAa,uBAAuBO,EAAY,CAC9C,GAAI,CACF,QAAQ,IAAI,oDAAqDA,CAAE,EAEnE,KAAM,CAAE,KAAAH,EAAM,MAAAJ,GAAU,MAAMG,EAC3B,KAAK,cAAc,EACnB,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAUP,EACA,GAAG,KAAMI,CAAE,EACX,OAAA,EAEH,GAAIP,EAAO,MAAMA,EAEjB,eAAQ,IAAI,8CAA+CI,CAAI,EACxDA,CACT,OAASJ,EAAO,CACd,cAAQ,MAAM,sDAAuDA,CAAK,EACpEA,CACR,CACF,CAKA,aAAa,qBAAqBO,EAAYC,EAAqB,CACjE,GAAI,CACF,QAAQ,IAAI,sDAAuDD,CAAE,EAErE,MAAME,EAAsB,CAC1B,WAAY,SAASD,EAAe,UAAU,EAC9C,OAAQA,EAAe,OACvB,cAAeA,EAAe,cAC9B,kBAAmBA,EAAe,kBAClC,OAAQA,EAAe,OACvB,YAAa,KAAK,mBAAmBA,EAAe,YAAa,UAAU,EAC3E,iBAAkB,KAAK,mBAAmBA,EAAe,kBAAoB,EAAG,YAAY,EAC5F,gBAAiB,KAAK,mBAAmBA,EAAe,iBAAmB,EAAG,UAAU,EACxF,UAAW,KAAK,mBAAmBA,EAAe,UAAW,KAAK,EAClE,MAAO,KAAK,mBAAmBA,EAAe,OAAS,EAAG,UAAU,EACpE,MAAO,KAAK,mBAAmBA,EAAe,OAAS,EAAG,UAAU,EACpE,SAAU,KAAK,mBAAmBA,EAAe,SAAU,UAAU,EACrE,MAAO,KAAK,mBAAmBA,EAAe,MAAO,UAAU,EAC/D,WAAY,IAAI,KAAA,EAAO,YAAA,CAAY,EAG/B,CAAE,KAAAJ,EAAM,MAAAJ,CAAA,EAAU,MAAMG,EAC3B,KAAK,cAAc,EACnB,OAAOM,CAAmB,EAC1B,GAAG,KAAMF,CAAE,EACX,OAAA,EACA,OAAA,EAEH,GAAIP,EAAO,MAAMA,EAGjB,GAAIQ,EAAe,OAASA,EAAe,MAAM,OAAS,EAAG,CAE3D,MAAML,EACH,KAAK,kBAAkB,EACvB,SACA,GAAG,gBAAiBI,CAAE,EAGzB,MAAMG,EAAQF,EAAe,MAAM,IAAKG,IAAe,CACrD,cAAeJ,EACf,YAAaI,EAAK,YAClB,UAAWA,EAAK,WAAa,SAC7B,YAAaA,EAAK,YAClB,SAAU,KAAK,mBAAmBA,EAAK,SAAU,UAAU,EAC3D,gBAAiB,KAAK,mBAAmBA,EAAK,gBAAiB,UAAU,EACzE,UAAW,KAAK,mBAAmBA,EAAK,WAAa,EAAG,eAAe,EACvE,SAAU,KAAK,mBAAmBA,EAAK,SAAU,UAAU,CAAA,EAC3D,EAEF,MAAMR,EACH,KAAK,kBAAkB,EACvB,OAAOO,CAAK,CACjB,CAEA,eAAQ,IAAI,+CAA+C,EACpDN,CACT,OAASJ,EAAO,CACd,cAAQ,MAAM,wDAAyDA,CAAK,EACtEA,CACR,CACF,CAKA,aAAa,mBAAmBO,EAAY,CAC1C,GAAI,CACF,QAAQ,IAAI,oDAAqDA,CAAE,EAGnE,MAAMJ,EACH,KAAK,kBAAkB,EACvB,SACA,GAAG,gBAAiBI,CAAE,EAGzB,KAAM,CAAE,MAAAP,CAAA,EAAU,MAAMG,EACrB,KAAK,cAAc,EACnB,OAAA,EACA,GAAG,KAAMI,CAAE,EAEd,GAAIP,EAAO,MAAMA,EAEjB,QAAQ,IAAI,6CAA6C,CAC3D,OAASA,EAAO,CACd,cAAQ,MAAM,sDAAuDA,CAAK,EACpEA,CACR,CACF,CAKA,aAAa,mBAAmBO,EAAY,CAC1C,GAAI,CACF,QAAQ,IAAI,oDAAqDA,CAAE,EAGnE,KAAM,CAAE,KAAMK,EAAoB,MAAOC,CAAA,EAAoB,MAAMV,EAChE,KAAK,cAAc,EACnB,OAAO,GAAG,EACV,GAAG,KAAMI,CAAE,EACX,OAAA,EAEH,GAAIM,EAAiB,MAAMA,EAG3B,KAAM,CAAE,KAAMC,EAAiB,MAAOC,CAAA,EAAe,MAAMZ,EACxD,KAAK,kBAAkB,EACvB,OAAO,GAAG,EACV,GAAG,gBAAiBI,CAAE,EAEzB,GAAIQ,EAAY,MAAMA,EAItB,MAAMC,EAAS,OADG,KAAK,IAAA,EACS,WAAW,MAAM,EAAE,CAAC,GAE9CC,EAAkB,CACtB,GAAGL,EACH,GAAI,OACJ,OAAAI,EACA,OAAQ,WACR,WAAY,IAAI,KAAA,EAAO,YAAA,EACvB,WAAY,IAAI,KAAA,EAAO,YAAA,CAAY,EAG/B,CAAE,KAAME,EAAkB,MAAOC,CAAA,EAAe,MAAMhB,EACzD,KAAK,cAAc,EACnB,OAAOc,CAAe,EACtB,OAAA,EACA,OAAA,EAEH,GAAIE,EAAY,MAAMA,EAGtB,GAAIL,GAAmBA,EAAgB,OAAS,EAAG,CACjD,MAAMM,EAAcN,EAAgB,IAAKH,IAAe,CACtD,GAAGA,EACH,GAAI,OACJ,cAAeO,EAAiB,EAAA,EAChC,EAEF,MAAMf,EACH,KAAK,kBAAkB,EACvB,OAAOiB,CAAW,CACvB,CAEA,eAAQ,IAAI,6CAA6C,EAClDF,CACT,OAASlB,EAAO,CACd,cAAQ,MAAM,sDAAuDA,CAAK,EACpEA,CACR,CACF,CAKA,aAAa,cAAcO,EAAYc,EAAqB,CAC1D,GAAI,CACF,QAAQ,IAAI,6DAA8Dd,EAAI,IAAKc,CAAW,EAE9F,KAAM,CAAE,KAAAjB,EAAM,MAAAJ,GAAU,MAAMG,EAC3B,KAAK,cAAc,EACnB,OAAO,CACN,OAAQkB,EACR,WAAY,IAAI,KAAA,EAAO,YAAA,CAAY,CACpC,EACA,GAAG,KAAMd,CAAE,EACX,OAAA,EACA,OAAA,EAEH,GAAIP,EAAO,MAAMA,EAEjB,eAAQ,IAAI,wCAAwC,EAC7CI,CACT,OAASJ,EAAO,CACd,cAAQ,MAAM,iDAAkDA,CAAK,EAC/DA,CACR,CACF,CAKA,aAAa,gBAAgBQ,EAAqB,CAChD,GAAI,CACF,QAAQ,IAAI,gDAAiD,CAC3D,eAAgB,CAAC,CAACA,EAAe,SACjC,KAAMA,EAAe,UAAU,KAC/B,wBAAyBA,EAAe,mBAAmB,QAAU,EACrE,uBAAwBA,EAAe,kBAAkB,QAAU,EACnE,YAAaA,EAAe,OAAO,QAAU,CAAA,CAC9C,EAGGA,EAAe,UACjB,QAAQ,IAAI,0CAA2C,CACrD,KAAMA,EAAe,SAAS,KAC9B,YAAaA,EAAe,SAAS,YACrC,gBAAiBA,EAAe,SAAS,eAAA,CAC1C,EAQH,MAAMC,EAAsB,CAC1B,OAJa,OADG,KAAK,IAAA,EACS,WAAW,MAAM,EAAE,CAAC,GAKlD,WAAY,SAASD,EAAe,UAAU,EAC9C,OAAQA,EAAe,OACvB,cAAeA,EAAe,cAC9B,kBAAmBA,EAAe,kBAClC,OAAQA,EAAe,OACvB,YAAa,KAAK,mBAAmBA,EAAe,YAAa,UAAU,EAC3E,iBAAkB,KAAK,mBAAmBA,EAAe,kBAAoB,EAAG,YAAY,EAC5F,gBAAiB,KAAK,mBAAmBA,EAAe,iBAAmB,EAAG,UAAU,EACxF,UAAW,KAAK,mBAAmBA,EAAe,UAAW,KAAK,EAClE,MAAO,KAAK,mBAAmBA,EAAe,OAAS,EAAG,UAAU,EACpE,MAAO,KAAK,mBAAmBA,EAAe,OAAS,EAAG,UAAU,EACpE,SAAU,KAAK,mBAAmBA,EAAe,SAAU,UAAU,EACrE,MAAO,KAAK,mBAAmBA,EAAe,MAAO,UAAU,EAC/D,SAAUA,EAAe,UAAY,KACrC,WAAY,IAAI,KAAA,EAAO,YAAA,CAAY,EAGrC,QAAQ,IAAI,6DAA8D,CACxE,eAAgB,CAAC,CAACC,EAAoB,SACtC,cAAeA,EAAoB,UAAU,IAAA,CAC9C,EAGD,KAAM,CAAE,KAAMa,EAAY,MAAOC,CAAA,EAAoB,MAAMpB,EACxD,KAAK,cAAc,EACnB,OAAOM,CAAmB,EAC1B,OAAA,EACA,OAAA,EAEH,GAAIc,EAAiB,MAAMA,EAE3B,QAAQ,IAAI,4CAA6C,CACvD,GAAID,EAAW,GACf,OAAQA,EAAW,OACnB,eAAgB,CAAC,CAACA,EAAW,SAC7B,cAAeA,EAAW,UAAU,IAAA,CACrC,EAMD,MAAME,EAAmBhB,EAAe,mBAAqB,CAAA,EACvDiB,EAAkBjB,EAAe,kBAAoB,CAAA,EACrDkB,EAAqBlB,EAAe,OAAS,CAAA,EAE7CmB,EAAaH,EAAiB,OAASC,EAAgB,OAASC,EAAmB,OAEzF,GAAIC,EAAa,EAAG,CAClB,QAAQ,IAAI,8CAA+C,CACzD,kBAAmBH,EAAiB,OACpC,iBAAkBC,EAAgB,OAClC,oBAAqBC,EAAmB,OACxC,MAAOC,CAAA,CACR,EAED,MAAMC,EAAmB,CAAA,EAwGzB,GArGIJ,EAAiB,OAAS,IAC5B,QAAQ,IAAI,sDAAsD,EAElEA,EAAiB,QAAQ,CAACb,EAAWkB,IAAkB,CAErD,MAAMC,EAAa,CAAA,EACfnB,EAAK,oBAAoBmB,EAAW,KAAK,QAAQnB,EAAK,kBAAkB,EAAE,EAC1EA,EAAK,oBAAoBmB,EAAW,KAAK,QAAQnB,EAAK,kBAAkB,EAAE,EAC1EA,EAAK,qBAAqBmB,EAAW,KAAK,QAAQnB,EAAK,mBAAmB,EAAE,EAC5EA,EAAK,mBAAmBmB,EAAW,KAAK,QAAQnB,EAAK,iBAAiB,EAAE,EAE5E,MAAMoB,EAAiBD,EAAW,OAAS,EAAIA,EAAW,KAAK,IAAI,EAAI,iBAGjEE,EAAerB,EAAK,iBAAmBA,EAAK,gBAC9C,GAAGA,EAAK,eAAe,MAAMA,EAAK,eAAe,GACjDA,EAAK,iBAAmBA,EAAK,iBAAmB,kBAG9CsB,EAAkBtB,EAAK,OAASA,EAAK,MACvC,GAAGA,EAAK,KAAK,MAAMA,EAAK,KAAK,MAC7B,IAGJ,QAAQ,IAAI,sBAAsBkB,EAAQ,CAAC,KAAKlB,EAAK,WAAW,KAAM,CACpE,YAAaA,EAAK,YAClB,cAAeA,EAAK,cACpB,YAAaA,EAAK,YAClB,cAAeA,EAAK,cACpB,UAAWA,EAAK,SAAA,CACjB,EAED,MAAMuB,EAAW,CACf,cAAeZ,EAAW,GAC1B,YAAa,KACb,UAAW,cACX,YAAaX,EAAK,aAAe,SAASkB,EAAQ,CAAC,GACnD,YAAaI,EACb,SAAUD,EACV,WAAYD,EACZ,KAAM,GACN,KAAM,GACN,SAAU,KAAK,mBAAmBpB,EAAK,SAAU,UAAU,EAC3D,gBAAiB,KAAK,mBAAmBA,EAAK,gBAAiB,UAAU,EACzE,UAAW,KAAK,mBAAmBA,EAAK,WAAa,EAAG,eAAe,EACvE,SAAU,KAAK,mBAAmBA,EAAK,SAAU,UAAU,EAC3D,kBAAmB,CACjB,YAAaA,EAAK,YAClB,MAAOA,EAAK,MACZ,MAAOA,EAAK,MACZ,gBAAiBA,EAAK,gBACtB,gBAAiBA,EAAK,gBACtB,KAAMA,EAAK,KACX,mBAAoBA,EAAK,mBACzB,mBAAoBA,EAAK,mBACzB,oBAAqBA,EAAK,oBAC1B,kBAAmBA,EAAK,kBAExB,YAAaA,EAAK,aAAe,GACjC,cAAeA,EAAK,eAAiB,EACrC,YAAaA,EAAK,aAAe,GACjC,cAAeA,EAAK,eAAiB,EAErC,eAAgBA,EAAK,gBAAkB,EACvC,iBAAkBA,EAAK,kBAAoB,EAC3C,UAAWA,EAAK,WAAa,EAC7B,YAAaA,EAAK,aAAe,CAAA,CACnC,EAGFiB,EAAiB,KAAKM,CAAQ,CAChC,CAAC,GAICT,EAAgB,OAAS,IAC3B,QAAQ,IAAI,sDAAsD,EAElEA,EAAgB,QAASd,GAAc,CACrC,MAAMuB,EAAW,CACf,cAAeZ,EAAW,GAC1B,YAAaX,EAAK,eAAiB,KACnC,UAAW,cACX,YAAa,GAAGA,EAAK,MAAM,MAAMA,EAAK,WAAW,GACjD,YAAa,KACb,SAAU,KACV,WAAY,KACZ,KAAM,KACN,KAAM,KACN,SAAU,KAAK,mBAAmBA,EAAK,SAAU,UAAU,EAC3D,gBAAiB,KAAK,mBAAmBA,EAAK,gBAAiB,UAAU,EACzE,UAAW,KAAK,mBAAmBA,EAAK,WAAa,EAAG,eAAe,EACvE,SAAU,KAAK,mBAAmBA,EAAK,SAAU,UAAU,EAC3D,kBAAmB,IAAA,EAGrBiB,EAAiB,KAAKM,CAAQ,CAChC,CAAC,GAICR,EAAmB,OAAS,EAAG,CACjC,QAAQ,IAAI,gDAAgD,EAG5D,MAAMS,EAAeT,EAClB,IAAKf,GAAcA,EAAK,WAAW,EACnC,OAAQJ,GAAYA,CAAE,EAEzB,IAAI6B,EAAY,CAAA,EAChB,GAAID,EAAa,OAAS,EAAG,CAC3B,KAAM,CAAE,KAAME,GAAkB,MAAMlC,EACnC,KAAK,WAAW,EAChB,OAAO,mCAAmC,EAC1C,GAAG,cAAegC,CAAY,EACjCC,EAAYC,GAAiB,CAAA,CAC/B,CAEAX,EAAmB,QAASf,GAAc,CACxC,MAAM2B,EAAWF,EAAU,KAAMG,GAAWA,EAAE,cAAgB5B,EAAK,WAAW,EACxEuB,EAAW,CACf,cAAeZ,EAAW,GAC1B,YAAaX,EAAK,YAClB,UAAW,SACX,YAAa2B,GAAU,sBAAwB,gBAAgB3B,EAAK,WAAW,GAC/E,YAAa,KACb,SAAU,KACV,WAAY,KACZ,KAAM,KACN,KAAM,KACN,SAAU,KAAK,mBAAmBA,EAAK,SAAU,UAAU,EAC3D,gBAAiB,KAAK,mBAAmBA,EAAK,gBAAiB,UAAU,EACzE,UAAW,KAAK,mBAAmBA,EAAK,WAAa,EAAG,eAAe,EACvE,SAAU,KAAK,mBAAmBA,EAAK,SAAU,UAAU,EAC3D,kBAAmB,IAAA,EAGrBiB,EAAiB,KAAKM,CAAQ,CAChC,CAAC,CACH,CAEA,QAAQ,IAAI,mDAAoD,CAC9D,YAAaN,EAAiB,OAC9B,kBAAmBA,EAAiB,UAAYY,EAAE,YAAc,aAAa,EAAE,OAC/E,iBAAkBZ,EAAiB,UAAYY,EAAE,YAAc,YAAY,EAAE,OAC7E,eAAgBZ,EAAiB,UAAYY,EAAE,YAAc,QAAQ,EAAE,MAAA,CACxE,EAED,KAAM,CAAE,MAAOC,CAAA,EAAe,MAAMtC,EACjC,KAAK,kBAAkB,EACvB,OAAOyB,CAAgB,EAE1B,GAAIa,EACF,cAAQ,MAAM,gDAAiDA,CAAU,EACnEA,EAGR,QAAQ,IAAI,sDAAsD,CACpE,CAEA,OAAOnB,CACT,OAAStB,EAAO,CACd,cAAQ,MAAM,mDAAoDA,CAAK,EACjEA,CACR,CACF,CAKA,OAAe,mBAAmB0C,EAAYC,EAA6F,CACzI,GAAID,GAAU,MAA+BA,IAAU,GACrD,MAAO,GAGT,MAAME,EAAW,WAAWF,CAAK,EAEjC,GAAI,MAAME,CAAQ,EAChB,eAAQ,KAAK,6DAA6DD,CAAI,IAAKD,CAAK,EACjF,EAIT,OAAQC,EAAA,CACN,IAAK,WACL,IAAK,aACL,IAAK,MACH,OAAO,KAAK,IAAI,KAAK,IAAIC,EAAU,CAAC,EAAG,MAAM,EAE/C,IAAK,WACL,IAAK,WACL,IAAK,gBACH,OAAO,KAAK,IAAI,KAAK,IAAIA,EAAU,CAAC,EAAG,SAAS,EAElD,QACE,OAAO,KAAK,IAAI,KAAK,IAAIA,EAAU,CAAC,EAAG,SAAS,CAAA,CAEtD,CACF"}