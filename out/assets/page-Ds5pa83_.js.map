{"version":3,"file":"page-Ds5pa83_.js","sources":["../../src/pages/mantenimiento/components/MantenimientoLayout.tsx","../../src/pages/mantenimiento/components/ThresholdForm.tsx","../../src/pages/mantenimiento/components/ImportarUmbrales.tsx","../../src/pages/mantenimiento/components/ThresholdsTable.tsx","../../src/pages/mantenimiento/components/AlertasTable.tsx","../../src/pages/mantenimiento/components/ReplenishmentTable.tsx","../../src/pages/mantenimiento/components/ConfiguracionInventario.tsx","../../src/pages/mantenimiento/components/DashboardKPIs.tsx","../../src/pages/mantenimiento/components/PrediccionDemanda.tsx","../../src/pages/mantenimiento/components/NotificacionesRealTime.tsx","../../src/pages/mantenimiento/page.tsx"],"sourcesContent":["\nimport { ReactNode, useState } from 'react';\nimport Sidebar from '../../../components/feature/Sidebar';\nimport TopBar from '../../../components/feature/TopBar';\nimport MobileNav from '../../../components/feature/MobileNav';\n\ninterface MantenimientoLayoutProps {\n  children: ReactNode;\n  vistaActual: string;\n  onCambiarVista: (vista: string) => void;\n}\n\nexport default function MantenimientoLayout({ children, vistaActual, onCambiarVista }: MantenimientoLayoutProps) {\n  const [sidebarOpen, setSidebarOpen] = useState(false);\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex\">\n      {/* Sidebar */}\n      <Sidebar isOpen={sidebarOpen} onClose={() => setSidebarOpen(false)} />\n\n      {/* Contenido principal */}\n      <div className=\"flex-1 flex flex-col min-w-0\">\n        {/* TopBar */}\n        <TopBar onMenuClick={() => setSidebarOpen(true)} />\n        \n        {/* Navegaci√≥n de pesta√±as */}\n        <div className=\"bg-white border-b border-gray-200 px-4 lg:px-6\">\n          <nav className=\"flex space-x-8 overflow-x-auto\">\n            <button\n              onClick={() => onCambiarVista('umbrales')}\n              className={`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${\n                vistaActual === 'umbrales'\n                  ? 'border-blue-500 text-blue-600'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n              }`}\n            >\n              <i className=\"ri-dashboard-line mr-2\"></i>\n              Umbrales de Stock\n            </button>\n            <button\n              onClick={() => onCambiarVista('alertas')}\n              className={`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${\n                vistaActual === 'alertas'\n                  ? 'border-blue-500 text-blue-600'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n              }`}\n            >\n              <i className=\"ri-alarm-warning-line mr-2\"></i>\n              Alertas\n            </button>\n            <button\n              onClick={() => onCambiarVista('reabastecimiento')}\n              className={`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${\n                vistaActual === 'reabastecimiento'\n                  ? 'border-blue-500 text-blue-600'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n              }`}\n            >\n              <i className=\"ri-truck-line mr-2\"></i>\n              Reabastecimiento\n            </button>\n            <button\n              onClick={() => onCambiarVista('kpis')}\n              className={`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${\n                vistaActual === 'kpis'\n                  ? 'border-blue-500 text-blue-600'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n              }`}\n            >\n              <i className=\"ri-bar-chart-line mr-2\"></i>\n              Dashboard KPIs\n            </button>\n            <button\n              onClick={() => onCambiarVista('prediccion')}\n              className={`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${\n                vistaActual === 'prediccion'\n                  ? 'border-blue-500 text-blue-600'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n              }`}\n            >\n              <i className=\"ri-brain-line mr-2\"></i>\n              Predicci√≥n IA\n            </button>\n            <button\n              onClick={() => onCambiarVista('configuracion')}\n              className={`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${\n                vistaActual === 'configuracion'\n                  ? 'border-blue-500 text-blue-600'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n              }`}\n            >\n              <i className=\"ri-settings-line mr-2\"></i>\n              Configuraci√≥n\n            </button>\n          </nav>\n        </div>\n        \n        {/* Contenido */}\n        <main className=\"flex-1 p-4 lg:p-6 pb-20 lg:pb-6 overflow-auto\">\n          <div className=\"max-w-7xl mx-auto\">\n            {children}\n          </div>\n        </main>\n      </div>\n\n      {/* Navegaci√≥n m√≥vil */}\n      <MobileNav />\n    </div>\n  );\n}\n","import { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\n\ninterface ThresholdFormProps {\n  threshold?: any;\n  onClose: () => void;\n  onSuccess: () => void;\n}\n\nexport default function ThresholdForm({ threshold, onClose, onSuccess }: ThresholdFormProps) {\n  const [loading, setLoading] = useState(false);\n  const [articulosDisponibles, setArticulosDisponibles] = useState<any[]>([]);\n  const [busquedaArticulo, setBusquedaArticulo] = useState('');\n  const [mostrarListaArticulos, setMostrarListaArticulos] = useState(false);\n  const [articuloSeleccionado, setArticuloSeleccionado] = useState<any>(null);\n  \n  const [formData, setFormData] = useState({\n    articulo_id: '',\n    min_qty: 0,\n    max_qty: 0,\n    safety_stock: 0,\n    lead_time_dias: 7,\n    lote_minimo: 1,\n    activo: true\n  });\n\n  useEffect(() => {\n    if (threshold) {\n      // Modo edici√≥n - cargar datos del threshold existente\n      setFormData({\n        articulo_id: threshold.articulo_id || '',\n        min_qty: threshold.min_qty || 0,\n        max_qty: threshold.max_qty || 0,\n        safety_stock: threshold.safety_stock || 0,\n        lead_time_dias: threshold.lead_time_dias || 7,\n        lote_minimo: threshold.lote_minimo || 1,\n        activo: threshold.activo !== false\n      });\n\n      // Si hay informaci√≥n del art√≠culo, configurarla\n      if (threshold.inventario) {\n        setArticuloSeleccionado(threshold.inventario);\n        setBusquedaArticulo(threshold.inventario.descripcion_articulo);\n      }\n    } else {\n      // Modo creaci√≥n - cargar art√≠culos disponibles\n      cargarArticulosDisponibles();\n    }\n  }, [threshold]);\n\n  const cargarArticulosDisponibles = async () => {\n    try {\n      // Obtener art√≠culos que NO tienen umbrales configurados\n      const { data: articulosConUmbrales } = await supabase\n        .from('inventario_thresholds')\n        .select('articulo_id')\n        .eq('activo', true);\n\n      const idsConUmbrales = articulosConUmbrales?.map(t => t.articulo_id) || [];\n\n      let query = supabase\n        .from('inventario')\n        .select('id_articulo, codigo_articulo, descripcion_articulo, categoria_id')\n        .eq('activo', true)\n        .order('descripcion_articulo');\n\n      // Excluir art√≠culos que ya tienen umbrales\n      if (idsConUmbrales.length > 0) {\n        query = query.not('id_articulo', 'in', `(${idsConUmbrales.join(',')})`);\n      }\n\n      const { data, error } = await query;\n\n      if (error) throw error;\n      setArticulosDisponibles(data || []);\n    } catch (error) {\n      console.error('Error cargando art√≠culos disponibles:', error);\n    }\n  };\n\n  const filtrarArticulos = (busqueda: string) => {\n    setBusquedaArticulo(busqueda);\n    \n    if (busqueda.length === 0) {\n      setMostrarListaArticulos(false);\n      setArticuloSeleccionado(null);\n      setFormData(prev => ({ ...prev, articulo_id: '' }));\n      return;\n    }\n\n    const filtrados = articulosDisponibles.filter(articulo =>\n      articulo.descripcion_articulo.toLowerCase().includes(busqueda.toLowerCase()) ||\n      articulo.codigo_articulo.toLowerCase().includes(busqueda.toLowerCase())\n    );\n\n    setMostrarListaArticulos(filtrados.length > 0 && busqueda.length > 0);\n  };\n\n  const seleccionarArticulo = (articulo: any) => {\n    setArticuloSeleccionado(articulo);\n    setBusquedaArticulo(articulo.descripcion_articulo);\n    setMostrarListaArticulos(false);\n    setFormData(prev => ({ ...prev, articulo_id: articulo.id_articulo }));\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!threshold && !formData.articulo_id) {\n      alert('Por favor seleccione un art√≠culo');\n      return;\n    }\n\n    if (formData.min_qty <= 0) {\n      alert('La cantidad m√≠nima debe ser mayor a 0');\n      return;\n    }\n\n    if (formData.max_qty <= formData.min_qty) {\n      alert('La cantidad m√°xima debe ser mayor a la m√≠nima');\n      return;\n    }\n\n    if (formData.safety_stock < 0) {\n      alert('El stock de seguridad no puede ser negativo');\n      return;\n    }\n\n    if (formData.lead_time_dias <= 0) {\n      alert('El tiempo de entrega debe ser mayor a 0');\n      return;\n    }\n\n    if (formData.lote_minimo <= 0) {\n      alert('El lote m√≠nimo debe ser mayor a 0');\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      if (threshold) {\n        // Actualizar threshold existente\n        await actualizarThreshold();\n      } else {\n        // Crear nuevo threshold\n        await crearThreshold();\n      }\n    } catch (error) {\n      console.error('Error en submit:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const crearThreshold = async () => {\n    try {\n      const { error } = await supabase\n        .from('inventario_thresholds')\n        .insert({\n          ...formData,\n          created_at: new Date().toISOString()\n        });\n\n      if (error) throw error;\n\n      onSuccess();\n    } catch (error: any) {\n      console.error('Error creando threshold:', error);\n      alert('Error al crear la configuraci√≥n de umbral');\n    }\n  };\n\n  const actualizarThreshold = async () => {\n    try {\n      const { error } = await supabase\n        .from('inventario_thresholds')\n        .update({\n          ...formData,\n          updated_at: new Date().toISOString()\n        })\n        .eq('id', threshold!.id);\n\n      if (error) throw error;\n\n      onSuccess();\n    } catch (error: any) {\n      console.error('Error actualizando threshold:', error);\n      alert('Error al actualizar la configuraci√≥n');\n    }\n  };\n\n  const handleInputChange = (field: string, value: any) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n  };\n\n  const articulosFiltrados = articulosDisponibles.filter(articulo =>\n    articulo.descripcion_articulo.toLowerCase().includes(busquedaArticulo.toLowerCase()) ||\n    articulo.codigo_articulo.toLowerCase().includes(busquedaArticulo.toLowerCase())\n  );\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <div className=\"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">\n            {threshold ? 'Editar Umbral de Stock' : 'Nuevo Umbral de Stock'}\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 cursor-pointer\"\n          >\n            <i className=\"ri-close-line text-2xl\"></i>\n          </button>\n        </div>\n\n        <div className=\"p-6\">\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            {/* Selector de Art√≠culo - Solo en modo creaci√≥n */}\n            {!threshold && (\n              <div className=\"relative\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Art√≠culo *\n                </label>\n                <input\n                  type=\"text\"\n                  value={busquedaArticulo}\n                  onChange={(e) => filtrarArticulos(e.target.value)}\n                  placeholder=\"Buscar art√≠culo por c√≥digo o descripci√≥n...\"\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  required\n                />\n                \n                {mostrarListaArticulos && articulosFiltrados.length > 0 && (\n                  <div className=\"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto\">\n                    {articulosFiltrados.map((articulo) => (\n                      <div\n                        key={articulo.id_articulo}\n                        onClick={() => seleccionarArticulo(articulo)}\n                        className=\"px-3 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0\"\n                      >\n                        <div className=\"font-medium\">{articulo.descripcion_articulo}</div>\n                        <div className=\"text-sm text-gray-500\">C√≥digo: {articulo.codigo_articulo}</div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n                \n                {articuloSeleccionado && (\n                  <div className=\"mt-2 p-2 bg-green-50 border border-green-200 rounded text-sm\">\n                    <i className=\"ri-check-line text-green-600 mr-1\"></i>\n                    Art√≠culo seleccionado: <strong>{articuloSeleccionado.descripcion_articulo}</strong>\n                    <div className=\"text-gray-600\">C√≥digo: {articuloSeleccionado.codigo_articulo}</div>\n                  </div>\n                )}\n\n                {busquedaArticulo && articulosFiltrados.length === 0 && !articuloSeleccionado && (\n                  <div className=\"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded text-sm text-yellow-700\">\n                    <i className=\"ri-information-line mr-1\"></i>\n                    No se encontraron art√≠culos disponibles. Solo se muestran art√≠culos sin umbrales configurados.\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Informaci√≥n del art√≠culo en modo edici√≥n */}\n            {threshold && threshold.inventario && (\n              <div className=\"bg-gray-50 p-4 rounded-lg\">\n                <h3 className=\"font-medium text-gray-900 mb-2\">Art√≠culo</h3>\n                <div className=\"text-sm text-gray-600\">\n                  <div><strong>C√≥digo:</strong> {threshold.inventario.codigo_articulo}</div>\n                  <div><strong>Descripci√≥n:</strong> {threshold.inventario.descripcion_articulo}</div>\n                </div>\n              </div>\n            )}\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              {/* Cantidad M√≠nima */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Cantidad M√≠nima *\n                </label>\n                <input\n                  type=\"number\"\n                  value={formData.min_qty}\n                  onChange={(e) => handleInputChange('min_qty', parseInt(e.target.value) || 0)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  min=\"1\"\n                  required\n                />\n                <p className=\"text-xs text-gray-500 mt-1\">\n                  Cantidad m√≠nima antes de generar alerta\n                </p>\n              </div>\n\n              {/* Cantidad M√°xima */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Cantidad M√°xima *\n                </label>\n                <input\n                  type=\"number\"\n                  value={formData.max_qty}\n                  onChange={(e) => handleInputChange('max_qty', parseInt(e.target.value) || 0)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  min=\"1\"\n                  required\n                />\n                <p className=\"text-xs text-gray-500 mt-1\">\n                  Cantidad m√°xima recomendada en inventario\n                </p>\n              </div>\n\n              {/* Stock de Seguridad */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Stock de Seguridad\n                </label>\n                <input\n                  type=\"number\"\n                  value={formData.safety_stock}\n                  onChange={(e) => handleInputChange('safety_stock', parseInt(e.target.value) || 0)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  min=\"0\"\n                />\n                <p className=\"text-xs text-gray-500 mt-1\">\n                  Stock adicional para contingencias\n                </p>\n              </div>\n\n              {/* Tiempo de Entrega */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Tiempo de Entrega (d√≠as) *\n                </label>\n                <input\n                  type=\"number\"\n                  value={formData.lead_time_dias}\n                  onChange={(e) => handleInputChange('lead_time_dias', parseInt(e.target.value) || 0)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  min=\"1\"\n                  required\n                />\n                <p className=\"text-xs text-gray-500 mt-1\">\n                  D√≠as que toma recibir el pedido\n                </p>\n              </div>\n\n              {/* Lote M√≠nimo */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Lote M√≠nimo *\n                </label>\n                <input\n                  type=\"number\"\n                  value={formData.lote_minimo}\n                  onChange={(e) => handleInputChange('lote_minimo', parseInt(e.target.value) || 0)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  min=\"1\"\n                  required\n                />\n                <p className=\"text-xs text-gray-500 mt-1\">\n                  Cantidad m√≠nima por pedido\n                </p>\n              </div>\n\n              {/* Estado Activo */}\n              <div className=\"flex items-center\">\n                <input\n                  type=\"checkbox\"\n                  id=\"activo\"\n                  checked={formData.activo}\n                  onChange={(e) => handleInputChange('activo', e.target.checked)}\n                  className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                />\n                <label htmlFor=\"activo\" className=\"ml-2 block text-sm text-gray-900\">\n                  Umbral activo\n                </label>\n              </div>\n            </div>\n\n            {/* C√°lculo autom√°tico del ROP */}\n            <div className=\"bg-blue-50 p-4 rounded-lg\">\n              <h3 className=\"font-medium text-blue-900 mb-2\">\n                <i className=\"ri-calculator-line mr-2\"></i>\n                Punto de Reorden (ROP) Calculado\n              </h3>\n              <div className=\"text-sm text-blue-700\">\n                <div className=\"mb-1\">\n                  <strong>F√≥rmula:</strong> Stock de Seguridad + (Demanda Promedio √ó Tiempo de Entrega)\n                </div>\n                <div>\n                  <strong>ROP estimado:</strong> {formData.safety_stock + (2.5 * formData.lead_time_dias)} unidades\n                </div>\n                <div className=\"text-xs mt-1 text-blue-600\">\n                  * Usando demanda promedio de 2.5 unidades/d√≠a (configurable en Configuraci√≥n)\n                </div>\n              </div>\n            </div>\n\n            {/* Botones */}\n            <div className=\"flex justify-end space-x-4 pt-6 border-t border-gray-200\">\n              <button\n                type=\"button\"\n                onClick={onClose}\n                className=\"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 whitespace-nowrap cursor-pointer\"\n              >\n                Cancelar\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading || (!threshold && !formData.articulo_id)}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap cursor-pointer\"\n              >\n                {loading ? (\n                  <>\n                    <i className=\"ri-loader-4-line animate-spin mr-2\"></i>\n                    Guardando...\n                  </>\n                ) : (\n                  <>\n                    <i className={threshold ? \"ri-save-line mr-2\" : \"ri-add-line mr-2\"}></i>\n                    {threshold ? 'Actualizar' : 'Crear'} Umbral\n                  </>\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}","\nimport { useState, useRef } from 'react';\nimport { supabase } from '../../../lib/supabase';\n\ninterface ImportarUmbralesProps {\n  onClose: () => void;\n  onSuccess: () => void;\n}\n\nexport default function ImportarUmbrales({ onClose, onSuccess }: ImportarUmbralesProps) {\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n  const [dragActive, setDragActive] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const handleDrag = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.type === \"dragenter\" || e.type === \"dragover\") {\n      setDragActive(true);\n    } else if (e.type === \"dragleave\") {\n      setDragActive(false);\n    }\n  };\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragActive(false);\n    \n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\n      handleFile(e.dataTransfer.files[0]);\n    }\n  };\n\n  const handleFileInput = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files[0]) {\n      handleFile(e.target.files[0]);\n    }\n  };\n\n  const handleFile = async (file: File) => {\n    if (!file.name.match(/\\.(xlsx|xls|csv)$/)) {\n      setError('Por favor selecciona un archivo Excel (.xlsx, .xls) o CSV');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n    setSuccess(null);\n\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n\n      // Leer el archivo como texto para procesarlo\n      const text = await file.text();\n      const lines = text.split('\\n');\n      \n      if (lines.length < 2) {\n        throw new Error('El archivo debe contener al menos una fila de datos adem√°s del encabezado');\n      }\n\n      // Procesar CSV (asumiendo formato: codigo_articulo,min_qty,max_qty,safety_stock,lead_time_dias,lote_minimo)\n      const headers = lines[0].split(',').map(h => h.trim().replace(/\"/g, ''));\n      const expectedHeaders = ['codigo_articulo', 'min_qty', 'max_qty', 'safety_stock', 'lead_time_dias', 'lote_minimo'];\n      \n      // Validar encabezados\n      const hasRequiredHeaders = expectedHeaders.every(header => \n        headers.some(h => h.toLowerCase().includes(header.toLowerCase()))\n      );\n\n      if (!hasRequiredHeaders) {\n        throw new Error(`El archivo debe contener las columnas: ${expectedHeaders.join(', ')}`);\n      }\n\n      const dataRows = lines.slice(1).filter(line => line.trim());\n      const processedData = [];\n      const errors = [];\n\n      for (let i = 0; i < dataRows.length; i++) {\n        const row = dataRows[i].split(',').map(cell => cell.trim().replace(/\"/g, ''));\n        \n        if (row.length < expectedHeaders.length) {\n          errors.push(`Fila ${i + 2}: Datos incompletos`);\n          continue;\n        }\n\n        const codigo_articulo = row[0];\n        const min_qty = parseFloat(row[1]);\n        const max_qty = parseFloat(row[2]);\n        const safety_stock = parseFloat(row[3]);\n        const lead_time_dias = parseInt(row[4]);\n        const lote_minimo = parseFloat(row[5]) || 0;\n\n        // Validaciones\n        if (!codigo_articulo) {\n          errors.push(`Fila ${i + 2}: C√≥digo de art√≠culo requerido`);\n          continue;\n        }\n\n        if (isNaN(min_qty) || min_qty < 0) {\n          errors.push(`Fila ${i + 2}: Cantidad m√≠nima debe ser un n√∫mero ‚â• 0`);\n          continue;\n        }\n\n        if (isNaN(max_qty) || max_qty < min_qty) {\n          errors.push(`Fila ${i + 2}: Cantidad m√°xima debe ser ‚â• cantidad m√≠nima`);\n          continue;\n        }\n\n        if (isNaN(safety_stock) || safety_stock < 0) {\n          errors.push(`Fila ${i + 2}: Stock de seguridad debe ser un n√∫mero ‚â• 0`);\n          continue;\n        }\n\n        if (isNaN(lead_time_dias) || lead_time_dias < 0) {\n          errors.push(`Fila ${i + 2}: Lead time debe ser un n√∫mero entero ‚â• 0`);\n          continue;\n        }\n\n        // Buscar el art√≠culo en inventario\n        const { data: articulo, error: articuloError } = await supabase\n          .from('inventario')\n          .select('Id_Articulo')\n          .eq('codigo_articulo', codigo_articulo)\n          .single();\n\n        if (articuloError || !articulo) {\n          errors.push(`Fila ${i + 2}: Art√≠culo '${codigo_articulo}' no encontrado en inventario`);\n          continue;\n        }\n\n        // Calcular ROP\n        const demanda_promedio_dia = 1.0; // Valor por defecto, se puede obtener de configuraci√≥n\n        const reorder_point = safety_stock + (demanda_promedio_dia * lead_time_dias);\n\n        processedData.push({\n          articulo_id: articulo.Id_Articulo,\n          min_qty,\n          max_qty,\n          safety_stock,\n          reorder_point,\n          lead_time_dias,\n          lote_minimo,\n          activo: true\n        });\n      }\n\n      if (errors.length > 0) {\n        throw new Error(`Errores encontrados:\\n${errors.join('\\n')}`);\n      }\n\n      if (processedData.length === 0) {\n        throw new Error('No se encontraron datos v√°lidos para procesar');\n      }\n\n      // Insertar o actualizar umbrales\n      let insertedCount = 0;\n      let updatedCount = 0;\n\n      for (const threshold of processedData) {\n        // Verificar si ya existe un umbral para este art√≠culo\n        const { data: existing } = await supabase\n          .from('inventario_thresholds')\n          .select('id')\n          .eq('articulo_id', threshold.articulo_id)\n          .single();\n\n        if (existing) {\n          // Actualizar\n          const { error: updateError } = await supabase\n            .from('inventario_thresholds')\n            .update(threshold)\n            .eq('id', existing.id);\n\n          if (updateError) throw updateError;\n          updatedCount++;\n        } else {\n          // Insertar\n          const { error: insertError } = await supabase\n            .from('inventario_thresholds')\n            .insert(threshold);\n\n          if (insertError) throw insertError;\n          insertedCount++;\n        }\n      }\n\n      setSuccess(`Importaci√≥n exitosa: ${insertedCount} umbrales creados, ${updatedCount} actualizados`);\n      \n      setTimeout(() => {\n        onSuccess();\n      }, 2000);\n\n    } catch (error: any) {\n      console.error('Error importando umbrales:', error);\n      setError(error.message || 'Error al procesar el archivo');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const downloadTemplate = () => {\n    const headers = ['codigo_articulo', 'min_qty', 'max_qty', 'safety_stock', 'lead_time_dias', 'lote_minimo'];\n    const sampleData = [\n      ['ART001', '10', '100', '15', '7', '5'],\n      ['ART002', '5', '50', '10', '3', '1'],\n      ['ART003', '20', '200', '30', '14', '10']\n    ];\n\n    const csvContent = [\n      headers.join(','),\n      ...sampleData.map(row => row.join(','))\n    ].join('\\n');\n\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n    const link = document.createElement('a');\n    const url = URL.createObjectURL(blob);\n    link.setAttribute('href', url);\n    link.setAttribute('download', 'plantilla_umbrales_stock.csv');\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">\n            Importar Umbrales de Stock\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600\"\n          >\n            <i className=\"ri-close-line text-xl\"></i>\n          </button>\n        </div>\n\n        {/* Instrucciones */}\n        <div className=\"mb-6 p-4 bg-blue-50 rounded-lg\">\n          <h3 className=\"font-medium text-blue-900 mb-2\">\n            <i className=\"ri-information-line mr-2\"></i>\n            Instrucciones de importaci√≥n\n          </h3>\n          <ul className=\"text-sm text-blue-800 space-y-1\">\n            <li>‚Ä¢ El archivo debe ser CSV o Excel (.xlsx, .xls)</li>\n            <li>‚Ä¢ Debe contener las columnas: codigo_articulo, min_qty, max_qty, safety_stock, lead_time_dias, lote_minimo</li>\n            <li>‚Ä¢ Los c√≥digos de art√≠culo deben existir en el inventario</li>\n            <li>‚Ä¢ Las cantidades deben ser n√∫meros positivos</li>\n            <li>‚Ä¢ max_qty debe ser mayor o igual a min_qty</li>\n          </ul>\n        </div>\n\n        {/* Bot√≥n para descargar plantilla */}\n        <div className=\"mb-6\">\n          <button\n            onClick={downloadTemplate}\n            className=\"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors\"\n          >\n            <i className=\"ri-download-line mr-2\"></i>\n            Descargar Plantilla CSV\n          </button>\n        </div>\n\n        {/* √Årea de carga */}\n        <div\n          className={`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${\n            dragActive \n              ? 'border-blue-500 bg-blue-50' \n              : 'border-gray-300 hover:border-gray-400'\n          }`}\n          onDragEnter={handleDrag}\n          onDragLeave={handleDrag}\n          onDragOver={handleDrag}\n          onDrop={handleDrop}\n        >\n          <i className=\"ri-upload-cloud-2-line text-4xl text-gray-400 mb-4\"></i>\n          <p className=\"text-lg font-medium text-gray-700 mb-2\">\n            Arrastra tu archivo aqu√≠ o haz clic para seleccionar\n          </p>\n          <p className=\"text-sm text-gray-500 mb-4\">\n            Formatos soportados: CSV, Excel (.xlsx, .xls)\n          </p>\n          \n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            accept=\".csv,.xlsx,.xls\"\n            onChange={handleFileInput}\n            className=\"hidden\"\n          />\n          \n          <button\n            onClick={() => fileInputRef.current?.click()}\n            disabled={loading}\n            className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50\"\n          >\n            {loading ? 'Procesando...' : 'Seleccionar Archivo'}\n          </button>\n        </div>\n\n        {/* Mensajes */}\n        {error && (\n          <div className=\"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg\">\n            <div className=\"flex items-start\">\n              <i className=\"ri-error-warning-line text-red-500 mr-2 mt-0.5\"></i>\n              <div>\n                <h4 className=\"font-medium text-red-800\">Error</h4>\n                <pre className=\"text-sm text-red-700 whitespace-pre-wrap\">{error}</pre>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {success && (\n          <div className=\"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg\">\n            <div className=\"flex items-center\">\n              <i className=\"ri-check-line text-green-500 mr-2\"></i>\n              <div>\n                <h4 className=\"font-medium text-green-800\">√âxito</h4>\n                <p className=\"text-sm text-green-700\">{success}</p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Loading */}\n        {loading && (\n          <div className=\"mt-4 flex items-center justify-center\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n            <span className=\"ml-2 text-gray-600\">Procesando archivo...</span>\n          </div>\n        )}\n\n        {/* Botones */}\n        <div className=\"flex justify-end space-x-3 mt-6\">\n          <button\n            onClick={onClose}\n            disabled={loading}\n            className=\"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50\"\n          >\n            Cancelar\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\nimport ThresholdForm from './ThresholdForm';\nimport ImportarUmbrales from './ImportarUmbrales';\nimport * as XLSX from 'xlsx';\n\ninterface InventarioThreshold {\n  id: number;\n  articulo_id: number;\n  min_qty: number;\n  max_qty: number;\n  safety_stock: number;\n  reorder_point: number;\n  lead_time_dias: number;\n  lote_minimo: number;\n  activo: boolean;\n  inventario?: {\n    codigo_articulo: string;\n    descripcion_articulo: string;\n    categoria?: { nombre_categoria: string };\n  };\n  inventario_niveles?: {\n    on_hand: number;\n    reservado: number;\n    disponible: number;\n  };\n}\n\ninterface ThresholdsTableProps {\n  thresholds: InventarioThreshold[];\n  onRefresh: () => void;\n}\n\nexport default function ThresholdsTable({ thresholds, onRefresh }: ThresholdsTableProps) {\n  const [showForm, setShowForm] = useState(false);\n  const [showImport, setShowImport] = useState(false);\n  const [editingThreshold, setEditingThreshold] = useState<InventarioThreshold | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filtroSemaforo, setFiltroSemaforo] = useState('todos');\n  const [selectedItems, setSelectedItems] = useState<number[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [niveles, setNiveles] = useState<{[key: number]: any}>({});\n\n  // Cargar niveles de inventario\n  useEffect(() => {\n    loadNiveles();\n  }, [thresholds]);\n\n  const loadNiveles = async () => {\n    if (thresholds.length === 0) return;\n    \n    const articuloIds = thresholds.map(t => t.articulo_id);\n    const { data, error } = await supabase\n      .from('inventario_niveles')\n      .select('*')\n      .in('articulo_id', articuloIds);\n\n    if (!error && data) {\n      const nivelesMap = data.reduce((acc, nivel) => {\n        acc[nivel.articulo_id] = {\n          on_hand: nivel.on_hand,\n          reservado: nivel.reservado,\n          disponible: nivel.on_hand - nivel.reservado\n        };\n        return acc;\n      }, {});\n      setNiveles(nivelesMap);\n    }\n  };\n\n  const handleEdit = (threshold: InventarioThreshold) => {\n    setEditingThreshold(threshold);\n    setShowForm(true);\n  };\n\n  const handleCloseForm = () => {\n    setShowForm(false);\n    setEditingThreshold(null);\n  };\n\n  const handleDelete = async (threshold: InventarioThreshold) => {\n    if (!confirm(`¬øEst√°s seguro de eliminar el umbral para ${threshold.inventario?.codigo_articulo}?`)) {\n      return;\n    }\n\n    try {\n      const { error } = await supabase\n        .from('inventario_thresholds')\n        .delete()\n        .eq('id', threshold.id);\n\n      if (error) throw error;\n      \n      onRefresh();\n      alert('Umbral eliminado exitosamente');\n    } catch (error: any) {\n      console.error('Error eliminando umbral:', error);\n      alert('Error al eliminar el umbral');\n    }\n  };\n\n  const handleMassiveDelete = async () => {\n    if (selectedItems.length === 0) {\n      alert('Selecciona al menos un umbral para eliminar');\n      return;\n    }\n\n    if (!confirm(`¬øEst√°s seguro de eliminar ${selectedItems.length} umbrales seleccionados?`)) {\n      return;\n    }\n\n    try {\n      setLoading(true);\n      const { error } = await supabase\n        .from('inventario_thresholds')\n        .delete()\n        .in('id', selectedItems);\n\n      if (error) throw error;\n      \n      setSelectedItems([]);\n      onRefresh();\n      alert(`${selectedItems.length} umbrales eliminados exitosamente`);\n    } catch (error: any) {\n      console.error('Error eliminando umbrales:', error);\n      alert('Error al eliminar los umbrales');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleGenerateReplenishment = async () => {\n    try {\n      setLoading(true);\n      \n      // Obtener art√≠culos que necesitan reabastecimiento\n      const articulosParaReabastecer = thresholds.filter(threshold => {\n        const nivel = niveles[threshold.articulo_id];\n        if (!nivel) return false;\n        return nivel.disponible < threshold.reorder_point;\n      });\n\n      if (articulosParaReabastecer.length === 0) {\n        alert('No hay art√≠culos que requieran reabastecimiento en este momento');\n        return;\n      }\n\n      const ordenesACrear = articulosParaReabastecer.map(threshold => {\n        const nivel = niveles[threshold.articulo_id];\n        let qtySugerida = Math.max(threshold.max_qty - nivel.disponible, 0);\n        \n        // Ajustar por lote m√≠nimo\n        if (threshold.lote_minimo > 0) {\n          qtySugerida = Math.ceil(qtySugerida / threshold.lote_minimo) * threshold.lote_minimo;\n        }\n\n        return {\n          articulo_id: threshold.articulo_id,\n          qty_sugerida: qtySugerida,\n          motivo: nivel.disponible < threshold.min_qty ? 'below_min' : 'below_rop',\n          estado: 'borrador',\n          created_at: new Date().toISOString(),\n          updated_at: new Date().toISOString()\n        };\n      });\n\n      const { error } = await supabase\n        .from('replenishment_orders')\n        .insert(ordenesACrear);\n\n      if (error) throw error;\n\n      alert(`Se generaron ${ordenesACrear.length} √≥rdenes de reabastecimiento`);\n      \n      // Forzar actualizaci√≥n completa de todos los datos\n      onRefresh();\n      \n      // Disparar evento personalizado para notificar a otros componentes\n      window.dispatchEvent(new CustomEvent('replenishment-updated'));\n      \n    } catch (error: any) {\n      console.error('Error generando reabastecimiento:', error);\n      alert('Error al generar √≥rdenes de reabastecimiento');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleRecalculateROP = async () => {\n    try {\n      setLoading(true);\n      \n      // Obtener configuraci√≥n de demanda promedio\n      const { data: config } = await supabase\n        .from('settings')\n        .select('value')\n        .eq('key', 'demanda_promedio_dia')\n        .single();\n\n      const demandaPromedioDia = config ? parseFloat(config.value) : 5.0;\n\n      // Recalcular ROP para todos los umbrales\n      const updates = thresholds.map(threshold => ({\n        id: threshold.id,\n        reorder_point: threshold.safety_stock + (demandaPromedioDia * threshold.lead_time_dias)\n      }));\n\n      for (const update of updates) {\n        const { error } = await supabase\n          .from('inventario_thresholds')\n          .update({ reorder_point: update.reorder_point })\n          .eq('id', update.id);\n\n        if (error) throw error;\n      }\n\n      alert('Puntos de reorden recalculados exitosamente');\n      onRefresh();\n    } catch (error: any) {\n      console.error('Error recalculando ROP:', error);\n      alert('Error al recalcular puntos de reorden');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleExportExcel = async () => {\n    try {\n      // Crear datos para Excel\n      const excelData = filteredThresholds.map(threshold => {\n        const nivel = niveles[threshold.articulo_id] || { on_hand: 0, reservado: 0, disponible: 0 };\n        const semaforo = getSemaforoColor(threshold, nivel);\n        \n        return {\n          'C√≥digo Art√≠culo': threshold.inventario?.codigo_articulo || '',\n          'Descripci√≥n': threshold.inventario?.descripcion_articulo || '',\n          'Disponible': nivel.disponible.toFixed(2),\n          'En Mano': nivel.on_hand.toFixed(2),\n          'Reservado': nivel.reservado.toFixed(2),\n          'Min Qty': threshold.min_qty.toFixed(2),\n          'Max Qty': threshold.max_qty.toFixed(2),\n          'Safety Stock': threshold.safety_stock.toFixed(2),\n          'Reorder Point': threshold.reorder_point.toFixed(2),\n          'Lead Time (d√≠as)': threshold.lead_time_dias,\n          'Lote M√≠nimo': threshold.lote_minimo.toFixed(2),\n          'Estado Sem√°foro': semaforo.label\n        };\n      });\n\n      // Crear workbook y worksheet\n      const ws = XLSX.utils.json_to_sheet(excelData);\n      const wb = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(wb, ws, 'Umbrales de Stock');\n\n      // Configurar anchos de columna\n      const colWidths = [\n        { wch: 15 }, // C√≥digo Art√≠culo\n        { wch: 40 }, // Descripci√≥n\n        { wch: 12 }, // Disponible\n        { wch: 12 }, // En Mano\n        { wch: 12 }, // Reservado\n        { wch: 12 }, // Min Qty\n        { wch: 12 }, // Max Qty\n        { wch: 15 }, // Safety Stock\n        { wch: 15 }, // Reorder Point\n        { wch: 15 }, // Lead Time\n        { wch: 15 }, // Lote M√≠nimo\n        { wch: 15 }  // Estado Sem√°foro\n      ];\n      ws['!cols'] = colWidths;\n\n      // Generar archivo Excel\n      const fileName = `umbrales_stock_${new Date().toISOString().split('T')[0]}.xlsx`;\n      XLSX.writeFile(wb, fileName);\n      \n    } catch (error) {\n      console.error('Error exportando a Excel:', error);\n      alert('Error al exportar los datos a Excel');\n    }\n  };\n\n  const getSemaforoColor = (threshold: InventarioThreshold, nivel?: any) => {\n    const nivelActual = nivel || niveles[threshold.articulo_id] || { disponible: 0 };\n    const disponible = nivelActual.disponible;\n    \n    if (disponible <= 0 || disponible < threshold.min_qty) {\n      return { color: 'bg-red-500', label: 'Cr√≠tico', textColor: 'text-red-700' };\n    } else if (disponible < threshold.reorder_point) {\n      return { color: 'bg-yellow-500', label: 'Advertencia', textColor: 'text-yellow-700' };\n    } else {\n      return { color: 'bg-green-500', label: 'Normal', textColor: 'text-green-700' };\n    }\n  };\n\n  const filteredThresholds = thresholds.filter(threshold => {\n    const matchesSearch = \n      threshold.inventario?.codigo_articulo?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      threshold.inventario?.descripcion_articulo?.toLowerCase().includes(searchTerm.toLowerCase());\n    \n    if (!matchesSearch) return false;\n\n    if (filtroSemaforo === 'todos') return true;\n    \n    const semaforo = getSemaforoColor(threshold);\n    return (\n      (filtroSemaforo === 'critico' && semaforo.label === 'Cr√≠tico') ||\n      (filtroSemaforo === 'advertencia' && semaforo.label === 'Advertencia') ||\n      (filtroSemaforo === 'normal' && semaforo.label === 'Normal')\n    );\n  });\n\n  const handleSelectAll = (checked: boolean) => {\n    if (checked) {\n      setSelectedItems(filteredThresholds.map(t => t.id));\n    } else {\n      setSelectedItems([]);\n    }\n  };\n\n  const handleSelectItem = (id: number, checked: boolean) => {\n    if (checked) {\n      setSelectedItems([...selectedItems, id]);\n    } else {\n      setSelectedItems(selectedItems.filter(item => item !== id));\n    }\n  };\n\n  return (\n    <div className=\"p-6\">\n      {/* Header con botones de acci√≥n */}\n      <div className=\"mb-6 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n        <h2 className=\"text-xl font-semibold text-gray-900\">Umbrales de Stock</h2>\n        <div className=\"flex flex-wrap gap-2\">\n          <button\n            onClick={handleRecalculateROP}\n            disabled={loading}\n            className=\"flex items-center px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors whitespace-nowrap disabled:opacity-50\"\n          >\n            <i className=\"ri-refresh-line mr-2\"></i>\n            Recalcular ROP\n          </button>\n          <button\n            onClick={handleGenerateReplenishment}\n            disabled={loading}\n            className=\"flex items-center px-3 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors whitespace-nowrap disabled:opacity-50\"\n          >\n            <i className=\"ri-shopping-cart-line mr-2\"></i>\n            Generar Reabastecimiento\n          </button>\n          <button\n            onClick={handleExportExcel}\n            className=\"flex items-center px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors whitespace-nowrap\"\n          >\n            <i className=\"ri-download-line mr-2\"></i>\n            Exportar Excel\n          </button>\n          <button\n            onClick={() => setShowImport(true)}\n            className=\"flex items-center px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors whitespace-nowrap\"\n          >\n            <i className=\"ri-upload-line mr-2\"></i>\n            Importar Excel\n          </button>\n          <button\n            onClick={() => setShowForm(true)}\n            className=\"flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap\"\n          >\n            <i className=\"ri-add-line mr-2\"></i>\n            Nuevo Umbral\n          </button>\n        </div>\n      </div>\n\n      {/* Acciones masivas */}\n      {selectedItems.length > 0 && (\n        <div className=\"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-blue-800 font-medium\">\n              {selectedItems.length} elementos seleccionados\n            </span>\n            <div className=\"flex gap-2\">\n              <button\n                onClick={handleMassiveDelete}\n                disabled={loading}\n                className=\"flex items-center px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors disabled:opacity-50\"\n              >\n                <i className=\"ri-delete-bin-line mr-1\"></i>\n                Eliminar Seleccionados\n              </button>\n              <button\n                onClick={() => setSelectedItems([])}\n                className=\"flex items-center px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors\"\n              >\n                <i className=\"ri-close-line mr-1\"></i>\n                Cancelar\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Filtros */}\n      <div className=\"mb-6 flex flex-col sm:flex-row gap-4\">\n        <div className=\"flex-1\">\n          <input\n            type=\"text\"\n            placeholder=\"Buscar por c√≥digo o descripci√≥n...\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n          />\n        </div>\n        <select\n          value={filtroSemaforo}\n          onChange={(e) => setFiltroSemaforo(e.target.value)}\n          className=\"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8\"\n        >\n          <option value=\"todos\">Todos los estados</option>\n          <option value=\"critico\">üî¥ Cr√≠tico</option>\n          <option value=\"advertencia\">üü° Advertencia</option>\n          <option value=\"normal\">üü¢ Normal</option>\n        </select>\n      </div>\n\n      {/* Estad√≠sticas */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\n        <div className=\"bg-red-50 p-4 rounded-lg\">\n          <div className=\"flex items-center\">\n            <div className=\"w-3 h-3 bg-red-500 rounded-full mr-2\"></div>\n            <span className=\"text-sm font-medium text-red-700\">Cr√≠tico</span>\n          </div>\n          <p className=\"text-2xl font-bold text-red-900\">\n            {thresholds.filter(t => getSemaforoColor(t).label === 'Cr√≠tico').length}\n          </p>\n        </div>\n        <div className=\"bg-yellow-50 p-4 rounded-lg\">\n          <div className=\"flex items-center\">\n            <div className=\"w-3 h-3 bg-yellow-500 rounded-full mr-2\"></div>\n            <span className=\"text-sm font-medium text-yellow-700\">Advertencia</span>\n          </div>\n          <p className=\"text-2xl font-bold text-yellow-900\">\n            {thresholds.filter(t => getSemaforoColor(t).label === 'Advertencia').length}\n          </p>\n        </div>\n        <div className=\"bg-green-50 p-4 rounded-lg\">\n          <div className=\"flex items-center\">\n            <div className=\"w-3 h-3 bg-green-500 rounded-full mr-2\"></div>\n            <span className=\"text-sm font-medium text-green-700\">Normal</span>\n          </div>\n          <p className=\"text-2xl font-bold text-green-900\">\n            {thresholds.filter(t => getSemaforoColor(t).label === 'Normal').length}\n          </p>\n        </div>\n        <div className=\"bg-blue-50 p-4 rounded-lg\">\n          <div className=\"flex items-center\">\n            <i className=\"ri-database-2-line text-blue-600 mr-2\"></i>\n            <span className=\"text-sm font-medium text-blue-700\">Total</span>\n          </div>\n          <p className=\"text-2xl font-bold text-blue-900\">{thresholds.length}</p>\n        </div>\n      </div>\n\n      {/* Tabla */}\n      <div className=\"overflow-x-auto\">\n        <table className=\"min-w-full divide-y divide-gray-200\">\n          <thead className=\"bg-gray-50\">\n            <tr>\n              <th className=\"px-6 py-3 text-left\">\n                <input\n                  type=\"checkbox\"\n                  checked={selectedItems.length === filteredThresholds.length && filteredThresholds.length > 0}\n                  onChange={(e) => handleSelectAll(e.target.checked)}\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                />\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Estado\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Art√≠culo\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Disponible\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Min / M√°x\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Safety / ROP\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Lead Time\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Acciones\n              </th>\n            </tr>\n          </thead>\n          <tbody className=\"bg-white divide-y divide-gray-200\">\n            {filteredThresholds.map((threshold) => {\n              const nivel = niveles[threshold.articulo_id] || { on_hand: 0, reservado: 0, disponible: 0 };\n              const semaforo = getSemaforoColor(threshold, nivel);\n              \n              return (\n                <tr key={threshold.id} className=\"hover:bg-gray-50\">\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <input\n                      type=\"checkbox\"\n                      checked={selectedItems.includes(threshold.id)}\n                      onChange={(e) => handleSelectItem(threshold.id, e.target.checked)}\n                      className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                    />\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"flex items-center\">\n                      <div className={`w-3 h-3 ${semaforo.color} rounded-full mr-2`}></div>\n                      <span className={`text-sm font-medium ${semaforo.textColor}`}>\n                        {semaforo.label}\n                      </span>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4\">\n                    <div>\n                      <div className=\"text-sm font-medium text-gray-900\">\n                        {threshold.inventario?.codigo_articulo}\n                      </div>\n                      <div className=\"text-sm text-gray-500 max-w-xs truncate\">\n                        {threshold.inventario?.descripcion_articulo}\n                      </div>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"text-sm text-gray-900\">\n                      <span className={`font-medium ${semaforo.textColor}`}>\n                        {nivel.disponible.toFixed(2)}\n                      </span>\n                    </div>\n                    <div className=\"text-xs text-gray-500\">\n                      En mano: {nivel.on_hand.toFixed(2)}\n                    </div>\n                    <div className=\"text-xs text-gray-500\">\n                      Reservado: {nivel.reservado.toFixed(2)}\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    <div>Min: {threshold.min_qty.toFixed(2)}</div>\n                    <div>M√°x: {threshold.max_qty.toFixed(2)}</div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    <div>Safety: {threshold.safety_stock.toFixed(2)}</div>\n                    <div>ROP: {threshold.reorder_point.toFixed(2)}</div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    <div>{threshold.lead_time_dias} d√≠as</div>\n                    {threshold.lote_minimo > 0 && (\n                      <div className=\"text-xs text-gray-500\">\n                        Lote: {threshold.lote_minimo.toFixed(2)}\n                      </div>\n                    )}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                    <div className=\"flex items-center space-x-2\">\n                      <button\n                        onClick={() => handleEdit(threshold)}\n                        className=\"text-blue-600 hover:text-blue-900\"\n                        title=\"Editar\"\n                      >\n                        <i className=\"ri-edit-line\"></i>\n                      </button>\n                      <button\n                        onClick={() => handleDelete(threshold)}\n                        className=\"text-red-600 hover:text-red-900\"\n                        title=\"Eliminar\"\n                      >\n                        <i className=\"ri-delete-bin-line\"></i>\n                      </button>\n                    </div>\n                  </td>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n      {filteredThresholds.length === 0 && (\n        <div className=\"text-center py-8\">\n          <i className=\"ri-database-2-line text-4xl text-gray-400 mb-2\"></i>\n          <p className=\"text-gray-500\">No se encontraron art√≠culos con los filtros aplicados</p>\n        </div>\n      )}\n\n      {/* Modal de formulario */}\n      {showForm && (\n        <ThresholdForm\n          threshold={editingThreshold}\n          onClose={handleCloseForm}\n          onSuccess={() => {\n            handleCloseForm();\n            onRefresh();\n          }}\n        />\n      )}\n\n      {/* Modal de importaci√≥n */}\n      {showImport && (\n        <ImportarUmbrales\n          onClose={() => setShowImport(false)}\n          onSuccess={() => {\n            setShowImport(false);\n            onRefresh();\n          }}\n        />\n      )}\n    </div>\n  );\n}\n","\nimport { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\n\ninterface InventarioAlerta {\n  id: number;\n  articulo_id: number;\n  tipo: 'below_min' | 'below_rop' | 'stockout';\n  detalle: any;\n  leida: boolean;\n  created_at: string;\n  inventario?: {\n    codigo_articulo: string;\n    descripcion_articulo: string;\n  };\n}\n\ninterface AlertasTableProps {\n  alertas: InventarioAlerta[];\n  onRefresh: () => void;\n}\n\nexport default function AlertasTable({ alertas, onRefresh }: AlertasTableProps) {\n  const [filtroTipo, setFiltroTipo] = useState('todos');\n  const [filtroEstado, setFiltroEstado] = useState('todos');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedItems, setSelectedItems] = useState<number[]>([]);\n  const [loading, setLoading] = useState(false);\n\n  const getTipoInfo = (tipo: string) => {\n    switch (tipo) {\n      case 'stockout':\n        return { \n          label: 'Sin Stock', \n          color: 'bg-red-100 text-red-800', \n          icon: 'ri-error-warning-line',\n          iconColor: 'text-red-600'\n        };\n      case 'below_min':\n        return { \n          label: 'Bajo M√≠nimo', \n          color: 'bg-orange-100 text-orange-800', \n          icon: 'ri-alert-line',\n          iconColor: 'text-orange-600'\n        };\n      case 'below_rop':\n        return { \n          label: 'Bajo ROP', \n          color: 'bg-yellow-100 text-yellow-800', \n          icon: 'ri-information-line',\n          iconColor: 'text-yellow-600'\n        };\n      default:\n        return { \n          label: 'Desconocido', \n          color: 'bg-gray-100 text-gray-800', \n          icon: 'ri-question-line',\n          iconColor: 'text-gray-600'\n        };\n    }\n  };\n\n  const handleMarkAsRead = async (alertaId: number) => {\n    try {\n      const { error } = await supabase\n        .from('inventario_alertas')\n        .update({ leida: true })\n        .eq('id', alertaId);\n\n      if (error) throw error;\n      onRefresh();\n    } catch (error: any) {\n      console.error('Error marcando alerta como le√≠da:', error);\n      alert('Error al marcar la alerta como le√≠da');\n    }\n  };\n\n  const handleMarkMultipleAsRead = async () => {\n    if (selectedItems.length === 0) {\n      alert('Selecciona al menos una alerta');\n      return;\n    }\n\n    try {\n      setLoading(true);\n      const { error } = await supabase\n        .from('inventario_alertas')\n        .update({ leida: true })\n        .in('id', selectedItems);\n\n      if (error) throw error;\n      \n      setSelectedItems([]);\n      onRefresh();\n      alert(`${selectedItems.length} alertas marcadas como le√≠das`);\n    } catch (error: any) {\n      console.error('Error marcando alertas como le√≠das:', error);\n      alert('Error al marcar las alertas como le√≠das');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDeleteMultiple = async () => {\n    if (selectedItems.length === 0) {\n      alert('Selecciona al menos una alerta');\n      return;\n    }\n\n    if (!confirm(`¬øEst√°s seguro de eliminar ${selectedItems.length} alertas seleccionadas?`)) {\n      return;\n    }\n\n    try {\n      setLoading(true);\n      const { error } = await supabase\n        .from('inventario_alertas')\n        .delete()\n        .in('id', selectedItems);\n\n      if (error) throw error;\n      \n      setSelectedItems([]);\n      onRefresh();\n      alert(`${selectedItems.length} alertas eliminadas exitosamente`);\n    } catch (error: any) {\n      console.error('Error eliminando alertas:', error);\n      alert('Error al eliminar las alertas');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleExportCSV = () => {\n    const headers = [\n      'Fecha',\n      'Tipo',\n      'C√≥digo Art√≠culo',\n      'Descripci√≥n',\n      'Disponible',\n      'Umbral',\n      'Estado',\n      'Le√≠da'\n    ];\n\n    const csvData = filteredAlertas.map(alerta => {\n      const tipoInfo = getTipoInfo(alerta.tipo);\n      const detalle = alerta.detalle || {};\n      \n      return [\n        new Date(alerta.created_at).toLocaleDateString(),\n        tipoInfo.label,\n        detalle.articulo_codigo || '',\n        detalle.articulo_descripcion || '',\n        detalle.disponible || '0',\n        detalle.min_qty || detalle.reorder_point || '0',\n        alerta.leida ? 'Le√≠da' : 'No le√≠da',\n        alerta.leida ? 'S√≠' : 'No'\n      ];\n    });\n\n    const csvContent = [\n      headers.join(','),\n      ...csvData.map(row => row.map(cell => `\"${cell}\"`).join(','))\n    ].join('\\n');\n\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n    const link = document.createElement('a');\n    const url = URL.createObjectURL(blob);\n    link.setAttribute('href', url);\n    link.setAttribute('download', `alertas_inventario_${new Date().toISOString().split('T')[0]}.csv`);\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  const handleGenerateAlertas = async () => {\n    try {\n      setLoading(true);\n      \n      // Obtener umbrales y niveles para generar alertas\n      const { data: thresholds, error: thresholdsError } = await supabase\n        .from('inventario_thresholds')\n        .select(`\n          *,\n          inventario:inventario!inner(codigo_articulo, descripcion_articulo)\n        `)\n        .eq('activo', true);\n\n      if (thresholdsError) throw thresholdsError;\n\n      const alertasACrear = [];\n\n      for (const threshold of thresholds || []) {\n        // Obtener nivel actual\n        const { data: nivel } = await supabase\n          .from('inventario_niveles')\n          .select('*')\n          .eq('articulo_id', threshold.articulo_id)\n          .single();\n\n        if (!nivel) continue;\n\n        const disponible = nivel.on_hand - nivel.reservado;\n        let tipoAlerta = null;\n\n        if (disponible <= 0) {\n          tipoAlerta = 'stockout';\n        } else if (disponible < threshold.min_qty) {\n          tipoAlerta = 'below_min';\n        } else if (disponible < threshold.reorder_point) {\n          tipoAlerta = 'below_rop';\n        }\n\n        if (tipoAlerta) {\n          // Verificar si ya existe una alerta similar no le√≠da\n          const { data: alertaExistente } = await supabase\n            .from('inventario_alertas')\n            .select('id')\n            .eq('articulo_id', threshold.articulo_id)\n            .eq('tipo', tipoAlerta)\n            .eq('leida', false)\n            .single();\n\n          if (!alertaExistente) {\n            alertasACrear.push({\n              articulo_id: threshold.articulo_id,\n              tipo: tipoAlerta,\n              detalle: {\n                disponible,\n                min_qty: threshold.min_qty,\n                reorder_point: threshold.reorder_point,\n                articulo_codigo: threshold.inventario.codigo_articulo,\n                articulo_descripcion: threshold.inventario.descripcion_articulo\n              },\n              leida: false\n            });\n          }\n        }\n      }\n\n      if (alertasACrear.length > 0) {\n        const { error: insertError } = await supabase\n          .from('inventario_alertas')\n          .insert(alertasACrear);\n\n        if (insertError) throw insertError;\n        \n        alert(`Se generaron ${alertasACrear.length} nuevas alertas`);\n      } else {\n        alert('No se encontraron nuevas alertas para generar');\n      }\n\n      onRefresh();\n    } catch (error: any) {\n      console.error('Error generando alertas:', error);\n      alert('Error al generar alertas autom√°ticas');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const filteredAlertas = alertas.filter(alerta => {\n    const matchesSearch = \n      alerta.detalle?.articulo_codigo?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      alerta.detalle?.articulo_descripcion?.toLowerCase().includes(searchTerm.toLowerCase());\n    \n    if (!matchesSearch) return false;\n\n    if (filtroTipo !== 'todos' && alerta.tipo !== filtroTipo) return false;\n    if (filtroEstado === 'leidas' && !alerta.leida) return false;\n    if (filtroEstado === 'no_leidas' && alerta.leida) return false;\n\n    return true;\n  });\n\n  const handleSelectAll = (checked: boolean) => {\n    if (checked) {\n      setSelectedItems(filteredAlertas.map(a => a.id));\n    } else {\n      setSelectedItems([]);\n    }\n  };\n\n  const handleSelectItem = (id: number, checked: boolean) => {\n    if (checked) {\n      setSelectedItems([...selectedItems, id]);\n    } else {\n      setSelectedItems(selectedItems.filter(item => item !== id));\n    }\n  };\n\n  return (\n    <div className=\"p-6\">\n      {/* Header */}\n      <div className=\"mb-6 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n        <h2 className=\"text-xl font-semibold text-gray-900\">Alertas de Inventario</h2>\n        <div className=\"flex flex-wrap gap-2\">\n          <button\n            onClick={handleGenerateAlertas}\n            disabled={loading}\n            className=\"flex items-center px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors whitespace-nowrap disabled:opacity-50\"\n          >\n            <i className=\"ri-refresh-line mr-2\"></i>\n            Generar Alertas\n          </button>\n          <button\n            onClick={handleExportCSV}\n            className=\"flex items-center px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors whitespace-nowrap\"\n          >\n            <i className=\"ri-download-line mr-2\"></i>\n            Exportar CSV\n          </button>\n        </div>\n      </div>\n\n      {/* Acciones masivas */}\n      {selectedItems.length > 0 && (\n        <div className=\"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-blue-800 font-medium\">\n              {selectedItems.length} alertas seleccionadas\n            </span>\n            <div className=\"flex gap-2\">\n              <button\n                onClick={handleMarkMultipleAsRead}\n                disabled={loading}\n                className=\"flex items-center px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 transition-colors disabled:opacity-50\"\n              >\n                <i className=\"ri-check-line mr-1\"></i>\n                Marcar como Le√≠das\n              </button>\n              <button\n                onClick={handleDeleteMultiple}\n                disabled={loading}\n                className=\"flex items-center px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors disabled:opacity-50\"\n              >\n                <i className=\"ri-delete-bin-line mr-1\"></i>\n                Eliminar\n              </button>\n              <button\n                onClick={() => setSelectedItems([])}\n                className=\"flex items-center px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors\"\n              >\n                <i className=\"ri-close-line mr-1\"></i>\n                Cancelar\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Filtros */}\n      <div className=\"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4\">\n        <input\n          type=\"text\"\n          placeholder=\"Buscar por c√≥digo o descripci√≥n...\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n          className=\"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n        />\n        <select\n          value={filtroTipo}\n          onChange={(e) => setFiltroTipo(e.target.value)}\n          className=\"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8\"\n        >\n          <option value=\"todos\">Todos los tipos</option>\n          <option value=\"stockout\">üî¥ Sin Stock</option>\n          <option value=\"below_min\">üü† Bajo M√≠nimo</option>\n          <option value=\"below_rop\">üü° Bajo ROP</option>\n        </select>\n        <select\n          value={filtroEstado}\n          onChange={(e) => setFiltroEstado(e.target.value)}\n          className=\"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8\"\n        >\n          <option value=\"todos\">Todos los estados</option>\n          <option value=\"no_leidas\">No le√≠das</option>\n          <option value=\"leidas\">Le√≠das</option>\n        </select>\n      </div>\n\n      {/* Estad√≠sticas */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\n        <div className=\"bg-red-50 p-4 rounded-lg\">\n          <div className=\"flex items-center\">\n            <i className=\"ri-error-warning-line text-red-600 mr-2\"></i>\n            <span className=\"text-sm font-medium text-red-700\">Sin Stock</span>\n          </div>\n          <p className=\"text-2xl font-bold text-red-900\">\n            {alertas.filter(a => a.tipo === 'stockout').length}\n          </p>\n        </div>\n        <div className=\"bg-orange-50 p-4 rounded-lg\">\n          <div className=\"flex items-center\">\n            <i className=\"ri-alert-line text-orange-600 mr-2\"></i>\n            <span className=\"text-sm font-medium text-orange-700\">Bajo M√≠nimo</span>\n          </div>\n          <p className=\"text-2xl font-bold text-orange-900\">\n            {alertas.filter(a => a.tipo === 'below_min').length}\n          </p>\n        </div>\n        <div className=\"bg-yellow-50 p-4 rounded-lg\">\n          <div className=\"flex items-center\">\n            <i className=\"ri-information-line text-yellow-600 mr-2\"></i>\n            <span className=\"text-sm font-medium text-yellow-700\">Bajo ROP</span>\n          </div>\n          <p className=\"text-2xl font-bold text-yellow-900\">\n            {alertas.filter(a => a.tipo === 'below_rop').length}\n          </p>\n        </div>\n        <div className=\"bg-blue-50 p-4 rounded-lg\">\n          <div className=\"flex items-center\">\n            <i className=\"ri-notification-line text-blue-600 mr-2\"></i>\n            <span className=\"text-sm font-medium text-blue-700\">No Le√≠das</span>\n          </div>\n          <p className=\"text-2xl font-bold text-blue-900\">\n            {alertas.filter(a => !a.leida).length}\n          </p>\n        </div>\n      </div>\n\n      {/* Tabla */}\n      <div className=\"overflow-x-auto\">\n        <table className=\"min-w-full divide-y divide-gray-200\">\n          <thead className=\"bg-gray-50\">\n            <tr>\n              <th className=\"px-6 py-3 text-left\">\n                <input\n                  type=\"checkbox\"\n                  checked={selectedItems.length === filteredAlertas.length && filteredAlertas.length > 0}\n                  onChange={(e) => handleSelectAll(e.target.checked)}\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                />\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Fecha\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Tipo\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Art√≠culo\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Detalle\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Estado\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Acciones\n              </th>\n            </tr>\n          </thead>\n          <tbody className=\"bg-white divide-y divide-gray-200\">\n            {filteredAlertas.map((alerta) => {\n              const tipoInfo = getTipoInfo(alerta.tipo);\n              const detalle = alerta.detalle || {};\n              \n              return (\n                <tr key={alerta.id} className={`hover:bg-gray-50 ${!alerta.leida ? 'bg-blue-50' : ''}`}>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <input\n                      type=\"checkbox\"\n                      checked={selectedItems.includes(alerta.id)}\n                      onChange={(e) => handleSelectItem(alerta.id, e.target.checked)}\n                      className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                    />\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {new Date(alerta.created_at).toLocaleDateString()}\n                    <div className=\"text-xs text-gray-500\">\n                      {new Date(alerta.created_at).toLocaleTimeString()}\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${tipoInfo.color}`}>\n                      <i className={`${tipoInfo.icon} ${tipoInfo.iconColor} mr-1`}></i>\n                      {tipoInfo.label}\n                    </span>\n                  </td>\n                  <td className=\"px-6 py-4\">\n                    <div className=\"text-sm font-medium text-gray-900\">\n                      {detalle.articulo_codigo}\n                    </div>\n                    <div className=\"text-sm text-gray-500 max-w-xs truncate\">\n                      {detalle.articulo_descripcion}\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    <div>Disponible: <span className=\"font-medium\">{detalle.disponible || 0}</span></div>\n                    {detalle.min_qty && (\n                      <div className=\"text-xs text-gray-500\">M√≠nimo: {detalle.min_qty}</div>\n                    )}\n                    {detalle.reorder_point && (\n                      <div className=\"text-xs text-gray-500\">ROP: {detalle.reorder_point}</div>\n                    )}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    {alerta.leida ? (\n                      <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\">\n                        <i className=\"ri-check-line mr-1\"></i>\n                        Le√≠da\n                      </span>\n                    ) : (\n                      <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\">\n                        <i className=\"ri-notification-line mr-1\"></i>\n                        Nueva\n                      </span>\n                    )}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                    {!alerta.leida && (\n                      <button\n                        onClick={() => handleMarkAsRead(alerta.id)}\n                        className=\"text-green-600 hover:text-green-900 mr-3\"\n                        title=\"Marcar como le√≠da\"\n                      >\n                        <i className=\"ri-check-line\"></i>\n                      </button>\n                    )}\n                  </td>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n      {filteredAlertas.length === 0 && (\n        <div className=\"text-center py-8\">\n          <i className=\"ri-notification-off-line text-4xl text-gray-400 mb-2\"></i>\n          <p className=\"text-gray-500\">No se encontraron alertas con los filtros aplicados</p>\n        </div>\n      )}\n    </div>\n  );\n}\n","\nimport { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\nimport * as XLSX from 'xlsx';\n\ninterface ReplenishmentOrder {\n  id: number;\n  articulo_id: number;\n  qty_sugerida: number;\n  motivo: 'below_min' | 'below_rop';\n  estado: 'borrador' | 'emitida' | 'completada' | 'cancelada';\n  generado_por: string;\n  notas?: string;\n  created_at: string;\n  updated_at: string;\n  inventario?: {\n    codigo_articulo: string;\n    descripcion_articulo: string;\n  };\n}\n\ninterface ReplenishmentTableProps {\n  orders: ReplenishmentOrder[];\n  onRefresh: () => void;\n}\n\n/**\n * ReplenishmentTable\n *\n * Renderiza una tabla con √≥rdenes de reabastecimiento con\n * filtros, b√∫squedas, acciones masivas y exportaci√≥n CSV.\n *\n * Mejoras realizadas:\n *  - Correcci√≥n de errores de sintaxis (clases incompletas, comillas faltantes).\n *  - A√±adido manejo de errores robusto en llamadas a Supabase.\n *  - Validaci√≥n defensiva de `orders` para evitar errores si no es un array.\n *  - Peque√±as refactorizaciones para mayor claridad.\n */\nexport default function ReplenishmentTable({\n  orders = [],\n  onRefresh,\n}: ReplenishmentTableProps) {\n  const [filtroEstado, setFiltroEstado] = useState('todos');\n  const [filtroMotivo, setFiltroMotivo] = useState('todos');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedItems, setSelectedItems] = useState<number[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [editingOrder, setEditingOrder] = useState<ReplenishmentOrder | null>(null);\n  const [showNotesModal, setShowNotesModal] = useState(false);\n\n  // Validaci√≥n defensiva: garantiza que `orders` sea siempre un array.\n  const safeOrders = Array.isArray(orders) ? orders : [];\n\n  // Escuchar eventos de actualizaci√≥n de reabastecimiento\n  useEffect(() => {\n    const handleReplenishmentUpdate = () => {\n      onRefresh();\n    };\n\n    window.addEventListener('replenishment-updated', handleReplenishmentUpdate);\n    \n    return () => {\n      window.removeEventListener('replenishment-updated', handleReplenishmentUpdate);\n    };\n  }, [onRefresh]);\n\n  const getEstadoInfo = (estado: string) => {\n    switch (estado) {\n      case 'borrador':\n        return {\n          label: 'Borrador',\n          color: 'bg-gray-100 text-gray-800',\n          icon: 'ri-draft-line',\n          iconColor: 'text-gray-600',\n        };\n      case 'emitida':\n        return {\n          label: 'Emitida',\n          color: 'bg-blue-100 text-blue-800',\n          icon: 'ri-send-plane-line',\n          iconColor: 'text-blue-600',\n        };\n      case 'completada':\n        return {\n          label: 'Completada',\n          color: 'bg-green-100 text-green-800',\n          icon: 'ri-check-line',\n          iconColor: 'text-green-600',\n        };\n      case 'cancelada':\n        return {\n          label: 'Cancelada',\n          color: 'bg-red-100 text-red-800',\n          icon: 'ri-close-line',\n          iconColor: 'text-red-600',\n        };\n      default:\n        return {\n          label: 'Desconocido',\n          color: 'bg-gray-100 text-gray-800',\n          icon: 'ri-question-line',\n          iconColor: 'text-gray-600',\n        };\n    }\n  };\n\n  const getMotivoInfo = (motivo: string) => {\n    switch (motivo) {\n      case 'below_min':\n        return { label: 'Bajo M√≠nimo', color: 'text-red-600', icon: 'ri-arrow-down-line' };\n      case 'below_rop':\n        return { label: 'Bajo ROP', color: 'text-yellow-600', icon: 'ri-alert-line' };\n      default:\n        return { label: 'Otro', color: 'text-gray-600', icon: 'ri-information-line' };\n    }\n  };\n\n  const handleChangeEstado = async (orderId: number, nuevoEstado: string) => {\n    try {\n      const { error } = await supabase\n        .from('replenishment_orders')\n        .update({ estado: nuevoEstado, updated_at: new Date().toISOString() })\n        .eq('id', orderId);\n\n      if (error) throw error;\n      onRefresh();\n    } catch (error: any) {\n      console.error('Error cambiando estado:', error);\n      alert('Error al cambiar el estado de la orden');\n    }\n  };\n\n  const handleMassiveChangeEstado = async (nuevoEstado: string) => {\n    if (selectedItems.length === 0) {\n      alert('Selecciona al menos una orden');\n      return;\n    }\n\n    if (!window.confirm(`¬øCambiar el estado de ${selectedItems.length} √≥rdenes a \"${nuevoEstado}\"?`)) {\n      return;\n    }\n\n    try {\n      setLoading(true);\n      const { error } = await supabase\n        .from('replenishment_orders')\n        .update({ estado: nuevoEstado, updated_at: new Date().toISOString() })\n        .in('id', selectedItems);\n\n      if (error) throw error;\n\n      setSelectedItems([]);\n      onRefresh();\n      alert(`${selectedItems.length} √≥rdenes actualizadas exitosamente`);\n    } catch (error: any) {\n      console.error('Error cambiando estados:', error);\n      alert('Error al cambiar los estados');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDelete = async (orderId: number) => {\n    if (!window.confirm('¬øEst√°s seguro de eliminar esta orden de reabastecimiento?')) {\n      return;\n    }\n\n    try {\n      const { error } = await supabase.from('replenishment_orders').delete().eq('id', orderId);\n      if (error) throw error;\n      onRefresh();\n      alert('Orden eliminada exitosamente');\n    } catch (error: any) {\n      console.error('Error eliminando orden:', error);\n      alert('Error al eliminar la orden');\n    }\n  };\n\n  const handleMassiveDelete = async () => {\n    if (selectedItems.length === 0) {\n      alert('Selecciona al menos una orden');\n      return;\n    }\n\n    if (!window.confirm(`¬øEst√°s seguro de eliminar ${selectedItems.length} √≥rdenes seleccionadas?`)) {\n      return;\n    }\n\n    try {\n      setLoading(true);\n      const { error } = await supabase\n        .from('replenishment_orders')\n        .delete()\n        .in('id', selectedItems);\n\n      if (error) throw error;\n\n      setSelectedItems([]);\n      onRefresh();\n      alert(`${selectedItems.length} √≥rdenes eliminadas exitosamente`);\n    } catch (error: any) {\n      console.error('Error eliminando √≥rdenes:', error);\n      alert('Error al eliminar las √≥rdenes');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleExportExcel = async () => {\n    try {\n      // Crear datos para Excel\n      const excelData = filteredOrders.map(order => {\n        const motivoInfo = getMotivoInfo(order.motivo);\n        const estadoInfo = getEstadoInfo(order.estado);\n        \n        return {\n          'Fecha Creaci√≥n': new Date(order.created_at).toLocaleDateString(),\n          'Hora': new Date(order.created_at).toLocaleTimeString(),\n          'C√≥digo Art√≠culo': order.inventario?.codigo_articulo || '',\n          'Descripci√≥n': order.inventario?.descripcion_articulo || '',\n          'Cantidad Sugerida': order.qty_sugerida.toFixed(2),\n          'Motivo': motivoInfo.label,\n          'Estado': estadoInfo.label,\n          'Generado Por': order.generado_por || '',\n          'Notas': order.notas || '',\n          '√öltima Actualizaci√≥n': new Date(order.updated_at).toLocaleDateString()\n        };\n      });\n\n      // Crear workbook y worksheet\n      const ws = XLSX.utils.json_to_sheet(excelData);\n      const wb = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(wb, ws, '√ìrdenes de Reabastecimiento');\n\n      // Configurar anchos de columna\n      const colWidths = [\n        { wch: 15 }, // Fecha Creaci√≥n\n        { wch: 12 }, // Hora\n        { wch: 15 }, // C√≥digo Art√≠culo\n        { wch: 40 }, // Descripci√≥n\n        { wch: 18 }, // Cantidad Sugerida\n        { wch: 15 }, // Motivo\n        { wch: 12 }, // Estado\n        { wch: 20 }, // Generado Por\n        { wch: 30 }, // Notas\n        { wch: 18 }  // √öltima Actualizaci√≥n\n      ];\n      ws['!cols'] = colWidths;\n\n      // Generar archivo Excel\n      const fileName = `ordenes_reabastecimiento_${new Date().toISOString().split('T')[0]}.xlsx`;\n      XLSX.writeFile(wb, fileName);\n      \n    } catch (error) {\n      console.error('Error exportando a Excel:', error);\n      alert('Error al exportar los datos a Excel');\n    }\n  };\n\n  const handleEditNotes = (order: ReplenishmentOrder) => {\n    setEditingOrder(order);\n    setShowNotesModal(true);\n  };\n\n  const handleSaveNotes = async (notas: string) => {\n    if (!editingOrder) return;\n\n    try {\n      const { error } = await supabase\n        .from('replenishment_orders')\n        .update({ notas, updated_at: new Date().toISOString() })\n        .eq('id', editingOrder.id);\n\n      if (error) throw error;\n\n      setShowNotesModal(false);\n      setEditingOrder(null);\n      onRefresh();\n    } catch (error: any) {\n      console.error('Error guardando notas:', error);\n      alert('Error al guardar las notas');\n    }\n  };\n\n  const filteredOrders = safeOrders.filter((order) => {\n    const matchesSearch =\n      order.inventario?.codigo_articulo?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      order.inventario?.descripcion_articulo?.toLowerCase().includes(searchTerm.toLowerCase());\n\n    if (!matchesSearch) return false;\n    if (filtroEstado !== 'todos' && order.estado !== filtroEstado) return false;\n    if (filtroMotivo !== 'todos' && order.motivo !== filtroMotivo) return false;\n    return true;\n  });\n\n  const handleSelectAll = (checked: boolean) => {\n    if (checked) {\n      setSelectedItems(filteredOrders.map((o) => o.id));\n    } else {\n      setSelectedItems([]);\n    }\n  };\n\n  const handleSelectItem = (id: number, checked: boolean) => {\n    if (checked) {\n      setSelectedItems((prev) => [...prev, id]);\n    } else {\n      setSelectedItems((prev) => prev.filter((item) => item !== id));\n    }\n  };\n\n  return (\n    <div className=\"p-6\">\n      {/* Header */}\n      <div className=\"mb-6 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n        <h2 className=\"text-xl font-semibold text-gray-900\">√ìrdenes de Reabastecimiento</h2>\n        <div className=\"flex flex-wrap gap-2\">\n          <button\n            onClick={handleExportExcel}\n            className=\"flex items-center px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors whitespace-nowrap\"\n          >\n            <i className=\"ri-download-line mr-2\"></i>\n            Exportar Excel\n          </button>\n        </div>\n      </div>\n\n      {/* Acciones masivas */}\n      {selectedItems.length > 0 && (\n        <div className=\"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n          <div className=\"flex items-center justify-between flex-wrap gap-2\">\n            <span className=\"text-blue-800 font-medium\">{selectedItems.length} √≥rdenes seleccionadas</span>\n            <div className=\"flex flex-wrap gap-2\">\n              <button\n                onClick={() => handleMassiveChangeEstado('emitida')}\n                disabled={loading}\n                className=\"flex items-center px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors disabled:opacity-50 text-sm\"\n              >\n                <i className=\"ri-send-plane-line mr-1\"></i>\n                Emitir\n              </button>\n              <button\n                onClick={() => handleMassiveChangeEstado('completada')}\n                disabled={loading}\n                className=\"flex items-center px-2 py-1 bg-green-600 text-white rounded hover:bg-green-700 transition-colors disabled:opacity-50 text-sm\"\n              >\n                <i className=\"ri-check-line mr-1\"></i>\n                Completar\n              </button>\n              <button\n                onClick={() => handleMassiveChangeEstado('cancelada')}\n                disabled={loading}\n                className=\"flex items-center px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors disabled:opacity-50 text-sm\"\n              >\n                <i className=\"ri-close-line mr-1\"></i>\n                Cancelar\n              </button>\n              <button\n                onClick={handleMassiveDelete}\n                disabled={loading}\n                className=\"flex items-center px-2 py-1 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors disabled:opacity-50 text-sm\"\n              >\n                <i className=\"ri-delete-bin-line mr-1\"></i>\n                Eliminar\n              </button>\n              <button\n                onClick={() => setSelectedItems([])}\n                className=\"flex items-center px-2 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors text-sm\"\n              >\n                <i className=\"ri-close-line mr-1\"></i>\n                Cancelar\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Filtros */}\n      <div className=\"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4\">\n        <input\n          type=\"text\"\n          placeholder=\"Buscar por c√≥digo o descripci√≥n...\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n          className=\"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n        />\n        <select\n          value={filtroEstado}\n          onChange={(e) => setFiltroEstado(e.target.value)}\n          className=\"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8\"\n        >\n          <option value=\"todos\">Todos los estados</option>\n          <option value=\"borrador\">üìù Borrador</option>\n          <option value=\"emitida\">üì§ Emitida</option>\n          <option value=\"completada\">‚úÖ Completada</option>\n          <option value=\"cancelada\">‚ùå Cancelada</option>\n        </select>\n        <select\n          value={filtroMotivo}\n          onChange={(e) => setFiltroMotivo(e.target.value)}\n          className=\"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8\"\n        >\n          <option value=\"todos\">Todos los motivos</option>\n          <option value=\"below_min\">üî¥ Bajo M√≠nimo</option>\n          <option value=\"below_rop\">üü° Bajo ROP</option>\n        </select>\n      </div>\n\n      {/* Estad√≠sticas */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\n        <div className=\"bg-gray-50 p-4 rounded-lg\">\n          <div className=\"flex items-center\">\n            <i className=\"ri-draft-line text-gray-600 mr-2\"></i>\n            <span className=\"text-sm font-medium text-gray-700\">Borradores</span>\n          </div>\n          <p className=\"text-2xl font-bold text-gray-900\">\n            {safeOrders.filter((o) => o.estado === 'borrador').length}\n          </p>\n        </div>\n        <div className=\"bg-blue-50 p-4 rounded-lg\">\n          <div className=\"flex items-center\">\n            <i className=\"ri-send-plane-line text-blue-600 mr-2\"></i>\n            <span className=\"text-sm font-medium text-blue-700\">Emitidas</span>\n          </div>\n          <p className=\"text-2xl font-bold text-blue-900\">\n            {safeOrders.filter((o) => o.estado === 'emitida').length}\n          </p>\n        </div>\n        <div className=\"bg-green-50 p-4 rounded-lg\">\n          <div className=\"flex items-center\">\n            <i className=\"ri-check-line text-green-600 mr-2\"></i>\n            <span className=\"text-sm font-medium text-green-700\">Completadas</span>\n          </div>\n          <p className=\"text-2xl font-bold text-green-900\">\n            {safeOrders.filter((o) => o.estado === 'completada').length}\n          </p>\n        </div>\n        <div className=\"bg-orange-50 p-4 rounded-lg\">\n          <div className=\"flex items-center\">\n            <i className=\"ri-shopping-cart-line text-orange-600 mr-2\"></i>\n            <span className=\"text-sm font-medium text-orange-700\">Total</span>\n          </div>\n          <p className=\"text-2xl font-bold text-orange-900\">{safeOrders.length}</p>\n        </div>\n      </div>\n\n      {/* Tabla */}\n      <div className=\"overflow-x-auto\">\n        <table className=\"min-w-full divide-y divide-gray-200\">\n          <thead className=\"bg-gray-50\">\n            <tr>\n              <th className=\"px-6 py-3 text-left\">\n                <input\n                  type=\"checkbox\"\n                  checked={selectedItems.length === filteredOrders.length && filteredOrders.length > 0}\n                  onChange={(e) => handleSelectAll(e.target.checked)}\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                />\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Fecha\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Art√≠culo\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Cantidad\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Motivo\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Estado\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Acciones\n              </th>\n            </tr>\n          </thead>\n          <tbody className=\"bg-white divide-y divide-gray-200\">\n            {filteredOrders.map((order) => {\n              const estadoInfo = getEstadoInfo(order.estado);\n              const motivoInfo = getMotivoInfo(order.motivo);\n              return (\n                <tr key={order.id} className=\"hover:bg-gray-50\">\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <input\n                      type=\"checkbox\"\n                      checked={selectedItems.includes(order.id)}\n                      onChange={(e) => handleSelectItem(order.id, e.target.checked)}\n                      className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                    />\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {new Date(order.created_at).toLocaleDateString()}\n                    <div className=\"text-xs text-gray-500\">{new Date(order.created_at).toLocaleTimeString()}</div>\n                  </td>\n                  <td className=\"px-6 py-4\">\n                    <div className=\"text-sm font-medium text-gray-900\">{order.inventario?.codigo_articulo}</div>\n                    <div className=\"text-sm text-gray-500 max-w-xs truncate\">{order.inventario?.descripcion_articulo}</div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium\">\n                    {order.qty_sugerida.toFixed(2)}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <span className={`inline-flex items-center text-sm font-medium ${motivoInfo.color}`}>\n                      <i className={`${motivoInfo.icon} mr-1`}></i>\n                      {motivoInfo.label}\n                    </span>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${estadoInfo.color}`}>\n                      <i className={`${estadoInfo.icon} ${estadoInfo.iconColor} mr-1`}></i>\n                      {estadoInfo.label}\n                    </span>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                    <div className=\"flex items-center space-x-2\">\n                      {order.estado === 'borrador' && (\n                        <button\n                          onClick={() => handleChangeEstado(order.id, 'emitida')}\n                          className=\"text-blue-600 hover:text-blue-900\"\n                          title=\"Emitir orden\"\n                        >\n                          <i className=\"ri-send-plane-line\"></i>\n                        </button>\n                      )}\n                      {order.estado === 'emitida' && (\n                        <button\n                          onClick={() => handleChangeEstado(order.id, 'completada')}\n                          className=\"text-green-600 hover:text-green-900\"\n                          title=\"Marcar como completada\"\n                        >\n                          <i className=\"ri-check-line\"></i>\n                        </button>\n                      )}\n                      <button\n                        onClick={() => handleEditNotes(order)}\n                        className=\"text-gray-600 hover:text-gray-900\"\n                        title=\"Editar notas\"\n                      >\n                        <i className=\"ri-edit-line\"></i>\n                      </button>\n                      <button\n                        onClick={() => handleDelete(order.id)}\n                        className=\"text-red-600 hover:text-red-900\"\n                        title=\"Eliminar\"\n                      >\n                        <i className=\"ri-delete-bin-line\"></i>\n                      </button>\n                    </div>\n                  </td>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n      {filteredOrders.length === 0 && (\n        <div className=\"text-center py-8\">\n          <i className=\"ri-shopping-cart-line text-4xl text-gray-400 mb-2\"></i>\n          <p className=\"text-gray-500\">No se encontraron √≥rdenes con los filtros aplicados</p>\n        </div>\n      )}\n\n      {/* Modal de notas */}\n      {showNotesModal && editingOrder && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-md mx-4\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h3 className=\"text-lg font-semibold text-gray-900\">Editar Notas</h3>\n              <button\n                onClick={() => setShowNotesModal(false)}\n                className=\"text-gray-400 hover:text-gray-600\"\n              >\n                <i className=\"ri-close-line text-xl\"></i>\n              </button>\n            </div>\n\n            <div className=\"mb-4\">\n              <p className=\"text-sm text-gray-600 mb-2\">\n                Orden para: {editingOrder.inventario?.codigo_articulo}\n              </p>\n              <textarea\n                defaultValue={editingOrder.notas || ''}\n                placeholder=\"Agregar notas sobre esta orden...\"\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                rows={4}\n                onKeyDown={(e) => {\n                  if (e.key === 'Enter' && e.ctrlKey) {\n                    handleSaveNotes((e.target as HTMLTextAreaElement).value);\n                  }\n                }}\n                ref={(textarea) => {\n                  if (textarea) {\n                    textarea.focus();\n                    textarea.setSelectionRange(textarea.value.length, textarea.value.length);\n                  }\n                }}\n              />\n            </div>\n\n            <div className=\"flex justify-end space-x-3\">\n              <button\n                onClick={() => setShowNotesModal(false)}\n                className=\"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors\"\n              >\n                Cancelar\n              </button>\n              <button\n                onClick={() => {\n                  const textarea = document.querySelector('textarea') as HTMLTextAreaElement;\n                  handleSaveNotes(textarea.value);\n                }}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n              >\n                Guardar\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","import { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\n\ninterface Setting {\n  id: number;\n  key: string;\n  value: string;\n  description: string;\n  type: 'string' | 'number' | 'boolean' | 'json';\n}\n\nexport default function ConfiguracionInventario() {\n  const [settings, setSettings] = useState<Setting[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [formData, setFormData] = useState<Record<string, any>>({});\n\n  useEffect(() => {\n    loadSettings();\n  }, []);\n\n  const loadSettings = async () => {\n    try {\n      setLoading(true);\n      const { data, error } = await supabase\n        .from('settings')\n        .select('*')\n        .order('key');\n\n      if (error) throw error;\n\n      setSettings(data || []);\n      \n      // Inicializar formData con los valores actuales\n      const initialData: Record<string, any> = {};\n      data?.forEach(setting => {\n        if (setting.type === 'boolean') {\n          initialData[setting.key] = setting.value === 'true';\n        } else if (setting.type === 'number') {\n          initialData[setting.key] = parseFloat(setting.value) || 0;\n        } else {\n          initialData[setting.key] = setting.value;\n        }\n      });\n      setFormData(initialData);\n    } catch (error) {\n      console.error('Error cargando configuraci√≥n:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSave = async () => {\n    try {\n      setSaving(true);\n\n      // Preparar updates para cada setting\n      const updates = settings.map(setting => {\n        let value = formData[setting.key];\n        \n        // Convertir a string para almacenar\n        if (setting.type === 'boolean') {\n          value = value ? 'true' : 'false';\n        } else if (setting.type === 'number') {\n          value = value.toString();\n        }\n\n        return {\n          id: setting.id,\n          value: value,\n          updated_at: new Date().toISOString()\n        };\n      });\n\n      // Actualizar cada setting\n      for (const update of updates) {\n        const { error } = await supabase\n          .from('settings')\n          .update({ value: update.value, updated_at: update.updated_at })\n          .eq('id', update.id);\n\n        if (error) throw error;\n      }\n\n      alert('Configuraci√≥n guardada exitosamente');\n      loadSettings(); // Recargar para confirmar cambios\n    } catch (error) {\n      console.error('Error guardando configuraci√≥n:', error);\n      alert('Error al guardar la configuraci√≥n');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleInputChange = (key: string, value: any) => {\n    setFormData(prev => ({ ...prev, [key]: value }));\n  };\n\n  const renderInput = (setting: Setting) => {\n    const value = formData[setting.key];\n\n    switch (setting.type) {\n      case 'boolean':\n        return (\n          <div className=\"flex items-center\">\n            <input\n              type=\"checkbox\"\n              id={setting.key}\n              checked={value || false}\n              onChange={(e) => handleInputChange(setting.key, e.target.checked)}\n              className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n            />\n            <label htmlFor={setting.key} className=\"ml-2 text-sm text-gray-700\">\n              {value ? 'Habilitado' : 'Deshabilitado'}\n            </label>\n          </div>\n        );\n\n      case 'number':\n        return (\n          <input\n            type=\"number\"\n            step=\"0.01\"\n            value={value || 0}\n            onChange={(e) => handleInputChange(setting.key, parseFloat(e.target.value) || 0)}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n          />\n        );\n\n      default:\n        return (\n          <input\n            type=\"text\"\n            value={value || ''}\n            onChange={(e) => handleInputChange(setting.key, e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n          />\n        );\n    }\n  };\n\n  const getSettingIcon = (key: string) => {\n    switch (key) {\n      case 'demanda_promedio_dia':\n        return 'ri-line-chart-line';\n      case 'z_score_safety':\n        return 'ri-shield-check-line';\n      case 'permitir_stock_negativo':\n        return 'ri-error-warning-line';\n      case 'auto_generar_alertas':\n        return 'ri-alarm-warning-line';\n      case 'dias_vencimiento_alertas':\n        return 'ri-calendar-line';\n      default:\n        return 'ri-settings-line';\n    }\n  };\n\n  const getSettingCategory = (key: string) => {\n    if (key.includes('demanda') || key.includes('z_score')) {\n      return 'C√°lculos de Stock';\n    } else if (key.includes('alerta')) {\n      return 'Gesti√≥n de Alertas';\n    } else if (key.includes('stock') || key.includes('negativo')) {\n      return 'Pol√≠ticas de Inventario';\n    }\n    return 'General';\n  };\n\n  // Agrupar settings por categor√≠a\n  const groupedSettings = settings.reduce((acc, setting) => {\n    const category = getSettingCategory(setting.key);\n    if (!acc[category]) {\n      acc[category] = [];\n    }\n    acc[category].push(setting);\n    return acc;\n  }, {} as Record<string, Setting[]>);\n\n  if (loading) {\n    return (\n      <div className=\"p-8 text-center\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto\"></div>\n        <p className=\"mt-2 text-gray-600\">Cargando configuraci√≥n...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"mb-6\">\n        <h2 className=\"text-lg font-medium text-gray-900 mb-2\">\n          Configuraci√≥n del Sistema de Inventario\n        </h2>\n        <p className=\"text-sm text-gray-600\">\n          Ajusta los par√°metros globales para el c√°lculo de stock inteligente y gesti√≥n de alertas.\n        </p>\n      </div>\n\n      <div className=\"space-y-8\">\n        {Object.entries(groupedSettings).map(([category, categorySettings]) => (\n          <div key={category} className=\"bg-white border border-gray-200 rounded-lg p-6\">\n            <h3 className=\"text-md font-medium text-gray-900 mb-4 flex items-center\">\n              <i className=\"ri-folder-settings-line mr-2 text-blue-600\"></i>\n              {category}\n            </h3>\n            \n            <div className=\"space-y-6\">\n              {categorySettings.map((setting) => (\n                <div key={setting.key} className=\"flex flex-col sm:flex-row sm:items-start gap-4\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center mb-2\">\n                      <i className={`${getSettingIcon(setting.key)} text-gray-500 mr-2`}></i>\n                      <label className=\"text-sm font-medium text-gray-900\">\n                        {setting.key.replace(/_/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase())}\n                      </label>\n                    </div>\n                    <p className=\"text-sm text-gray-600 mb-3\">\n                      {setting.description}\n                    </p>\n                  </div>\n                  \n                  <div className=\"sm:w-64\">\n                    {renderInput(setting)}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        ))}\n      </div>\n\n      {/* Informaci√≥n adicional */}\n      <div className=\"mt-8 bg-blue-50 border border-blue-200 rounded-lg p-4\">\n        <div className=\"flex items-start\">\n          <i className=\"ri-information-line text-blue-600 mr-2 mt-0.5\"></i>\n          <div>\n            <h4 className=\"text-sm font-medium text-blue-900 mb-1\">\n              Informaci√≥n sobre los par√°metros\n            </h4>\n            <ul className=\"text-sm text-blue-800 space-y-1\">\n              <li>‚Ä¢ <strong>Demanda promedio d√≠a:</strong> Valor por defecto para calcular el punto de reorden (ROP)</li>\n              <li>‚Ä¢ <strong>Z-score safety:</strong> Factor estad√≠stico para c√°lculo de stock de seguridad (1.65 = 90% confianza)</li>\n              <li>‚Ä¢ <strong>Permitir stock negativo:</strong> Si est√° deshabilitado, el sistema bloquear√° operaciones que resulten en stock negativo</li>\n              <li>‚Ä¢ <strong>Auto generar alertas:</strong> Crear alertas autom√°ticamente cuando se alcancen los umbrales</li>\n              <li>‚Ä¢ <strong>D√≠as vencimiento alertas:</strong> Tiempo despu√©s del cual las alertas se consideran obsoletas</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n\n      {/* Botones de acci√≥n */}\n      <div className=\"mt-8 flex justify-end space-x-3\">\n        <button\n          onClick={loadSettings}\n          disabled={saving}\n          className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50\"\n        >\n          <i className=\"ri-refresh-line mr-2\"></i>\n          Recargar\n        </button>\n        <button\n          onClick={handleSave}\n          disabled={saving}\n          className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 disabled:opacity-50\"\n        >\n          {saving ? (\n            <>\n              <i className=\"ri-loader-4-line mr-2 animate-spin\"></i>\n              Guardando...\n            </>\n          ) : (\n            <>\n              <i className=\"ri-save-line mr-2\"></i>\n              Guardar Configuraci√≥n\n            </>\n          )}\n        </button>\n      </div>\n    </div>\n  );\n}","\nimport { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\n\ninterface KPIData {\n  rotacionInventario: number;\n  valorInventarioTotal: number;\n  articulosBajoMinimo: number;\n  ordenesReabastecimiento: number;\n  alertasActivas: number;\n  eficienciaStock: number;\n  costoAlmacenamiento: number;\n  tiempoPromedioReposicion: number;\n}\n\ninterface MovimientoTendencia {\n  fecha: string;\n  entradas: number;\n  salidas: number;\n  valor: number;\n}\n\nexport default function DashboardKPIs() {\n  const [kpis, setKpis] = useState<KPIData>({\n    rotacionInventario: 0,\n    valorInventarioTotal: 0,\n    articulosBajoMinimo: 0,\n    ordenesReabastecimiento: 0,\n    alertasActivas: 0,\n    eficienciaStock: 0,\n    costoAlmacenamiento: 0,\n    tiempoPromedioReposicion: 0\n  });\n  const [tendencias, setTendencias] = useState<MovimientoTendencia[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadKPIs();\n    loadTendencias();\n  }, []);\n\n  const loadKPIs = async () => {\n    try {\n      // Valor total del inventario\n      const { data: inventarioData } = await supabase\n        .from('inventario_niveles')\n        .select(`\n          on_hand,\n          inventario!inner(precio_unitario)\n        `);\n\n      const valorTotal = inventarioData?.reduce((sum, item) => \n        sum + (item.on_hand * item.inventario.precio_unitario), 0) || 0;\n\n      // Art√≠culos bajo m√≠nimo\n      const { data: bajoMinimo } = await supabase\n        .from('inventario_thresholds')\n        .select(`\n          *,\n          inventario_niveles!inner(disponible)\n        `)\n        .lt('inventario_niveles.disponible', 'min_qty');\n\n      // Alertas activas\n      const { data: alertas } = await supabase\n        .from('inventario_alertas')\n        .select('*')\n        .eq('leida', false);\n\n      // √ìrdenes de reabastecimiento pendientes\n      const { data: ordenes } = await supabase\n        .from('replenishment_orders')\n        .select('*')\n        .in('estado', ['borrador', 'emitida']);\n\n      // Movimientos del √∫ltimo mes para calcular rotaci√≥n\n      const fechaInicio = new Date();\n      fechaInicio.setMonth(fechaInicio.getMonth() - 1);\n      \n      const { data: movimientos } = await supabase\n        .from('inventario_movimientos')\n        .select('cantidad, tipo')\n        .eq('tipo', 'venta')\n        .gte('created_at', fechaInicio.toISOString());\n\n      const ventasUltimoMes = movimientos?.reduce((sum, mov) => sum + Math.abs(mov.cantidad), 0) || 0;\n      const rotacion = valorTotal > 0 ? (ventasUltimoMes * 12) / valorTotal : 0;\n\n      // Eficiencia de stock (% de art√≠culos en nivel √≥ptimo)\n      const { data: todosUmbrales } = await supabase\n        .from('inventario_thresholds')\n        .select(`\n          *,\n          inventario_niveles!inner(disponible)\n        `);\n\n      const articulosOptimos = todosUmbrales?.filter(item => \n        item.inventario_niveles.disponible >= item.min_qty && \n        item.inventario_niveles.disponible <= item.max_qty\n      ).length || 0;\n\n      const eficiencia = todosUmbrales?.length ? (articulosOptimos / todosUmbrales.length) * 100 : 0;\n\n      setKpis({\n        rotacionInventario: rotacion,\n        valorInventarioTotal: valorTotal,\n        articulosBajoMinimo: bajoMinimo?.length || 0,\n        ordenesReabastecimiento: ordenes?.length || 0,\n        alertasActivas: alertas?.length || 0,\n        eficienciaStock: eficiencia,\n        costoAlmacenamiento: valorTotal * 0.15, // 15% anual estimado\n        tiempoPromedioReposicion: 7 // D√≠as promedio estimado\n      });\n\n    } catch (error) {\n      console.error('Error cargando KPIs:', error);\n    }\n  };\n\n  const loadTendencias = async () => {\n    try {\n      // Obtener movimientos de los √∫ltimos 30 d√≠as agrupados por fecha\n      const fechaInicio = new Date();\n      fechaInicio.setDate(fechaInicio.getDate() - 30);\n\n      const { data: movimientos } = await supabase\n        .from('inventario_movimientos')\n        .select(`\n          created_at,\n          cantidad,\n          tipo,\n          inventario!inner(precio_unitario)\n        `)\n        .gte('created_at', fechaInicio.toISOString())\n        .order('created_at');\n\n      // Agrupar por fecha\n      const movimientosPorFecha = movimientos?.reduce((acc, mov) => {\n        const fecha = new Date(mov.created_at).toISOString().split('T')[0];\n        if (!acc[fecha]) {\n          acc[fecha] = { entradas: 0, salidas: 0, valor: 0 };\n        }\n\n        const valor = Math.abs(mov.cantidad) * mov.inventario.precio_unitario;\n        \n        if (['compra', 'ajuste'].includes(mov.tipo) && mov.cantidad > 0) {\n          acc[fecha].entradas += Math.abs(mov.cantidad);\n        } else if (['venta', 'reserva'].includes(mov.tipo)) {\n          acc[fecha].salidas += Math.abs(mov.cantidad);\n        }\n        \n        acc[fecha].valor += valor;\n        return acc;\n      }, {} as Record<string, { entradas: number; salidas: number; valor: number }>) || {};\n\n      const tendenciasArray = Object.entries(movimientosPorFecha)\n        .map(([fecha, datos]) => ({\n          fecha,\n          ...datos\n        }))\n        .sort((a, b) => a.fecha.localeCompare(b.fecha));\n\n      setTendencias(tendenciasArray);\n    } catch (error) {\n      console.error('Error cargando tendencias:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const formatCurrency = (value: number) => {\n    return new Intl.NumberFormat('es-CR', {\n      style: 'currency',\n      currency: 'CRC'\n    }).format(value);\n  };\n\n  const formatNumber = (value: number, decimals = 1) => {\n    return new Intl.NumberFormat('es-CR', {\n      minimumFractionDigits: decimals,\n      maximumFractionDigits: decimals\n    }).format(value);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">Dashboard de KPIs</h1>\n          <p className=\"text-gray-600\">M√©tricas de rotaci√≥n y eficiencia del inventario</p>\n        </div>\n        <button\n          onClick={() => {\n            loadKPIs();\n            loadTendencias();\n          }}\n          className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors\"\n        >\n          <i className=\"ri-refresh-line mr-2\"></i>\n          Actualizar\n        </button>\n      </div>\n\n      {/* KPIs Grid */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n        {/* Rotaci√≥n de Inventario */}\n        <div className=\"bg-white p-6 rounded-lg shadow-sm border border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-gray-600\">Rotaci√≥n Anual</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{formatNumber(kpis.rotacionInventario)}x</p>\n            </div>\n            <div className=\"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center\">\n              <i className=\"ri-refresh-line text-blue-600 text-xl\"></i>\n            </div>\n          </div>\n          <p className=\"text-xs text-gray-500 mt-2\">\n            {kpis.rotacionInventario > 6 ? 'Excelente' : kpis.rotacionInventario > 3 ? 'Bueno' : 'Mejorable'}\n          </p>\n        </div>\n\n        {/* Valor Total */}\n        <div className=\"bg-white p-6 rounded-lg shadow-sm border border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-gray-600\">Valor Total</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{formatCurrency(kpis.valorInventarioTotal)}</p>\n            </div>\n            <div className=\"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center\">\n              <i className=\"ri-money-dollar-circle-line text-green-600 text-xl\"></i>\n            </div>\n          </div>\n          <p className=\"text-xs text-gray-500 mt-2\">Inventario total</p>\n        </div>\n\n        {/* Eficiencia */}\n        <div className=\"bg-white p-6 rounded-lg shadow-sm border border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-gray-600\">Eficiencia Stock</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{formatNumber(kpis.eficienciaStock)}%</p>\n            </div>\n            <div className=\"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center\">\n              <i className=\"ri-speed-up-line text-purple-600 text-xl\"></i>\n            </div>\n          </div>\n          <p className=\"text-xs text-gray-500 mt-2\">\n            {kpis.eficienciaStock > 80 ? 'Excelente' : kpis.eficienciaStock > 60 ? 'Bueno' : 'Cr√≠tico'}\n          </p>\n        </div>\n\n        {/* Alertas Activas */}\n        <div className=\"bg-white p-6 rounded-lg shadow-sm border border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-gray-600\">Alertas Activas</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{kpis.alertasActivas}</p>\n            </div>\n            <div className={`w-12 h-12 rounded-lg flex items-center justify-center ${\n              kpis.alertasActivas > 5 ? 'bg-red-100' : kpis.alertasActivas > 0 ? 'bg-yellow-100' : 'bg-green-100'\n            }`}>\n              <i className={`text-xl ${\n                kpis.alertasActivas > 5 ? 'ri-alarm-warning-line text-red-600' : \n                kpis.alertasActivas > 0 ? 'ri-error-warning-line text-yellow-600' : \n                'ri-checkbox-circle-line text-green-600'\n              }`}></i>\n            </div>\n          </div>\n          <p className=\"text-xs text-gray-500 mt-2\">Requieren atenci√≥n</p>\n        </div>\n      </div>\n\n      {/* M√©tricas Adicionales */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Resumen de Stock */}\n        <div className=\"bg-white p-6 rounded-lg shadow-sm border border-gray-200\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Resumen de Stock</h3>\n          <div className=\"space-y-4\">\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-gray-600\">Art√≠culos bajo m√≠nimo</span>\n              <span className=\"font-semibold text-red-600\">{kpis.articulosBajoMinimo}</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-gray-600\">√ìrdenes pendientes</span>\n              <span className=\"font-semibold text-blue-600\">{kpis.ordenesReabastecimiento}</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-gray-600\">Tiempo promedio reposici√≥n</span>\n              <span className=\"font-semibold text-gray-900\">{kpis.tiempoPromedioReposicion} d√≠as</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-gray-600\">Costo almacenamiento anual</span>\n              <span className=\"font-semibold text-gray-900\">{formatCurrency(kpis.costoAlmacenamiento)}</span>\n            </div>\n          </div>\n        </div>\n\n        {/* Tendencia de Movimientos */}\n        <div className=\"bg-white p-6 rounded-lg shadow-sm border border-gray-200\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Tendencia de Movimientos (30 d√≠as)</h3>\n          <div className=\"space-y-3\">\n            {tendencias.slice(-7).map((item, index) => (\n              <div key={index} className=\"flex items-center justify-between\">\n                <span className=\"text-sm text-gray-600\">\n                  {new Date(item.fecha).toLocaleDateString('es-CR')}\n                </span>\n                <div className=\"flex items-center space-x-4\">\n                  <div className=\"flex items-center\">\n                    <div className=\"w-3 h-3 bg-green-500 rounded-full mr-2\"></div>\n                    <span className=\"text-sm text-gray-900\">{item.entradas}</span>\n                  </div>\n                  <div className=\"flex items-center\">\n                    <div className=\"w-3 h-3 bg-red-500 rounded-full mr-2\"></div>\n                    <span className=\"text-sm text-gray-900\">{item.salidas}</span>\n                  </div>\n                  <span className=\"text-sm font-medium text-gray-900\">\n                    {formatCurrency(item.valor)}\n                  </span>\n                </div>\n              </div>\n            ))}\n          </div>\n          <div className=\"mt-4 pt-4 border-t border-gray-200\">\n            <div className=\"flex items-center justify-between text-sm\">\n              <div className=\"flex items-center\">\n                <div className=\"w-3 h-3 bg-green-500 rounded-full mr-2\"></div>\n                <span className=\"text-gray-600\">Entradas</span>\n              </div>\n              <div className=\"flex items-center\">\n                <div className=\"w-3 h-3 bg-red-500 rounded-full mr-2\"></div>\n                <span className=\"text-gray-600\">Salidas</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Recomendaciones */}\n      <div className=\"bg-white p-6 rounded-lg shadow-sm border border-gray-200\">\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Recomendaciones Inteligentes</h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          {kpis.rotacionInventario < 3 && (\n            <div className=\"p-4 bg-yellow-50 border border-yellow-200 rounded-lg\">\n              <div className=\"flex items-start\">\n                <i className=\"ri-lightbulb-line text-yellow-600 text-lg mr-3 mt-0.5\"></i>\n                <div>\n                  <h4 className=\"font-medium text-yellow-800\">Mejorar Rotaci√≥n</h4>\n                  <p className=\"text-sm text-yellow-700\">\n                    La rotaci√≥n est√° por debajo del promedio. Considera revisar pol√≠ticas de compra y promociones.\n                  </p>\n                </div>\n              </div>\n            </div>\n          )}\n          \n          {kpis.articulosBajoMinimo > 5 && (\n            <div className=\"p-4 bg-red-50 border border-red-200 rounded-lg\">\n              <div className=\"flex items-start\">\n                <i className=\"ri-alarm-warning-line text-red-600 text-lg mr-3 mt-0.5\"></i>\n                <div>\n                  <h4 className=\"font-medium text-red-800\">Stock Cr√≠tico</h4>\n                  <p className=\"text-sm text-red-700\">\n                    M√∫ltiples art√≠culos bajo m√≠nimo. Generar √≥rdenes de reabastecimiento urgente.\n                  </p>\n                </div>\n              </div>\n            </div>\n          )}\n          \n          {kpis.eficienciaStock > 85 && (\n            <div className=\"p-4 bg-green-50 border border-green-200 rounded-lg\">\n              <div className=\"flex items-start\">\n                <i className=\"ri-checkbox-circle-line text-green-600 text-lg mr-3 mt-0.5\"></i>\n                <div>\n                  <h4 className=\"font-medium text-green-800\">Excelente Gesti√≥n</h4>\n                  <p className=\"text-sm text-green-700\">\n                    La eficiencia de stock es excelente. Mantener las pol√≠ticas actuales.\n                  </p>\n                </div>\n              </div>\n            </div>\n          )}\n          \n          {kpis.ordenesReabastecimiento === 0 && kpis.articulosBajoMinimo > 0 && (\n            <div className=\"p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n              <div className=\"flex items-start\">\n                <i className=\"ri-truck-line text-blue-600 text-lg mr-3 mt-0.5\"></i>\n                <div>\n                  <h4 className=\"font-medium text-blue-800\">Generar √ìrdenes</h4>\n                  <p className=\"text-sm text-blue-700\">\n                    Hay art√≠culos bajo m√≠nimo sin √≥rdenes de reabastecimiento. Generar autom√°ticamente.\n                  </p>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","\nimport { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\n\ninterface PrediccionData {\n  articulo_id: number;\n  codigo_articulo: string;\n  descripcion_articulo: string;\n  demanda_historica: number[];\n  prediccion_30_dias: number;\n  prediccion_60_dias: number;\n  prediccion_90_dias: number;\n  tendencia: 'creciente' | 'decreciente' | 'estable';\n  confianza: number;\n  rop_sugerido: number;\n  max_sugerido: number;\n}\n\nexport default function PrediccionDemanda() {\n  const [predicciones, setPredicciones] = useState<PrediccionData[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [filtroTendencia, setFiltroTendencia] = useState<string>('todas');\n  const [ordenPor, setOrdenPor] = useState<'demanda' | 'confianza' | 'tendencia'>('demanda');\n\n  useEffect(() => {\n    calcularPredicciones();\n  }, []);\n\n  const calcularPredicciones = async () => {\n    try {\n      setLoading(true);\n\n      // Obtener movimientos hist√≥ricos de los √∫ltimos 6 meses\n      const fechaInicio = new Date();\n      fechaInicio.setMonth(fechaInicio.getMonth() - 6);\n\n      const { data: movimientos } = await supabase\n        .from('inventario_movimientos')\n        .select(`\n          articulo_id,\n          cantidad,\n          created_at,\n          inventario!inner(codigo_articulo, descripcion_articulo)\n        `)\n        .eq('tipo', 'venta')\n        .gte('created_at', fechaInicio.toISOString())\n        .order('created_at');\n\n      if (!movimientos || movimientos.length === 0) {\n        setPredicciones([]);\n        return;\n      }\n\n      // Agrupar por art√≠culo y calcular predicciones\n      const articulosMap = new Map<number, any>();\n\n      movimientos.forEach(mov => {\n        const articuloId = mov.articulo_id;\n        if (!articulosMap.has(articuloId)) {\n          articulosMap.set(articuloId, {\n            articulo_id: articuloId,\n            codigo_articulo: mov.inventario.codigo_articulo,\n            descripcion_articulo: mov.inventario.descripcion_articulo,\n            movimientos: []\n          });\n        }\n        articulosMap.get(articuloId).movimientos.push({\n          cantidad: Math.abs(mov.cantidad),\n          fecha: new Date(mov.created_at)\n        });\n      });\n\n      // Calcular predicciones para cada art√≠culo\n      const prediccionesCalculadas: PrediccionData[] = [];\n\n      for (const [articuloId, datos] of articulosMap) {\n        const prediccion = calcularPrediccionArticulo(datos);\n        if (prediccion) {\n          prediccionesCalculadas.push(prediccion);\n        }\n      }\n\n      setPredicciones(prediccionesCalculadas);\n    } catch (error) {\n      console.error('Error calculando predicciones:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const calcularPrediccionArticulo = (datos: any): PrediccionData | null => {\n    const movimientos = datos.movimientos;\n    if (movimientos.length < 3) return null; // Necesitamos al menos 3 puntos de datos\n\n    // Agrupar por semana para suavizar la demanda\n    const demandaSemanal = agruparPorSemana(movimientos);\n    if (demandaSemanal.length < 4) return null; // Al menos 4 semanas de datos\n\n    // Calcular tendencia usando regresi√≥n lineal simple\n    const { pendiente, intercepto, r2 } = regresionLineal(demandaSemanal);\n    \n    // Calcular promedio m√≥vil para suavizar\n    const promedioMovil = calcularPromedioMovil(demandaSemanal, 4);\n    \n    // Predicciones basadas en tendencia y estacionalidad\n    const demandaPromedio = demandaSemanal.reduce((sum, val) => sum + val, 0) / demandaSemanal.length;\n    const variabilidad = calcularVariabilidad(demandaSemanal);\n    \n    // Predicciones (convertir de semanal a mensual)\n    const prediccion30 = Math.max(0, (demandaPromedio + pendiente * 4) * 4.33); // 4.33 semanas por mes\n    const prediccion60 = Math.max(0, (demandaPromedio + pendiente * 8) * 4.33 * 2);\n    const prediccion90 = Math.max(0, (demandaPromedio + pendiente * 12) * 4.33 * 3);\n\n    // Determinar tendencia\n    let tendencia: 'creciente' | 'decreciente' | 'estable' = 'estable';\n    if (Math.abs(pendiente) > demandaPromedio * 0.1) {\n      tendencia = pendiente > 0 ? 'creciente' : 'decreciente';\n    }\n\n    // Confianza basada en R¬≤ y cantidad de datos\n    const confianza = Math.min(95, Math.max(30, r2 * 100 * (movimientos.length / 20)));\n\n    // Sugerir nuevos umbrales basados en predicci√≥n\n    const leadTime = 2; // Asumimos 2 semanas de lead time\n    const safetyFactor = 1.5; // Factor de seguridad\n    \n    const ropSugerido = Math.ceil(prediccion30 / 4 * leadTime * safetyFactor);\n    const maxSugerido = Math.ceil(prediccion60 / 2); // 2 meses de stock m√°ximo\n\n    return {\n      articulo_id: datos.articulo_id,\n      codigo_articulo: datos.codigo_articulo,\n      descripcion_articulo: datos.descripcion_articulo,\n      demanda_historica: demandaSemanal,\n      prediccion_30_dias: Math.round(prediccion30),\n      prediccion_60_dias: Math.round(prediccion60),\n      prediccion_90_dias: Math.round(prediccion90),\n      tendencia,\n      confianza: Math.round(confianza),\n      rop_sugerido: ropSugerido,\n      max_sugerido: maxSugerido\n    };\n  };\n\n  const agruparPorSemana = (movimientos: any[]) => {\n    const semanas = new Map<string, number>();\n    \n    movimientos.forEach(mov => {\n      const fecha = new Date(mov.fecha);\n      const inicioSemana = new Date(fecha);\n      inicioSemana.setDate(fecha.getDate() - fecha.getDay());\n      const claveSeamana = inicioSemana.toISOString().split('T')[0];\n      \n      semanas.set(claveSeamana, (semanas.get(claveSeamana) || 0) + mov.cantidad);\n    });\n\n    return Array.from(semanas.values()).sort();\n  };\n\n  const regresionLineal = (datos: number[]) => {\n    const n = datos.length;\n    const x = datos.map((_, i) => i);\n    const y = datos;\n\n    const sumX = x.reduce((a, b) => a + b, 0);\n    const sumY = y.reduce((a, b) => a + b, 0);\n    const sumXY = x.reduce((sum, xi, i) => sum + xi * y[i], 0);\n    const sumXX = x.reduce((sum, xi) => sum + xi * xi, 0);\n\n    const pendiente = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);\n    const intercepto = (sumY - pendiente * sumX) / n;\n\n    // Calcular R¬≤\n    const yMean = sumY / n;\n    const ssTotal = y.reduce((sum, yi) => sum + Math.pow(yi - yMean, 2), 0);\n    const ssRes = y.reduce((sum, yi, i) => sum + Math.pow(yi - (pendiente * x[i] + intercepto), 2), 0);\n    const r2 = 1 - (ssRes / ssTotal);\n\n    return { pendiente, intercepto, r2: Math.max(0, r2) };\n  };\n\n  const calcularPromedioMovil = (datos: number[], ventana: number) => {\n    const resultado = [];\n    for (let i = ventana - 1; i < datos.length; i++) {\n      const suma = datos.slice(i - ventana + 1, i + 1).reduce((a, b) => a + b, 0);\n      resultado.push(suma / ventana);\n    }\n    return resultado;\n  };\n\n  const calcularVariabilidad = (datos: number[]) => {\n    const promedio = datos.reduce((a, b) => a + b, 0) / datos.length;\n    const varianza = datos.reduce((sum, val) => sum + Math.pow(val - promedio, 2), 0) / datos.length;\n    return Math.sqrt(varianza);\n  };\n\n  const aplicarUmbralesSugeridos = async (prediccion: PrediccionData) => {\n    try {\n      const { error } = await supabase\n        .from('inventario_thresholds')\n        .upsert({\n          articulo_id: prediccion.articulo_id,\n          min_qty: Math.ceil(prediccion.rop_sugerido * 0.7), // 70% del ROP como m√≠nimo\n          max_qty: prediccion.max_sugerido,\n          safety_stock: Math.ceil(prediccion.rop_sugerido * 0.3), // 30% del ROP como safety\n          reorder_point: prediccion.rop_sugerido,\n          lead_time_dias: 14, // 2 semanas por defecto\n          activo: true\n        }, {\n          onConflict: 'articulo_id'\n        });\n\n      if (error) {\n        console.error('Error aplicando umbrales:', error);\n        alert('Error al aplicar umbrales sugeridos');\n      } else {\n        alert('Umbrales aplicados exitosamente');\n        // Recargar predicciones\n        calcularPredicciones();\n      }\n    } catch (error) {\n      console.error('Error aplicando umbrales:', error);\n    }\n  };\n\n  const prediccionesFiltradas = predicciones\n    .filter(p => filtroTendencia === 'todas' || p.tendencia === filtroTendencia)\n    .sort((a, b) => {\n      switch (ordenPor) {\n        case 'demanda':\n          return b.prediccion_30_dias - a.prediccion_30_dias;\n        case 'confianza':\n          return b.confianza - a.confianza;\n        case 'tendencia':\n          return a.tendencia.localeCompare(b.tendencia);\n        default:\n          return 0;\n      }\n    });\n\n  const getTendenciaIcon = (tendencia: string) => {\n    switch (tendencia) {\n      case 'creciente':\n        return 'ri-arrow-up-line text-green-600';\n      case 'decreciente':\n        return 'ri-arrow-down-line text-red-600';\n      default:\n        return 'ri-arrow-right-line text-gray-600';\n    }\n  };\n\n  const getConfianzaColor = (confianza: number) => {\n    if (confianza >= 80) return 'text-green-600 bg-green-100';\n    if (confianza >= 60) return 'text-yellow-600 bg-yellow-100';\n    return 'text-red-600 bg-red-100';\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">Predicci√≥n de Demanda</h1>\n          <p className=\"text-gray-600\">An√°lisis predictivo basado en machine learning</p>\n        </div>\n        <button\n          onClick={calcularPredicciones}\n          className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors\"\n        >\n          <i className=\"ri-refresh-line mr-2\"></i>\n          Recalcular\n        </button>\n      </div>\n\n      {/* Filtros */}\n      <div className=\"bg-white p-4 rounded-lg shadow-sm border border-gray-200\">\n        <div className=\"flex flex-wrap gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Filtrar por tendencia\n            </label>\n            <select\n              value={filtroTendencia}\n              onChange={(e) => setFiltroTendencia(e.target.value)}\n              className=\"border border-gray-300 rounded-lg px-3 py-2 text-sm\"\n            >\n              <option value=\"todas\">Todas</option>\n              <option value=\"creciente\">Creciente</option>\n              <option value=\"estable\">Estable</option>\n              <option value=\"decreciente\">Decreciente</option>\n            </select>\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Ordenar por\n            </label>\n            <select\n              value={ordenPor}\n              onChange={(e) => setOrdenPor(e.target.value as any)}\n              className=\"border border-gray-300 rounded-lg px-3 py-2 text-sm\"\n            >\n              <option value=\"demanda\">Demanda predicha</option>\n              <option value=\"confianza\">Confianza</option>\n              <option value=\"tendencia\">Tendencia</option>\n            </select>\n          </div>\n        </div>\n      </div>\n\n      {/* Tabla de predicciones */}\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full divide-y divide-gray-200\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Art√≠culo\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Tendencia\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Predicci√≥n 30d\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Predicci√≥n 60d\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Predicci√≥n 90d\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Confianza\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  ROP Sugerido\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Acciones\n                </th>\n              </tr>\n            </thead>\n            <tbody className=\"bg-white divide-y divide-gray-200\">\n              {prediccionesFiltradas.map((prediccion) => (\n                <tr key={prediccion.articulo_id} className=\"hover:bg-gray-50\">\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div>\n                      <div className=\"text-sm font-medium text-gray-900\">\n                        {prediccion.codigo_articulo}\n                      </div>\n                      <div className=\"text-sm text-gray-500\">\n                        {prediccion.descripcion_articulo}\n                      </div>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"flex items-center\">\n                      <i className={`${getTendenciaIcon(prediccion.tendencia)} mr-2`}></i>\n                      <span className=\"text-sm text-gray-900 capitalize\">\n                        {prediccion.tendencia}\n                      </span>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {prediccion.prediccion_30_dias.toLocaleString()}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {prediccion.prediccion_60_dias.toLocaleString()}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {prediccion.prediccion_90_dias.toLocaleString()}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getConfianzaColor(prediccion.confianza)}`}>\n                      {prediccion.confianza}%\n                    </span>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"text-sm text-gray-900\">\n                      ROP: {prediccion.rop_sugerido}\n                    </div>\n                    <div className=\"text-sm text-gray-500\">\n                      Max: {prediccion.max_sugerido}\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                    <button\n                      onClick={() => aplicarUmbralesSugeridos(prediccion)}\n                      className=\"text-blue-600 hover:text-blue-900 mr-3\"\n                      title=\"Aplicar umbrales sugeridos\"\n                    >\n                      <i className=\"ri-check-line\"></i>\n                    </button>\n                    <button\n                      className=\"text-gray-600 hover:text-gray-900\"\n                      title=\"Ver detalles\"\n                    >\n                      <i className=\"ri-eye-line\"></i>\n                    </button>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n\n        {prediccionesFiltradas.length === 0 && (\n          <div className=\"text-center py-12\">\n            <i className=\"ri-bar-chart-line text-4xl text-gray-400 mb-4\"></i>\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n              No hay predicciones disponibles\n            </h3>\n            <p className=\"text-gray-500\">\n              Se necesitan al menos 3 movimientos de venta en los √∫ltimos 6 meses para generar predicciones.\n            </p>\n          </div>\n        )}\n      </div>\n\n      {/* Informaci√≥n sobre el algoritmo */}\n      <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n        <div className=\"flex items-start\">\n          <i className=\"ri-information-line text-blue-600 text-lg mr-3 mt-0.5\"></i>\n          <div>\n            <h4 className=\"font-medium text-blue-800 mb-2\">Sobre las Predicciones</h4>\n            <div className=\"text-sm text-blue-700 space-y-1\">\n              <p>‚Ä¢ Las predicciones se basan en an√°lisis de regresi√≥n lineal de datos hist√≥ricos</p>\n              <p>‚Ä¢ Se requieren al menos 4 semanas de datos de ventas para generar predicciones confiables</p>\n              <p>‚Ä¢ La confianza se calcula basada en la correlaci√≥n (R¬≤) y cantidad de datos disponibles</p>\n              <p>‚Ä¢ Los umbrales sugeridos incluyen factores de seguridad y lead time estimado</p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","\nimport { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\n\ninterface Notificacion {\n  id: string;\n  tipo: 'stock_critico' | 'nueva_alerta' | 'orden_completada' | 'umbral_actualizado';\n  titulo: string;\n  mensaje: string;\n  timestamp: string;\n  leida: boolean;\n  datos?: any;\n}\n\ninterface NotificacionesRealTimeProps {\n  onNuevaNotificacion?: (notificacion: Notificacion) => void;\n}\n\nexport default function NotificacionesRealTime({ onNuevaNotificacion }: NotificacionesRealTimeProps) {\n  const [notificaciones, setNotificaciones] = useState<Notificacion[]>([]);\n  const [mostrarPanel, setMostrarPanel] = useState(false);\n  const [noLeidas, setNoLeidas] = useState(0);\n\n  useEffect(() => {\n    // Cargar notificaciones iniciales\n    cargarNotificaciones();\n\n    // Suscribirse a cambios en tiempo real\n    const subscription = supabase\n      .channel('inventario_changes')\n      .on(\n        'postgres_changes',\n        {\n          event: 'INSERT',\n          schema: 'public',\n          table: 'inventario_alertas'\n        },\n        (payload) => {\n          handleNuevaAlerta(payload.new);\n        }\n      )\n      .on(\n        'postgres_changes',\n        {\n          event: 'UPDATE',\n          schema: 'public',\n          table: 'inventario_niveles'\n        },\n        (payload) => {\n          handleCambioNivel(payload.new, payload.old);\n        }\n      )\n      .on(\n        'postgres_changes',\n        {\n          event: 'UPDATE',\n          schema: 'public',\n          table: 'replenishment_orders'\n        },\n        (payload) => {\n          handleCambioOrden(payload.new, payload.old);\n        }\n      )\n      .subscribe();\n\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, []);\n\n  const cargarNotificaciones = async () => {\n    try {\n      // Simular notificaciones basadas en alertas recientes\n      const { data: alertas } = await supabase\n        .from('inventario_alertas')\n        .select(`\n          *,\n          inventario!inner(codigo_articulo, descripcion_articulo)\n        `)\n        .order('created_at', { ascending: false })\n        .limit(10);\n\n      const notificacionesGeneradas: Notificacion[] = alertas?.map(alerta => ({\n        id: `alerta_${alerta.id}`,\n        tipo: 'nueva_alerta',\n        titulo: getTituloAlerta(alerta.tipo),\n        mensaje: `${alerta.inventario.codigo_articulo} - ${alerta.inventario.descripcion_articulo}`,\n        timestamp: alerta.created_at,\n        leida: alerta.leida,\n        datos: alerta\n      })) || [];\n\n      setNotificaciones(notificacionesGeneradas);\n      setNoLeidas(notificacionesGeneradas.filter(n => !n.leida).length);\n    } catch (error) {\n      console.error('Error cargando notificaciones:', error);\n    }\n  };\n\n  const handleNuevaAlerta = async (nuevaAlerta: any) => {\n    try {\n      // Obtener datos del art√≠culo\n      const { data: inventario } = await supabase\n        .from('inventario')\n        .select('codigo_articulo, descripcion_articulo')\n        .eq('Id_Articulo', nuevaAlerta.articulo_id)\n        .single();\n\n      if (!inventario) return;\n\n      const notificacion: Notificacion = {\n        id: `alerta_${nuevaAlerta.id}`,\n        tipo: 'nueva_alerta',\n        titulo: getTituloAlerta(nuevaAlerta.tipo),\n        mensaje: `${inventario.codigo_articulo} - ${inventario.descripcion_articulo}`,\n        timestamp: nuevaAlerta.created_at,\n        leida: false,\n        datos: nuevaAlerta\n      };\n\n      setNotificaciones(prev => [notificacion, ...prev.slice(0, 9)]);\n      setNoLeidas(prev => prev + 1);\n\n      // Mostrar notificaci√≥n push si el navegador lo soporta\n      if ('Notification' in window && Notification.permission === 'granted') {\n        new Notification(notificacion.titulo, {\n          body: notificacion.mensaje,\n          icon: '/favicon.ico',\n          tag: notificacion.id\n        });\n      }\n\n      // Callback externo\n      if (onNuevaNotificacion) {\n        onNuevaNotificacion(notificacion);\n      }\n    } catch (error) {\n      console.error('Error procesando nueva alerta:', error);\n    }\n  };\n\n  const handleCambioNivel = async (nuevoNivel: any, nivelAnterior: any) => {\n    // Detectar cambios cr√≠ticos en niveles de stock\n    if (nuevoNivel.disponible <= 0 && nivelAnterior.disponible > 0) {\n      const { data: inventario } = await supabase\n        .from('inventario')\n        .select('codigo_articulo, descripcion_articulo')\n        .eq('Id_Articulo', nuevoNivel.articulo_id)\n        .single();\n\n      if (inventario) {\n        const notificacion: Notificacion = {\n          id: `stock_critico_${nuevoNivel.articulo_id}_${Date.now()}`,\n          tipo: 'stock_critico',\n          titulo: 'üî¥ Stock Agotado',\n          mensaje: `${inventario.codigo_articulo} se ha quedado sin stock`,\n          timestamp: new Date().toISOString(),\n          leida: false,\n          datos: { nivel: nuevoNivel, inventario }\n        };\n\n        setNotificaciones(prev => [notificacion, ...prev.slice(0, 9)]);\n        setNoLeidas(prev => prev + 1);\n      }\n    }\n  };\n\n  const handleCambioOrden = (nuevaOrden: any, ordenAnterior: any) => {\n    // Detectar cuando una orden se completa\n    if (nuevaOrden.estado === 'completada' && ordenAnterior.estado !== 'completada') {\n      const notificacion: Notificacion = {\n        id: `orden_completada_${nuevaOrden.id}`,\n        tipo: 'orden_completada',\n        titulo: '‚úÖ Orden Completada',\n        mensaje: `Orden de reabastecimiento #${nuevaOrden.id} completada`,\n        timestamp: new Date().toISOString(),\n        leida: false,\n        datos: nuevaOrden\n      };\n\n      setNotificaciones(prev => [notificacion, ...prev.slice(0, 9)]);\n      setNoLeidas(prev => prev + 1);\n    }\n  };\n\n  const getTituloAlerta = (tipo: string) => {\n    switch (tipo) {\n      case 'stockout':\n        return 'üî¥ Sin Stock';\n      case 'below_min':\n        return 'üü† Bajo M√≠nimo';\n      case 'below_rop':\n        return 'üü° Bajo ROP';\n      default:\n        return '‚ö†Ô∏è Alerta';\n    }\n  };\n\n  const marcarComoLeida = async (notificacionId: string) => {\n    try {\n      const notificacion = notificaciones.find(n => n.id === notificacionId);\n      if (!notificacion || notificacion.leida) return;\n\n      // Si es una alerta, marcarla como le√≠da en la base de datos\n      if (notificacion.tipo === 'nueva_alerta' && notificacion.datos) {\n        await supabase\n          .from('inventario_alertas')\n          .update({ leida: true })\n          .eq('id', notificacion.datos.id);\n      }\n\n      // Actualizar estado local\n      setNotificaciones(prev =>\n        prev.map(n =>\n          n.id === notificacionId ? { ...n, leida: true } : n\n        )\n      );\n      setNoLeidas(prev => Math.max(0, prev - 1));\n    } catch (error) {\n      console.error('Error marcando notificaci√≥n como le√≠da:', error);\n    }\n  };\n\n  const marcarTodasComoLeidas = async () => {\n    try {\n      // Marcar todas las alertas como le√≠das\n      const alertasIds = notificaciones\n        .filter(n => n.tipo === 'nueva_alerta' && !n.leida && n.datos)\n        .map(n => n.datos.id);\n\n      if (alertasIds.length > 0) {\n        await supabase\n          .from('inventario_alertas')\n          .update({ leida: true })\n          .in('id', alertasIds);\n      }\n\n      // Actualizar estado local\n      setNotificaciones(prev =>\n        prev.map(n => ({ ...n, leida: true }))\n      );\n      setNoLeidas(0);\n    } catch (error) {\n      console.error('Error marcando todas como le√≠das:', error);\n    }\n  };\n\n  const solicitarPermisoNotificaciones = async () => {\n    if ('Notification' in window && Notification.permission === 'default') {\n      const permission = await Notification.requestPermission();\n      if (permission === 'granted') {\n        new Notification('Notificaciones activadas', {\n          body: 'Ahora recibir√°s alertas de inventario en tiempo real',\n          icon: '/favicon.ico'\n        });\n      }\n    }\n  };\n\n  const formatearTiempo = (timestamp: string) => {\n    const fecha = new Date(timestamp);\n    const ahora = new Date();\n    const diferencia = ahora.getTime() - fecha.getTime();\n    const minutos = Math.floor(diferencia / (1000 * 60));\n    const horas = Math.floor(diferencia / (1000 * 60 * 60));\n    const dias = Math.floor(diferencia / (1000 * 60 * 60 * 24));\n\n    if (minutos < 1) return 'Ahora';\n    if (minutos < 60) return `${minutos}m`;\n    if (horas < 24) return `${horas}h`;\n    return `${dias}d`;\n  };\n\n  return (\n    <div className=\"relative\">\n      {/* Bot√≥n de notificaciones */}\n      <button\n        onClick={() => setMostrarPanel(!mostrarPanel)}\n        className=\"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors\"\n      >\n        <i className=\"ri-notification-line text-xl\"></i>\n        {noLeidas > 0 && (\n          <span className=\"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center\">\n            {noLeidas > 9 ? '9+' : noLeidas}\n          </span>\n        )}\n      </button>\n\n      {/* Panel de notificaciones */}\n      {mostrarPanel && (\n        <div className=\"absolute right-0 top-full mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50\">\n          {/* Header */}\n          <div className=\"p-4 border-b border-gray-200\">\n            <div className=\"flex items-center justify-between\">\n              <h3 className=\"font-semibold text-gray-900\">Notificaciones</h3>\n              <div className=\"flex items-center space-x-2\">\n                {/* Bot√≥n para solicitar permisos */}\n                {'Notification' in window && Notification.permission === 'default' && (\n                  <button\n                    onClick={solicitarPermisoNotificaciones}\n                    className=\"text-xs text-blue-600 hover:text-blue-700\"\n                    title=\"Activar notificaciones push\"\n                  >\n                    <i className=\"ri-notification-off-line\"></i>\n                  </button>\n                )}\n                \n                {noLeidas > 0 && (\n                  <button\n                    onClick={marcarTodasComoLeidas}\n                    className=\"text-xs text-blue-600 hover:text-blue-700\"\n                  >\n                    Marcar todas\n                  </button>\n                )}\n                \n                <button\n                  onClick={() => setMostrarPanel(false)}\n                  className=\"text-gray-400 hover:text-gray-600\"\n                >\n                  <i className=\"ri-close-line\"></i>\n                </button>\n              </div>\n            </div>\n          </div>\n\n          {/* Lista de notificaciones */}\n          <div className=\"max-h-96 overflow-y-auto\">\n            {notificaciones.length === 0 ? (\n              <div className=\"p-4 text-center text-gray-500\">\n                <i className=\"ri-notification-off-line text-2xl mb-2\"></i>\n                <p>No hay notificaciones</p>\n              </div>\n            ) : (\n              notificaciones.map((notificacion) => (\n                <div\n                  key={notificacion.id}\n                  className={`p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer ${\n                    !notificacion.leida ? 'bg-blue-50' : ''\n                  }`}\n                  onClick={() => marcarComoLeida(notificacion.id)}\n                >\n                  <div className=\"flex items-start justify-between\">\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center\">\n                        <span className=\"text-sm font-medium text-gray-900\">\n                          {notificacion.titulo}\n                        </span>\n                        {!notificacion.leida && (\n                          <span className=\"ml-2 w-2 h-2 bg-blue-500 rounded-full\"></span>\n                        )}\n                      </div>\n                      <p className=\"text-sm text-gray-600 mt-1\">\n                        {notificacion.mensaje}\n                      </p>\n                    </div>\n                    <span className=\"text-xs text-gray-400 ml-2\">\n                      {formatearTiempo(notificacion.timestamp)}\n                    </span>\n                  </div>\n                </div>\n              ))\n            )}\n          </div>\n\n          {/* Footer */}\n          {notificaciones.length > 0 && (\n            <div className=\"p-3 border-t border-gray-200 text-center\">\n              <button\n                onClick={() => {\n                  setMostrarPanel(false);\n                  // Aqu√≠ podr√≠as navegar a una p√°gina de todas las notificaciones\n                }}\n                className=\"text-sm text-blue-600 hover:text-blue-700\"\n              >\n                Ver todas las notificaciones\n              </button>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n","import { useState, useEffect } from 'react';\nimport { supabase } from '../../lib/supabase';\nimport MantenimientoLayout from './components/MantenimientoLayout';\nimport ThresholdsTable from './components/ThresholdsTable';\nimport AlertasTable from './components/AlertasTable';\nimport ReplenishmentTable from './components/ReplenishmentTable';\nimport ConfiguracionInventario from './components/ConfiguracionInventario';\nimport DashboardKPIs from './components/DashboardKPIs';\nimport PrediccionDemanda from './components/PrediccionDemanda';\nimport NotificacionesRealTime from './components/NotificacionesRealTime';\n\nexport default function MantenimientoPage() {\n  const [vistaActual, setVistaActual] = useState('umbrales');\n  const [loading, setLoading] = useState(true);\n  const [thresholds, setThresholds] = useState<any[]>([]);\n  const [alertas, setAlertas] = useState<any[]>([]);\n  const [replenishments, setReplenishments] = useState<any[]>([]);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      setLoading(true);\n      await Promise.all([\n        loadThresholds(),\n        loadAlertas(),\n        loadReplenishments()\n      ]);\n    } catch (error) {\n      console.error('Error cargando datos:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadThresholds = async () => {\n    const { data, error } = await supabase\n      .from('inventario_thresholds')\n      .select(`\n        *,\n        inventario!inner(codigo_articulo, descripcion_articulo)\n      `)\n      .eq('activo', true)\n      .order('created_at', { ascending: false });\n\n    if (error) {\n      console.error('Error cargando umbrales:', error);\n      return;\n    }\n\n    setThresholds(data || []);\n  };\n\n  const loadAlertas = async () => {\n    const { data, error } = await supabase\n      .from('inventario_alertas')\n      .select(`\n        *,\n        inventario!inner(codigo_articulo, descripcion_articulo)\n      `)\n      .order('created_at', { ascending: false });\n\n    if (error) {\n      console.error('Error cargando alertas:', error);\n      return;\n    }\n\n    setAlertas(data || []);\n  };\n\n  const loadReplenishments = async () => {\n    const { data, error } = await supabase\n      .from('replenishment_orders')\n      .select(`\n        *,\n        inventario!inner(codigo_articulo, descripcion_articulo),\n        usuarios!inner(nombre_completo)\n      `)\n      .order('created_at', { ascending: false });\n\n    if (error) {\n      console.error('Error cargando √≥rdenes:', error);\n      return;\n    }\n\n    setReplenishments(data || []);\n  };\n\n  const renderContent = () => {\n    if (loading && ['umbrales', 'alertas', 'reabastecimiento'].includes(vistaActual)) {\n      return (\n        <div className=\"flex items-center justify-center h-64\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      );\n    }\n\n    switch (vistaActual) {\n      case 'umbrales':\n        return (\n          <ThresholdsTable \n            thresholds={thresholds}\n            onRefresh={loadThresholds}\n          />\n        );\n      case 'alertas':\n        return (\n          <AlertasTable \n            alertas={alertas}\n            onRefresh={loadAlertas}\n          />\n        );\n      case 'reabastecimiento':\n        return (\n          <ReplenishmentTable \n            replenishments={replenishments}\n            onUpdate={loadReplenishments}\n          />\n        );\n      case 'kpis':\n        return <DashboardKPIs />;\n      case 'prediccion':\n        return <PrediccionDemanda />;\n      case 'configuracion':\n        return <ConfiguracionInventario />;\n      default:\n        return (\n          <ThresholdsTable \n            thresholds={thresholds}\n            onRefresh={loadThresholds}\n          />\n        );\n    }\n  };\n\n  return (\n    <MantenimientoLayout \n      vistaActual={vistaActual} \n      onCambiarVista={setVistaActual}\n    >\n      {/* Notificaciones en tiempo real */}\n      <div className=\"fixed top-4 right-4 z-50\">\n        <NotificacionesRealTime />\n      </div>\n\n      {renderContent()}\n    </MantenimientoLayout>\n  );\n}\n"],"names":["MantenimientoLayout","children","vistaActual","onCambiarVista","sidebarOpen","setSidebarOpen","useState","jsxs","jsx","Sidebar","TopBar","MobileNav","ThresholdForm","threshold","onClose","onSuccess","loading","setLoading","articulosDisponibles","setArticulosDisponibles","busquedaArticulo","setBusquedaArticulo","mostrarListaArticulos","setMostrarListaArticulos","articuloSeleccionado","setArticuloSeleccionado","formData","setFormData","useEffect","cargarArticulosDisponibles","articulosConUmbrales","supabase","idsConUmbrales","t","query","data","error","filtrarArticulos","busqueda","prev","filtrados","articulo","seleccionarArticulo","handleSubmit","e","actualizarThreshold","crearThreshold","handleInputChange","field","value","articulosFiltrados","Fragment","ImportarUmbrales","setError","success","setSuccess","dragActive","setDragActive","fileInputRef","useRef","handleDrag","handleDrop","handleFile","handleFileInput","file","lines","headers","h","expectedHeaders","header","dataRows","line","processedData","errors","i","row","cell","codigo_articulo","min_qty","max_qty","safety_stock","lead_time_dias","lote_minimo","articuloError","reorder_point","insertedCount","updatedCount","existing","updateError","insertError","downloadTemplate","sampleData","csvContent","blob","link","url","ThresholdsTable","thresholds","onRefresh","showForm","setShowForm","showImport","setShowImport","editingThreshold","setEditingThreshold","searchTerm","setSearchTerm","filtroSemaforo","setFiltroSemaforo","selectedItems","setSelectedItems","niveles","setNiveles","loadNiveles","articuloIds","nivelesMap","acc","nivel","handleEdit","handleCloseForm","handleDelete","handleMassiveDelete","handleGenerateReplenishment","articulosParaReabastecer","ordenesACrear","qtySugerida","handleRecalculateROP","config","demandaPromedioDia","updates","update","handleExportExcel","excelData","filteredThresholds","semaforo","getSemaforoColor","ws","XLSX.utils","wb","colWidths","fileName","XLSX.writeFile","disponible","handleSelectAll","checked","handleSelectItem","id","item","AlertasTable","alertas","filtroTipo","setFiltroTipo","filtroEstado","setFiltroEstado","getTipoInfo","tipo","handleMarkAsRead","alertaId","handleMarkMultipleAsRead","handleDeleteMultiple","handleExportCSV","csvData","filteredAlertas","alerta","tipoInfo","detalle","handleGenerateAlertas","thresholdsError","alertasACrear","tipoAlerta","alertaExistente","a","ReplenishmentTable","orders","filtroMotivo","setFiltroMotivo","editingOrder","setEditingOrder","showNotesModal","setShowNotesModal","safeOrders","handleReplenishmentUpdate","getEstadoInfo","estado","getMotivoInfo","motivo","handleChangeEstado","orderId","nuevoEstado","handleMassiveChangeEstado","filteredOrders","order","motivoInfo","estadoInfo","handleEditNotes","handleSaveNotes","notas","o","textarea","ConfiguracionInventario","settings","setSettings","saving","setSaving","loadSettings","initialData","setting","handleSave","key","renderInput","getSettingIcon","getSettingCategory","groupedSettings","category","categorySettings","l","DashboardKPIs","kpis","setKpis","tendencias","setTendencias","loadKPIs","loadTendencias","inventarioData","valorTotal","sum","bajoMinimo","ordenes","fechaInicio","movimientos","ventasUltimoMes","mov","rotacion","todosUmbrales","articulosOptimos","eficiencia","movimientosPorFecha","fecha","valor","tendenciasArray","datos","b","formatCurrency","formatNumber","decimals","index","PrediccionDemanda","predicciones","setPredicciones","filtroTendencia","setFiltroTendencia","ordenPor","setOrdenPor","calcularPredicciones","articulosMap","articuloId","prediccionesCalculadas","prediccion","calcularPrediccionArticulo","demandaSemanal","agruparPorSemana","pendiente","r2","regresionLineal","calcularPromedioMovil","demandaPromedio","val","calcularVariabilidad","prediccion30","prediccion60","prediccion90","tendencia","confianza","ropSugerido","maxSugerido","semanas","inicioSemana","claveSeamana","n","x","_","y","sumX","sumY","sumXY","xi","sumXX","intercepto","yMean","ssTotal","yi","ventana","resultado","suma","promedio","varianza","aplicarUmbralesSugeridos","prediccionesFiltradas","p","getTendenciaIcon","getConfianzaColor","NotificacionesRealTime","onNuevaNotificacion","notificaciones","setNotificaciones","mostrarPanel","setMostrarPanel","noLeidas","setNoLeidas","cargarNotificaciones","subscription","payload","handleNuevaAlerta","handleCambioNivel","handleCambioOrden","notificacionesGeneradas","getTituloAlerta","nuevaAlerta","inventario","notificacion","nuevoNivel","nivelAnterior","nuevaOrden","ordenAnterior","marcarComoLeida","notificacionId","marcarTodasComoLeidas","alertasIds","solicitarPermisoNotificaciones","formatearTiempo","timestamp","diferencia","minutos","horas","dias","MantenimientoPage","setVistaActual","setThresholds","setAlertas","replenishments","setReplenishments","loadData","loadThresholds","loadAlertas","loadReplenishments","renderContent"],"mappings":"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"}