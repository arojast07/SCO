{"version":3,"file":"page-D_VA9Hko.js","sources":["../../src/pages/inventario/components/InventarioLayout.tsx","../../src/pages/inventario/components/InventarioFilters.tsx","../../src/pages/inventario/components/InventarioTable.tsx","../../src/pages/inventario/components/InventarioForm.tsx","../../src/pages/inventario/components/ImportarInventario.tsx","../../src/pages/inventario/components/CategoriasInventarioManager.tsx","../../src/pages/inventario/page.tsx"],"sourcesContent":["\nimport { ReactNode, useState } from 'react';\nimport Sidebar from '../../../components/feature/Sidebar';\nimport TopBar from '../../../components/feature/TopBar';\nimport MobileNav from '../../../components/feature/MobileNav';\n\ninterface InventarioLayoutProps {\n  children: ReactNode;\n  vistaActual: 'inventario' | 'categorias' | 'importar';\n  onCambiarVista: (vista: 'inventario' | 'categorias' | 'importar') => void;\n}\n\nexport function InventarioLayout({ children, vistaActual, onCambiarVista }: InventarioLayoutProps) {\n  const [sidebarOpen, setSidebarOpen] = useState(false);\n\n  const tabs = [\n    {\n      id: 'inventario' as const,\n      label: 'Inventario',\n      icon: 'ri-archive-line',\n    },\n    {\n      id: 'categorias' as const,\n      label: 'Categor√≠as',\n      icon: 'ri-folder-settings-line',\n    },\n    {\n      id: 'importar' as const,\n      label: 'Importar',\n      icon: 'ri-file-excel-line',\n    },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex\">\n      {/* Sidebar */}\n      <Sidebar isOpen={sidebarOpen} onClose={() => setSidebarOpen(false)} />\n\n      {/* Contenido principal */}\n      <div className=\"flex-1 flex flex-col min-w-0\">\n        {/* TopBar */}\n        <TopBar onMenuClick={() => setSidebarOpen(true)} />\n        \n        {/* Subtopbar con tabs */}\n        <div className=\"bg-white border-b border-gray-200 px-4 lg:px-6\">\n          <div className=\"max-w-7xl mx-auto\">\n            <nav className=\"flex space-x-8\" aria-label=\"Tabs\">\n              {tabs.map((tab) => (\n                <button\n                  key={tab.id}\n                  onClick={() => onCambiarVista(tab.id)}\n                  className={`${\n                    vistaActual === tab.id\n                      ? 'border-blue-500 text-blue-600'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                  } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center cursor-pointer transition-colors`}\n                >\n                  <i className={`${tab.icon} mr-2`}></i>\n                  {tab.label}\n                </button>\n              ))}\n            </nav>\n          </div>\n        </div>\n        \n        {/* Contenido */}\n        <main className=\"flex-1 p-4 lg:p-6 pb-20 lg:pb-6 overflow-auto\">\n          <div className=\"max-w-7xl mx-auto\">\n            {children}\n          </div>\n        </main>\n      </div>\n\n      {/* Navegaci√≥n m√≥vil */}\n      <MobileNav />\n    </div>\n  );\n}\n\nexport default InventarioLayout;\n","\nimport { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\n\ninterface Categoria {\n  id_categoria: number;\n  nombre_categoria: string;\n  activo: boolean;\n}\n\ninterface InventarioFiltersProps {\n  searchTerm: string;\n  onSearchChange: (value: string) => void;\n  selectedCategoria: string;\n  onCategoriaChange: (value: string) => void;\n  categorias?: Categoria[];\n  sortBy: string;\n  onSortByChange: (value: string) => void;\n  sortOrder: 'asc' | 'desc';\n  onSortOrderChange: (value: 'asc' | 'desc') => void;\n}\n\nexport default function InventarioFilters({\n  searchTerm,\n  onSearchChange,\n  selectedCategoria,\n  onCategoriaChange,\n  categorias: categoriasExternas,\n  sortBy,\n  onSortByChange,\n  sortOrder,\n  onSortOrderChange,\n}: InventarioFiltersProps) {\n  const [categorias, setCategorias] = useState<Categoria[]>([]);\n\n  useEffect(() => {\n    if (categoriasExternas) {\n      setCategorias(categoriasExternas);\n    } else {\n      cargarCategorias();\n    }\n  }, [categoriasExternas]);\n\n  const cargarCategorias = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('categorias_inventario')\n        .select('id_categoria, nombre_categoria, activo')\n        .eq('activo', true)\n        .order('nombre_categoria');\n\n      if (error) throw error;\n      setCategorias(data || []);\n    } catch (error) {\n      console.error('Error cargando categor√≠as:', error);\n    }\n  };\n\n  const sortOptions = [\n    { value: 'codigo_articulo', label: 'C√≥digo' },\n    { value: 'descripcion_articulo', label: 'Descripci√≥n' },\n    { value: 'cantidad_articulo', label: 'Cantidad' },\n    { value: 'costo_articulo', label: 'Costo' },\n    { value: 'precio_articulo', label: 'Precio' },\n    { value: 'created_at', label: 'Fecha de creaci√≥n' },\n  ];\n\n  return (\n    <div className=\"bg-white rounded-lg shadow-sm border p-6 mb-6\">\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        {/* B√∫squeda */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Buscar\n          </label>\n          <div className=\"relative\">\n            <input\n              type=\"text\"\n              value={searchTerm}\n              onChange={(e) => onSearchChange(e.target.value)}\n              placeholder=\"C√≥digo o descripci√≥n...\"\n              className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n            <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n              <i className=\"ri-search-line text-gray-400\"></i>\n            </div>\n          </div>\n        </div>\n\n        {/* Categor√≠a */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Categor√≠a de Inventario\n          </label>\n          <div className=\"relative\">\n            <select\n              value={selectedCategoria}\n              onChange={(e) => onCategoriaChange(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8 appearance-none bg-white\"\n            >\n              <option value=\"todas\">Todas las categor√≠as</option>\n              {categorias.map((cat) => (\n                <option key={cat.id_categoria} value={cat.id_categoria.toString()}>\n                  {cat.nombre_categoria}\n                </option>\n              ))}\n            </select>\n            <div className=\"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none\">\n              <i className=\"ri-arrow-down-s-line text-gray-400\"></i>\n            </div>\n          </div>\n        </div>\n\n        {/* Ordenar por */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Ordenar por\n          </label>\n          <div className=\"relative\">\n            <select\n              value={sortBy}\n              onChange={(e) => onSortByChange(e.target.value)}\n              className=\"w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white\"\n            >\n              {sortOptions.map((option) => (\n                <option key={option.value} value={option.value}>\n                  {option.label}\n                </option>\n              ))}\n            </select>\n            <div className=\"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none\">\n              <i className=\"ri-arrow-down-s-line text-gray-400\"></i>\n            </div>\n          </div>\n        </div>\n\n        {/* Orden */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Orden\n          </label>\n          <div className=\"flex rounded-lg border border-gray-300 overflow-hidden\">\n            <button\n              onClick={() => onSortOrderChange('asc')}\n              className={`flex-1 px-4 py-2 text-sm font-medium transition-colors cursor-pointer ${\n                sortOrder === 'asc'\n                  ? 'bg-blue-600 text-white'\n                  : 'bg-white text-gray-700 hover:bg-gray-50'\n              }`}\n            >\n              <i className=\"ri-arrow-up-line mr-1\"></i>\n              Asc\n            </button>\n            <button\n              onClick={() => onSortOrderChange('desc')}\n              className={`flex-1 px-4 py-2 text-sm font-medium transition-colors border-l border-gray-300 cursor-pointer ${\n                sortOrder === 'desc'\n                  ? 'bg-blue-600 text-white'\n                  : 'bg-white text-gray-700 hover:bg-gray-50'\n              }`}\n            >\n              <i className=\"ri-arrow-down-line mr-1\"></i>\n              Desc\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Resumen de filtros activos */}\n      {(searchTerm || selectedCategoria !== 'todas') && (\n        <div className=\"mt-4 pt-4 border-t border-gray-200\">\n          <div className=\"flex flex-wrap gap-2\">\n            <span className=\"text-sm text-gray-600\">Filtros activos:</span>\n            {searchTerm && (\n              <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\">\n                B√∫squeda: \"{searchTerm}\"\n                <button\n                  onClick={() => onSearchChange('')}\n                  className=\"ml-1 text-blue-600 hover:text-blue-800 cursor-pointer\"\n                >\n                  <i className=\"ri-close-line\"></i>\n                </button>\n              </span>\n            )}\n            {selectedCategoria !== 'todas' && (\n              <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800\">\n                Categor√≠a: {categorias.find(c => c.id_categoria.toString() === selectedCategoria)?.nombre_categoria}\n                <button\n                  onClick={() => onCategoriaChange('todas')}\n                  className=\"ml-1 text-purple-600 hover:text-purple-800 cursor-pointer\"\n                >\n                  <i className=\"ri-close-line\"></i>\n                </button>\n              </span>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","import { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\nimport { useNotification } from '../../../hooks/useNotification';\nimport NotificationPopup from '../../../components/base/NotificationPopup';\nimport ConfirmationDialog from '../../../components/base/ConfirmationDialog';\n\ninterface Articulo {\n  id_articulo: number;\n  codigo_articulo: string;\n  descripcion_articulo: string;\n  cantidad_articulo: number;\n  costo_articulo: number;\n  ganancia_articulo: number;\n  precio_articulo: number;\n  categoria_id: number;\n  unidad_medida_id?: number;\n  activo: boolean;\n  created_at: string;\n  categorias_inventario?: {\n    id_categoria: number;\n    nombre_categoria: string;\n  };\n  unidades_medida?: {\n    id: number;\n    nombre: string;\n    simbolo: string;\n  };\n}\n\ninterface InventarioTableProps {\n  searchTerm: string;\n  selectedCategoria: string;\n  sortBy: string;\n  sortOrder: 'asc' | 'desc';\n  onEditar: (articulo: Articulo) => void;\n  refreshTrigger: number;\n}\n\nexport default function InventarioTable({\n  searchTerm,\n  selectedCategoria,\n  sortBy,\n  sortOrder,\n  onEditar,\n  refreshTrigger,\n}: InventarioTableProps) {\n  const [articulos, setArticulos] = useState<Articulo[]>([]);\n  const [loading, setLoading] = useState(true);\n  const { notification, showSuccess, showError, showWarning, hideNotification, confirmation, showConfirmation, hideConfirmation } = useNotification();\n\n  useEffect(() => {\n    cargarArticulos();\n  }, [searchTerm, selectedCategoria, sortBy, sortOrder, refreshTrigger]);\n\n  const cargarArticulos = async () => {\n    try {\n      setLoading(true);\n\n      // Cargar inventario, categor√≠as de inventario y unidades de medida por separado\n      const [inventarioRes, categoriasRes] = await Promise.all([\n        supabase\n          .from('inventario')\n          .select(`\n            *,\n            unidades_medida(id, nombre, simbolo)\n          `),\n        supabase\n          .from('categorias_inventario')\n          .select('id_categoria, nombre_categoria')\n      ]);\n\n      if (inventarioRes.error) throw inventarioRes.error;\n      if (categoriasRes.error) throw categoriasRes.error;\n\n      let inventarioData = inventarioRes.data || [];\n      const categoriasData = categoriasRes.data || [];\n\n      // Combinar datos manualmente\n      const articulosConCategorias = inventarioData.map(articulo => ({\n        ...articulo,\n        categorias_inventario: categoriasData.find(cat => cat.id_categoria === articulo.categoria_id) || null\n      }));\n\n      // Aplicar filtros\n      let articulosFiltrados = articulosConCategorias;\n\n      // Filtro de b√∫squeda\n      if (searchTerm) {\n        articulosFiltrados = articulosFiltrados.filter(articulo =>\n          articulo.codigo_articulo?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n          articulo.descripcion_articulo?.toLowerCase().includes(searchTerm.toLowerCase())\n        );\n      }\n\n      // Filtro de categor√≠a\n      if (selectedCategoria && selectedCategoria !== 'todas') {\n        articulosFiltrados = articulosFiltrados.filter(articulo =>\n          articulo.categoria_id === parseInt(selectedCategoria)\n        );\n      }\n\n      // Aplicar ordenamiento\n      articulosFiltrados.sort((a, b) => {\n        let aValue = a[sortBy as keyof Articulo];\n        let bValue = b[sortBy as keyof Articulo];\n\n        // Manejar valores nulos o undefined\n        if (aValue == null) aValue = '';\n        if (bValue == null) bValue = '';\n\n        // Convertir a string para comparaci√≥n\n        aValue = aValue.toString();\n        bValue = bValue.toString();\n\n        if (sortOrder === 'asc') {\n          return aValue.localeCompare(bValue);\n        } else {\n          return bValue.localeCompare(aValue);\n        }\n      });\n\n      setArticulos(articulosFiltrados);\n    } catch (error) {\n      console.error('Error cargando art√≠culos:', error);\n      \n      // Fallback: cargar solo inventario b√°sico sin unidades de medida\n      try {\n        let fallbackQuery = supabase\n          .from('inventario')\n          .select('*');\n\n        // Aplicar filtros b√°sicos\n        if (searchTerm) {\n          fallbackQuery = fallbackQuery.or(`codigo_articulo.ilike.%${searchTerm}%,descripcion_articulo.ilike.%${searchTerm}%`);\n        }\n\n        if (selectedCategoria && selectedCategoria !== 'todas') {\n          fallbackQuery = fallbackQuery.eq('categoria_id', parseInt(selectedCategoria));\n        }\n\n        // Aplicar ordenamiento\n        fallbackQuery = fallbackQuery.order(sortBy, { ascending: sortOrder === 'asc' });\n\n        const { data: fallbackData, error: fallbackError } = await fallbackQuery;\n\n        if (fallbackError) throw fallbackError;\n\n        // Cargar categor√≠as por separado para el fallback\n        const { data: categoriasFallback } = await supabase\n          .from('categorias_inventario')\n          .select('id_categoria, nombre_categoria');\n\n        const articulosConCategoriasFallback = (fallbackData || []).map(articulo => ({\n          ...articulo,\n          categorias_inventario: categoriasFallback?.find(cat => cat.id_categoria === articulo.categoria_id) || null\n        }));\n\n        setArticulos(articulosConCategoriasFallback);\n      } catch (fallbackError) {\n        console.error('Error en fallback:', fallbackError);\n        setArticulos([]);\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const toggleEstadoArticulo = async (id: number, estadoActual: boolean) => {\n    try {\n      const { error } = await supabase\n        .from('inventario')\n        .update({ activo: !estadoActual })\n        .eq('id_articulo', id);\n\n      if (error) throw error;\n      \n      // Actualizar el estado local\n      setArticulos(prev => prev.map(articulo => \n        articulo.id_articulo === id \n          ? { ...articulo, activo: !estadoActual }\n          : articulo\n      ));\n    } catch (error) {\n      console.error('Error actualizando estado:', error);\n      showError('Error al actualizar el estado del art√≠culo', 'No se pudo actualizar el estado del art√≠culo');\n    }\n  };\n\n  const handleEliminar = async (id: number) => {\n    showConfirmation(\n      'danger',\n      '¬øEliminar art√≠culo?',\n      '¬øEst√° seguro que desea eliminar este art√≠culo? Esta acci√≥n no se puede deshacer.',\n      async () => {\n        try {\n          // Primero verificar si el art√≠culo est√° siendo usado\n          const { data: bomCheck } = await supabase\n            .from('bom_items')\n            .select('id_bom_item')\n            .eq('id_componente', id)\n            .limit(1);\n\n          if (bomCheck && bomCheck.length > 0) {\n            showWarning('Art√≠culo en uso', 'Este art√≠culo est√° siendo utilizado como componente en la lista de materiales de otros productos. Para eliminarlo, primero debe ir al m√≥dulo de Productos y eliminarlo de las listas de materiales.');\n            return;\n          }\n\n          const { data: cotizacionCheck } = await supabase\n            .from('cotizacion_items')\n            .select('id_cotizacion_item')\n            .eq('id_articulo', id)\n            .limit(1);\n\n          if (cotizacionCheck && cotizacionCheck.length > 0) {\n            showWarning('Art√≠culo en uso', 'Este art√≠culo est√° siendo utilizado en cotizaciones. Para eliminarlo, primero debe eliminar las cotizaciones que lo contienen.');\n            return;\n          }\n\n          const { data: pedidoCheck } = await supabase\n            .from('pedido_items')\n            .select('id_pedido_item')\n            .eq('id_articulo', id)\n            .limit(1);\n\n          if (pedidoCheck && pedidoCheck.length > 0) {\n            showWarning('Art√≠culo en uso', 'Este art√≠culo est√° siendo utilizado en pedidos. Para eliminarlo, primero debe eliminar los pedidos que lo contienen.');\n            return;\n          }\n\n          // Si no est√° siendo usado, proceder con la eliminaci√≥n\n          const { error } = await supabase\n            .from('inventario')\n            .delete()\n            .eq('id_articulo', id);\n\n          if (error) {\n            // Manejar error de clave for√°nea\n            if (error.code === '23503') {\n              showWarning('Art√≠culo en uso', 'Este art√≠culo est√° siendo utilizado en otros registros del sistema. Para eliminarlo, primero debe eliminar las referencias en otros m√≥dulos.');\n              return;\n            }\n            throw error;\n          }\n          \n          // Actualizar la lista local\n          setArticulos(prev => prev.filter(articulo => articulo.id_articulo !== id));\n          showSuccess('Art√≠culo eliminado', 'El art√≠culo ha sido eliminado exitosamente');\n        } catch (error: any) {\n          console.error('Error eliminando art√≠culo:', error);\n          \n          // Manejar diferentes tipos de errores\n          if (error.code === '23503') {\n            showWarning('Art√≠culo en uso', 'Este art√≠culo est√° siendo utilizado en otros registros del sistema. Para eliminarlo, primero debe eliminar las referencias en otros m√≥dulos.');\n          } else {\n            showError('Error al eliminar', 'No se pudo eliminar el art√≠culo. Por favor, int√©ntelo nuevamente.');\n          }\n        }\n      }\n    );\n  };\n\n  if (loading) {\n    return (\n      <div className=\"bg-white rounded-lg shadow-sm border\">\n        <div className=\"p-8 text-center\">\n          <div className=\"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Cargando inventario...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (articulos.length === 0) {\n    return (\n      <div className=\"bg-white rounded-lg shadow-sm border\">\n        <div className=\"p-8 text-center\">\n          <i className=\"ri-archive-line text-4xl text-gray-400 mb-4\"></i>\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No hay art√≠culos</h3>\n          <p className=\"text-gray-600\">\n            {searchTerm || selectedCategoria !== 'todas'\n              ? 'No se encontraron art√≠culos con los filtros aplicados.'\n              : 'Comience agregando art√≠culos a su inventario.'}\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <div className=\"bg-white rounded-lg shadow-sm border overflow-hidden\">\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-gray-200\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    C√≥digo\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Descripci√≥n\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Categor√≠a\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Cantidad\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Unidad\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Costo\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Precio\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Estado\n                  </th>\n                  <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Acciones\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {articulos.map((articulo) => (\n                  <tr key={articulo.id_articulo} className=\"hover:bg-gray-50\">\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\n                      {articulo.codigo_articulo}\n                    </td>\n                    <td className=\"px-6 py-4 text-sm text-gray-900\">\n                      <div className=\"max-w-xs truncate\" title={articulo.descripcion_articulo}>\n                        {articulo.descripcion_articulo}\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      {articulo.categorias_inventario ? (\n                        <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800\">\n                          {articulo.categorias_inventario.nombre_categoria}\n                        </span>\n                      ) : (\n                        <span className=\"text-gray-400\">Sin categor√≠a</span>\n                      )}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      <span className={`font-medium ${\n                        articulo.cantidad_articulo <= 10 ? 'text-red-600' : \n                        articulo.cantidad_articulo <= 50 ? 'text-yellow-600' : 'text-green-600'\n                      }`}>\n                        {articulo.cantidad_articulo}\n                      </span>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      {articulo.unidades_medida ? (\n                        <span className=\"text-gray-600\">\n                          {articulo.unidades_medida.simbolo}\n                        </span>\n                      ) : (\n                        <span className=\"text-gray-400\">-</span>\n                      )}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      ‚Ç°{articulo.costo_articulo?.toLocaleString() || '0'}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      ‚Ç°{articulo.precio_articulo?.toLocaleString() || '0'}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <button\n                        onClick={() => toggleEstadoArticulo(articulo.id_articulo, articulo.activo)}\n                        className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium cursor-pointer ${\n                          articulo.activo\n                            ? 'bg-green-100 text-green-800 hover:bg-green-200'\n                            : 'bg-red-100 text-red-800 hover:bg-red-200'\n                        }`}\n                      >\n                        {articulo.activo ? 'Activo' : 'Inactivo'}\n                      </button>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                      <div className=\"flex justify-end space-x-2\">\n                        <button\n                          onClick={() => onEditar(articulo)}\n                          className=\"text-blue-600 hover:text-blue-900 cursor-pointer\"\n                          title=\"Editar art√≠culo\"\n                        >\n                          <i className=\"ri-edit-line\"></i>\n                        </button>\n                        <button\n                          onClick={() => handleEliminar(articulo.id_articulo)}\n                          className=\"text-red-600 hover:text-red-900 cursor-pointer\"\n                          title=\"Eliminar art√≠culo\"\n                        >\n                          <i className=\"ri-delete-bin-line\"></i>\n                        </button>\n                      </div>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n        <NotificationPopup\n          isOpen={notification.isOpen}\n          onClose={hideNotification}\n          title={notification.title}\n          message={notification.message}\n          type={notification.type}\n        />\n      </div>\n\n      <ConfirmationDialog\n        isOpen={confirmation.isOpen}\n        type={confirmation.type}\n        title={confirmation.title}\n        message={confirmation.message}\n        onConfirm={confirmation.onConfirm}\n        onCancel={confirmation.onCancel}\n      />\n    </>\n  );\n}\n","import { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\nimport { useNotification } from '../../../hooks/useNotification';\nimport NotificationPopup from '../../../components/base/NotificationPopup';\n\ninterface Articulo {\n  id_articulo: number;\n  codigo_articulo: string;\n  descripcion_articulo: string;\n  cantidad_articulo: number;\n  costo_articulo: number;\n  ganancia_articulo: number;\n  precio_articulo: number;\n  categoria_id: number;\n  unidad_base_id?: number;\n  activo: boolean;\n  espesor_mm?: number;\n  largo_lamina_mm?: number;\n  ancho_lamina_mm?: number;\n  ancho_tapacanto_mm?: number;\n  grosor_tapacanto_mm?: number;\n  cod_barras?: string;\n  tipo_cod_barras?: number;\n}\n\ninterface Categoria {\n  id_categoria: number;\n  nombre_categoria: string;\n  descripcion_categoria?: string;\n}\n\ninterface UnidadMedida {\n  id: number;\n  nombre: string;\n  simbolo: string;\n  grupo: string;\n}\n\ninterface TipoCodigoBarras {\n  id_tipo_cod_barras: number;\n  descripcion_tipo_cod_barras: string;\n  formato_valido: string | null;\n  activo: boolean;\n}\n\ninterface InventarioFormProps {\n  articulo: Articulo | null;\n  onSave: (data: Partial<Articulo>) => void;\n  onCancel: () => void;\n}\n\nexport default function InventarioForm({\n  articulo,\n  onSave,\n  onCancel,\n}: InventarioFormProps) {\n  const [formData, setFormData] = useState({\n    codigo_articulo: '',\n    descripcion_articulo: '',\n    cantidad_articulo: '0.000',\n    costo_articulo: '0.00',\n    ganancia_articulo: '0.00',\n    categoria_id: 0,\n    unidad_base_id: 10,\n    activo: true,\n    espesor_mm: '',\n    largo_lamina_mm: '',\n    ancho_lamina_mm: '',\n    ancho_tapacanto_mm: '',\n    grosor_tapacanto_mm: '',\n    cod_barras: '',\n    tipo_cod_barras: 0,\n  });\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [precioCalculado, setPrecioCalculado] = useState(0);\n  const [categorias, setCategorias] = useState<Categoria[]>([]);\n  const [unidades, setUnidades] = useState<UnidadMedida[]>([]);\n  const [tiposCodigoBarras, setTiposCodigoBarras] = useState<TipoCodigoBarras[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [categoriaSeleccionada, setCategoriaSeleccionada] = useState<Categoria | null>(null);\n  const [validandoCodigo, setValidandoCodigo] = useState(false);\n  const [codigoValido, setCodigoValido] = useState<boolean | null>(null);\n\n  const { notification, showSuccess, showError, showWarning, hideNotification } = useNotification();\n\n  // cargar categor√≠as, unidades y tipos de c√≥digos de barras\n  useEffect(() => {\n    const cargarDatos = async () => {\n      try {\n        setLoading(true);\n\n        const [categoriasRes, unidadesRes, tiposCodigoRes] = await Promise.all([\n          supabase\n            .from('categorias_inventario')\n            .select('id_categoria, nombre_categoria, descripcion_categoria, activo')\n            .eq('activo', true)\n            .order('nombre_categoria'),\n          supabase\n            .from('unidades_medida')\n            .select('*')\n            .order('grupo, nombre'),\n          supabase\n            .from('tipos_cod_barras')\n            .select('*')\n            .eq('activo', true)\n            .order('descripcion_tipo_cod_barras'),\n        ]);\n\n        if (categoriasRes.error) {\n          console.error('Error cargando categor√≠as de inventario:', categoriasRes.error);\n          throw new Error(\n            `Error cargando categor√≠as de inventario: ${categoriasRes.error.message}`\n          );\n        }\n\n        if (unidadesRes.error) {\n          console.error('Error cargando unidades:', unidadesRes.error);\n          throw new Error(\n            `Error cargando unidades: ${unidadesRes.error.message}`\n          );\n        }\n\n        if (tiposCodigoRes.error) {\n          console.error('Error cargando tipos de c√≥digos de barras:', tiposCodigoRes.error);\n        }\n\n        console.log('Categor√≠as cargadas:', categoriasRes.data);\n        console.log('Tipos de c√≥digos de barras cargados:', tiposCodigoRes.data);\n        setCategorias(categoriasRes.data || []);\n        setUnidades(unidadesRes.data || []);\n        setTiposCodigoBarras(tiposCodigoRes.data || []);\n      } catch (error) {\n        console.error('Error cargando datos:', error);\n        showWarning(\n          'Error cargando datos',\n          error instanceof Error\n            ? error.message\n            : 'Error cargando datos del formulario'\n        );\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    cargarDatos();\n  }, []);\n\n  // cargar datos del art√≠culo cuando cambie la prop\n  useEffect(() => {\n    if (articulo) {\n      setFormData({\n        codigo_articulo: articulo.codigo_articulo,\n        descripcion_articulo: articulo.descripcion_articulo,\n        cantidad_articulo: articulo.cantidad_articulo.toFixed(3),\n        costo_articulo: articulo.costo_articulo.toFixed(2),\n        ganancia_articulo: articulo.ganancia_articulo.toFixed(2),\n        categoria_id: articulo.categoria_id,\n        unidad_base_id: articulo.unidad_base_id || 10,\n        activo: articulo.activo ?? true,\n        espesor_mm: articulo.espesor_mm?.toString() || '',\n        largo_lamina_mm: articulo.largo_lamina_mm?.toString() || '',\n        ancho_lamina_mm: articulo.ancho_lamina_mm?.toString() || '',\n        ancho_tapacanto_mm: articulo.ancho_tapacanto_mm?.toString() || '',\n        grosor_tapacanto_mm: articulo.grosor_tapacanto_mm?.toString() || '',\n        cod_barras: articulo.cod_barras || '',\n        tipo_cod_barras: articulo.tipo_cod_barras || 0,\n      });\n      \n      // Si hay c√≥digo de barras, validarlo\n      if (articulo.cod_barras && articulo.tipo_cod_barras) {\n        validarCodigoBarras(articulo.cod_barras, articulo.tipo_cod_barras);\n      }\n    } else {\n      // Limpiar formulario para nuevo art√≠culo\n      setFormData({\n        codigo_articulo: '',\n        descripcion_articulo: '',\n        cantidad_articulo: '0.000',\n        costo_articulo: '0.00',\n        ganancia_articulo: '0.00',\n        categoria_id: 0,\n        unidad_base_id: 10,\n        activo: true,\n        espesor_mm: '',\n        largo_lamina_mm: '',\n        ancho_lamina_mm: '',\n        ancho_tapacanto_mm: '',\n        grosor_tapacanto_mm: '',\n        cod_barras: '',\n        tipo_cod_barras: 0,\n      });\n      setCodigoValido(null);\n    }\n  }, [articulo]);\n\n  // Detectar cambio de categor√≠a y actualizar categoriaSeleccionada\n  useEffect(() => {\n    if (formData.categoria_id && categorias.length > 0) {\n      const categoria = categorias.find(c => c.id_categoria === formData.categoria_id);\n      setCategoriaSeleccionada(categoria || null);\n    } else {\n      setCategoriaSeleccionada(null);\n    }\n  }, [formData.categoria_id, categorias]);\n\n  // calcular precio autom√°ticamente\n  useEffect(() => {\n    const costo = parseFloat(formData.costo_articulo) || 0;\n    const margen = parseFloat(formData.ganancia_articulo) || 0;\n    \n    // Validar que el margen no sea 100% o mayor (evita divisi√≥n por cero o valores negativos)\n    if (margen >= 100) {\n      setPrecioCalculado(0);\n      return;\n    }\n    \n    // Nueva f√≥rmula: Precio = Costo / (1 - Margen/100)\n    const precio = costo / (1 - margen / 100);\n    setPrecioCalculado(precio);\n  }, [formData.costo_articulo, formData.ganancia_articulo]);\n\n  // Validar c√≥digo de barras cuando cambie\n  useEffect(() => {\n    if (formData.cod_barras && formData.tipo_cod_barras) {\n      const timer = setTimeout(() => {\n        validarCodigoBarras(formData.cod_barras, formData.tipo_cod_barras);\n      }, 500);\n      return () => clearTimeout(timer);\n    } else {\n      setCodigoValido(null);\n    }\n  }, [formData.cod_barras, formData.tipo_cod_barras]);\n\n  const validarCodigoBarras = async (codigo: string, tipoId: number) => {\n    if (!codigo || !tipoId) {\n      setCodigoValido(null);\n      return;\n    }\n\n    setValidandoCodigo(true);\n    try {\n      const tipo = tiposCodigoBarras.find(t => t.id_tipo_cod_barras === tipoId);\n      \n      if (!tipo) {\n        setCodigoValido(null);\n        return;\n      }\n\n      // Si no hay formato v√°lido definido, aceptar cualquier c√≥digo\n      if (!tipo.formato_valido) {\n        setCodigoValido(true);\n        return;\n      }\n\n      // Validar contra la expresi√≥n regular\n      const regex = new RegExp(tipo.formato_valido);\n      const esValido = regex.test(codigo);\n      setCodigoValido(esValido);\n\n      if (!esValido) {\n        setErrors(prev => ({\n          ...prev,\n          cod_barras: `El c√≥digo no cumple con el formato ${tipo.descripcion_tipo_cod_barras}`\n        }));\n      } else {\n        setErrors(prev => {\n          const newErrors = { ...prev };\n          delete newErrors.cod_barras;\n          return newErrors;\n        });\n      }\n    } catch (error) {\n      console.error('Error validando c√≥digo de barras:', error);\n      setCodigoValido(null);\n    } finally {\n      setValidandoCodigo(false);\n    }\n  };\n\n  const detectarTipoAutomatico = async (codigo: string) => {\n    if (!codigo) return;\n\n    console.log('üîç [C√ìDIGO DE BARRAS] Detectando tipo autom√°tico para:', codigo);\n\n    for (const tipo of tiposCodigoBarras) {\n      if (!tipo.formato_valido) continue;\n      \n      try {\n        const regex = new RegExp(tipo.formato_valido);\n        if (regex.test(codigo)) {\n          console.log('‚úÖ [C√ìDIGO DE BARRAS] Tipo detectado:', tipo.descripcion_tipo_cod_barras);\n          setFormData(prev => ({\n            ...prev,\n            tipo_cod_barras: tipo.id_tipo_cod_barras\n          }));\n          showSuccess(\n            'Tipo detectado autom√°ticamente',\n            `${tipo.descripcion_tipo_cod_barras}`\n          );\n          \n          // Validar inmediatamente despu√©s de detectar\n          await validarCodigoBarras(codigo, tipo.id_tipo_cod_barras);\n          return;\n        }\n      } catch (error) {\n        console.error('‚ùå [C√ìDIGO DE BARRAS] Error en regex:', error);\n      }\n    }\n\n    console.log('‚ö†Ô∏è [C√ìDIGO DE BARRAS] No se pudo detectar el tipo autom√°ticamente');\n    showWarning(\n      'Tipo no detectado',\n      'Por favor, seleccione manualmente el tipo de c√≥digo de barras'\n    );\n  };\n\n  const handleChange = (\n    e: React.ChangeEvent<\n      HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement\n    >\n  ) => {\n    const { name, value, type } = e.target;\n    let processedValue: string | number | boolean = value;\n\n    // Procesar valores seg√∫n el tipo\n    if (type === 'checkbox') {\n      processedValue = (e.target as HTMLInputElement).checked;\n    } else if (['categoria_id', 'unidad_base_id', 'tipo_cod_barras'].includes(name)) {\n      processedValue = parseInt(value) || 0;\n    }\n\n    // Validar ganancia entre 0-100\n    if (name === 'ganancia_articulo') {\n      const margen = parseFloat(value);\n      if (margen < 0 || margen >= 100) {\n        setErrors((prev) => ({\n          ...prev,\n          ganancia_articulo: 'El margen debe estar entre 0% y 99.99%',\n        }));\n      } else {\n        setErrors((prev) => ({ ...prev, ganancia_articulo: '' }));\n      }\n    }\n\n    // Si cambia el tipo de c√≥digo de barras y hay un c√≥digo ingresado, validar\n    if (name === 'tipo_cod_barras' && formData.cod_barras) {\n      const tipoId = parseInt(value) || 0;\n      if (tipoId > 0) {\n        validarCodigoBarras(formData.cod_barras, tipoId);\n      }\n    }\n\n    setFormData((prev) => ({\n      ...prev,\n      [name]: processedValue,\n    }));\n\n    // Limpiar error del campo cuando el usuario empiece a escribir\n    if (errors[name]) {\n      setErrors((prev) => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleCodigoBarrasChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const codigo = e.target.value.trim();\n    setFormData(prev => ({\n      ...prev,\n      cod_barras: codigo\n    }));\n\n    // Limpiar validaci√≥n anterior\n    setCodigoValido(null);\n    setErrors(prev => {\n      const newErrors = { ...prev };\n      delete newErrors.cod_barras;\n      return newErrors;\n    });\n\n    // Si no hay c√≥digo, limpiar tipo tambi√©n\n    if (!codigo) {\n      setFormData(prev => ({\n        ...prev,\n        tipo_cod_barras: 0\n      }));\n      return;\n    }\n\n    // Si no hay tipo seleccionado, intentar detectarlo autom√°ticamente\n    if (!formData.tipo_cod_barras) {\n      detectarTipoAutomatico(codigo);\n    }\n  };\n\n  const handleNumericChange = (\n    name: string,\n    value: string,\n    decimals: number\n  ) => {\n    // Permitir solo n√∫meros con decimales espec√≠ficos\n    const regex = new RegExp(`^\\\\d*\\\\.?\\\\d{0,${decimals}}$`);\n    if (regex.test(value) || value === '') {\n      setFormData((prev) => ({\n        ...prev,\n        [name]: value,\n      }));\n    }\n  };\n\n  const validateForm = async () => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData.codigo_articulo.trim()) {\n      newErrors.codigo_articulo = 'El c√≥digo es obligatorio';\n    } else {\n      // Verificar que el c√≥digo no exista (solo para nuevos art√≠culos o si cambi√≥ el c√≥digo)\n      if (!articulo || articulo.codigo_articulo !== formData.codigo_articulo) {\n        try {\n          const { data, error } = await supabase\n            .from('inventario')\n            .select('id_articulo')\n            .eq('codigo_articulo', formData.codigo_articulo.trim())\n            .maybeSingle();\n\n          if (error && error.code !== 'PGRST116') {\n            console.error('Error verificando c√≥digo:', error);\n            newErrors.codigo_articulo = 'Error verificando c√≥digo √∫nico';\n          } else if (data) {\n            newErrors.codigo_articulo = 'Este c√≥digo ya existe';\n          }\n        } catch (error) {\n          console.error('Error verificando c√≥digo:', error);\n          newErrors.codigo_articulo = 'Error de conexi√≥n al verificar c√≥digo';\n        }\n      }\n    }\n\n    if (!formData.descripcion_articulo.trim()) {\n      newErrors.descripcion_articulo = 'La descripci√≥n es obligatoria';\n    }\n\n    const cantidad = parseFloat(formData.cantidad_articulo);\n    if (isNaN(cantidad) || cantidad < 0) {\n      newErrors.cantidad_articulo =\n        'La cantidad debe ser un n√∫mero v√°lido mayor o igual a 0';\n    }\n\n    const costo = parseFloat(formData.costo_articulo);\n    if (isNaN(costo) || costo < 0) {\n      newErrors.costo_articulo =\n        'El costo debe ser un n√∫mero v√°lido mayor o igual a 0';\n    }\n\n    const ganancia = parseFloat(formData.ganancia_articulo);\n    if (isNaN(ganancia) || ganancia < 0 || ganancia >= 100) {\n      newErrors.ganancia_articulo =\n        'El margen debe estar entre 0% y 99.99%';\n    }\n\n    if (formData.categoria_id === 0) {\n      newErrors.categoria_id = 'Debe seleccionar una categor√≠a';\n    }\n\n    if (formData.unidad_base_id === 0) {\n      newErrors.unidad_base_id = 'Debe seleccionar una unidad de medida';\n    }\n\n    // Validar c√≥digo de barras si est√° presente\n    if (formData.cod_barras && formData.cod_barras.trim()) {\n      if (!formData.tipo_cod_barras) {\n        newErrors.tipo_cod_barras = 'Debe seleccionar el tipo de c√≥digo de barras';\n      } else if (codigoValido === false) {\n        const tipo = tiposCodigoBarras.find(t => t.id_tipo_cod_barras === formData.tipo_cod_barras);\n        newErrors.cod_barras = `El c√≥digo no cumple con el formato ${tipo?.descripcion_tipo_cod_barras || 'seleccionado'}`;\n      }\n      \n      // Verificar que el c√≥digo de barras no exista en otro art√≠culo\n      if (!newErrors.cod_barras) {\n        try {\n          const { data, error } = await supabase\n            .from('inventario')\n            .select('id_articulo, codigo_articulo, descripcion_articulo')\n            .eq('cod_barras', formData.cod_barras.trim())\n            .maybeSingle();\n\n          if (error && error.code !== 'PGRST116') {\n            console.error('Error verificando c√≥digo de barras:', error);\n          } else if (data && (!articulo || data.id_articulo !== articulo.id_articulo)) {\n            newErrors.cod_barras = `Este c√≥digo de barras ya est√° asignado al art√≠culo: ${data.codigo_articulo} - ${data.descripcion_articulo}`;\n          }\n        } catch (error) {\n          console.error('Error verificando c√≥digo de barras:', error);\n        }\n      }\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (saving) return;\n\n    // Limpiar errores previos\n    setErrors({});\n\n    const isValid = await validateForm();\n    if (!isValid) {\n      showError(\n        'Formulario incompleto',\n        'Por favor, corrija los errores antes de continuar'\n      );\n      return;\n    }\n\n    try {\n      setSaving(true);\n\n      // ‚úÖ OBTENER TIENDA ACTUAL DEL USUARIO\n      const { data: { user } } = await supabase.auth.getUser();\n      \n      if (!user) {\n        throw new Error('No hay usuario autenticado');\n      }\n\n      // ‚úÖ OBTENER TIENDA ACTUAL\n      const { data: tiendaActual, error: tiendaError } = await supabase\n        .from('usuario_tienda_actual')\n        .select('tienda_id')\n        .eq('usuario_id', user.id)\n        .single();\n\n      if (tiendaError || !tiendaActual?.tienda_id) {\n        console.error('‚ùå [GUARDAR] Error obteniendo tienda actual:', tiendaError);\n        throw new Error('No tienes una tienda asignada. Contacta al administrador.');\n      }\n\n      console.log('‚úÖ [GUARDAR] Tienda actual del usuario:', tiendaActual.tienda_id);\n\n      const dataToSave: any = {\n        codigo_articulo: formData.codigo_articulo.trim(),\n        descripcion_articulo: formData.descripcion_articulo.trim(),\n        cantidad_articulo: parseFloat(formData.cantidad_articulo),\n        costo_articulo: parseFloat(formData.costo_articulo),\n        ganancia_articulo: parseFloat(formData.ganancia_articulo),\n        categoria_id: formData.categoria_id,\n        unidad_base_id: formData.unidad_base_id,\n        activo: formData.activo,\n        cod_barras: formData.cod_barras && formData.cod_barras.trim() ? formData.cod_barras.trim() : null,\n        tipo_cod_barras: formData.cod_barras && formData.cod_barras.trim() && formData.tipo_cod_barras ? formData.tipo_cod_barras : null,\n        tienda_id: tiendaActual.tienda_id // ‚úÖ AGREGAR TIENDA_ID\n      };\n\n      console.log('üíæ [GUARDAR] Datos del c√≥digo de barras:', {\n        cod_barras: dataToSave.cod_barras,\n        tipo_cod_barras: dataToSave.tipo_cod_barras,\n        tipo_nombre: tiposCodigoBarras.find(t => t.id_tipo_cod_barras === dataToSave.tipo_cod_barras)?.descripcion_tipo_cod_barras\n      });\n\n      console.log('üíæ [GUARDAR] Tienda asignada al art√≠culo:', dataToSave.tienda_id);\n\n      // Si la categor√≠a es LAMINAS, agregar los campos de medidas\n      if (categoriaSeleccionada?.nombre_categoria === 'LAMINAS') {\n        dataToSave.espesor_mm = formData.espesor_mm ? parseFloat(formData.espesor_mm) : null;\n        dataToSave.largo_lamina_mm = formData.largo_lamina_mm ? parseFloat(formData.largo_lamina_mm) : null;\n        dataToSave.ancho_lamina_mm = formData.ancho_lamina_mm ? parseFloat(formData.ancho_lamina_mm) : null;\n        // Limpiar campos de tapacantos\n        dataToSave.ancho_tapacanto_mm = null;\n        dataToSave.grosor_tapacanto_mm = null;\n      } \n      // Si la categor√≠a es TAPACANTOS, agregar los campos de medidas de tapacantos\n      else if (categoriaSeleccionada?.nombre_categoria === 'TAPACANTOS') {\n        dataToSave.ancho_tapacanto_mm = formData.ancho_tapacanto_mm ? parseFloat(formData.ancho_tapacanto_mm) : null;\n        dataToSave.grosor_tapacanto_mm = formData.grosor_tapacanto_mm ? parseFloat(formData.grosor_tapacanto_mm) : null;\n        // Limpiar campos de l√°minas\n        dataToSave.espesor_mm = null;\n        dataToSave.largo_lamina_mm = null;\n        dataToSave.ancho_lamina_mm = null;\n      } \n      else {\n        // Si no es l√°mina ni tapacanto, asegurar que todos los campos sean null\n        dataToSave.espesor_mm = null;\n        dataToSave.largo_lamina_mm = null;\n        dataToSave.ancho_lamina_mm = null;\n        dataToSave.ancho_tapacanto_mm = null;\n        dataToSave.grosor_tapacanto_mm = null;\n      }\n\n      let result;\n\n      if (articulo) {\n        // Actualizar art√≠culo existente\n        result = await supabase\n          .from('inventario')\n          .update(dataToSave)\n          .eq('id_articulo', articulo.id_articulo)\n          .select();\n      } else {\n        // Crear nuevo art√≠culo\n        result = await supabase\n          .from('inventario')\n          .insert([dataToSave])\n          .select();\n      }\n\n      if (result.error) {\n        console.error('‚ùå [GUARDAR] Error en operaci√≥n:', result.error);\n        throw new Error(result.error.message);\n      }\n\n      console.log('‚úÖ [GUARDAR] Art√≠culo guardado exitosamente:', result.data);\n\n      showSuccess(\n        articulo ? 'Art√≠culo actualizado' : 'Art√≠culo creado',\n        `El art√≠culo ${dataToSave.cod_barras ? 'con c√≥digo de barras ' + dataToSave.cod_barras : ''} ha sido ${articulo ? 'actualizado' : 'creado'} exitosamente`\n      );\n\n      onSave(dataToSave);\n    } catch (error: any) {\n      console.error('‚ùå [GUARDAR] Error guardando art√≠culo:', error);\n\n      let errorMessage = 'Error al guardar el art√≠culo. Intente nuevamente.';\n\n      if (error.message) {\n        if (error.message.includes('duplicate key')) {\n          if (error.message.includes('cod_barras')) {\n            errorMessage = 'El c√≥digo de barras ya existe en otro art√≠culo.';\n          } else {\n            errorMessage = 'El c√≥digo del art√≠culo ya existe.';\n          }\n        } else if (error.message.includes('connection')) {\n          errorMessage = 'Error de conexi√≥n. Verifique su conexi√≥n a internet.';\n        } else if (error.message.includes('timeout')) {\n          errorMessage = 'La operaci√≥n tard√≥ demasiado. Intente nuevamente.';\n        } else if (error.message.includes('categoria_inventario_id')) {\n          errorMessage = 'Error con la categor√≠a seleccionada. Intente nuevamente.';\n        } else if (error.message.includes('tienda asignada')) {\n          errorMessage = error.message; // Mostrar el mensaje personalizado de tienda\n        } else if (error.message.includes('row-level security')) {\n          errorMessage = 'No tienes permisos para realizar esta operaci√≥n. Verifica que tengas una tienda asignada.';\n        }\n      }\n\n      showError('Error al guardar', errorMessage);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const formatCurrency = (value: number) => {\n    return new Intl.NumberFormat('es-CR', {\n      style: 'currency',\n      currency: 'CRC',\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2,\n    }).format(value);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n        <div className=\"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full\">\n          <div className=\"flex flex-col items-center justify-center space-y-4\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n            <div className=\"text-center\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\n                Cargando datos\n              </h3>\n              <p className=\"text-sm text-gray-600\">\n                Conectando con la base de datos...\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const getUnidadesPorGrupo = () => {\n    const grupos: { [key: string]: UnidadMedida[] } = {};\n    unidades.forEach((unidad) => {\n      if (!grupos[unidad.grupo]) {\n        grupos[unidad.grupo] = [];\n      }\n      grupos[unidad.grupo].push(unidad);\n    });\n    return grupos;\n  };\n\n  const unidadesPorGrupo = getUnidadesPorGrupo();\n\n  // Verificar si la categor√≠a seleccionada es LAMINAS\n  const esLamina = categoriaSeleccionada?.nombre_categoria === 'LAMINAS';\n  // Verificar si la categor√≠a seleccionada es TAPACANTOS\n  const esTapacanto = categoriaSeleccionada?.nombre_categoria === 'TAPACANTOS';\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[95vh] overflow-y-auto\">\n        <div className=\"p-8\">\n          <div className=\"flex justify-between items-center mb-8\">\n            <h2 className=\"text-2xl font-bold text-gray-900\">\n              {articulo ? 'Editar Art√≠culo' : 'Nuevo Art√≠culo'}\n            </h2>\n            <button\n              onClick={onCancel}\n              className=\"text-gray-400 hover:text-gray-600 transition-colors p-2 hover:bg-gray-100 rounded-lg cursor-pointer\"\n            >\n              <i className=\"ri-close-line text-2xl\"></i>\n            </button>\n          </div>\n\n          {errors.general && (\n            <div className=\"mb-6 p-4 bg-red-50 border border-red-200 text-red-700 rounded-lg\">\n              <i className=\"ri-error-warning-line mr-2\"></i>\n              {errors.general}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-8\">\n            {/* Informaci√≥n b√°sica */}\n            <div className=\"bg-gray-50 rounded-lg p-6\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\n                Informaci√≥n B√°sica\n              </h3>\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                {/* C√≥digo */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    C√≥digo del Art√≠culo *\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"codigo_articulo\"\n                    value={formData.codigo_articulo}\n                    onChange={handleChange}\n                    className={`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all ${\n                      errors.codigo_articulo\n                        ? 'border-red-500 bg-red-50'\n                        : 'border-gray-300'\n                    }`}\n                    placeholder=\"Ej: MAT-001\"\n                  />\n                  {errors.codigo_articulo && (\n                    <p className=\"mt-2 text-sm text-red-600 flex items-center\">\n                      <i className=\"ri-error-warning-line mr-1\"></i>\n                      {errors.codigo_articulo}\n                    </p>\n                  )}\n                </div>\n\n                {/* Categor√≠a */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Categor√≠a *\n                  </label>\n                  <div className=\"relative\">\n                    <select\n                      name=\"categoria_id\"\n                      value={formData.categoria_id}\n                      onChange={handleChange}\n                      className={`w-full px-4 py-3 pr-10 border rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all appearance-none cursor-pointer ${\n                        errors.categoria_id\n                          ? 'border-red-500 bg-red-50'\n                          : 'border-gray-300'\n                      }`}\n                    >\n                      <option value={0}>Seleccionar categor√≠a</option>\n                      {categorias.map((categoria) => (\n                        <option key={categoria.id_categoria} value={categoria.id_categoria}>\n                          {categoria.nombre_categoria}\n                        </option>\n                      ))}\n                    </select>\n                    <div className=\"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none\">\n                      <i className=\"ri-arrow-down-s-line text-gray-400 text-lg\"></i>\n                    </div>\n                  </div>\n                  {errors.categoria_id && (\n                    <p className=\"mt-2 text-sm text-red-600 flex items-center\">\n                      <i className=\"ri-error-warning-line mr-1\"></i>\n                      {errors.categoria_id}\n                    </p>\n                  )}\n                </div>\n              </div>\n\n              {/* Descripci√≥n */}\n              <div className=\"mt-6\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Descripci√≥n *\n                </label>\n                <textarea\n                  name=\"descripcion_articulo\"\n                  value={formData.descripcion_articulo}\n                  onChange={handleChange}\n                  rows={3}\n                  className={`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all resize-none ${\n                    errors.descripcion_articulo\n                      ? 'border-red-500 bg-red-50'\n                      : 'border-gray-300'\n                  }`}\n                  placeholder=\"Descripci√≥n detallada del art√≠culo\"\n                />\n                {errors.descripcion_articulo && (\n                  <p className=\"mt-2 text-sm text-red-600 flex items-center\">\n                    <i className=\"ri-error-warning-line mr-1\"></i>\n                    {errors.descripcion_articulo}\n                  </p>\n                )}\n              </div>\n            </div>\n\n            {/* C√≥digo de Barras */}\n            <div className=\"bg-indigo-50 rounded-lg p-6 border-2 border-indigo-200\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n                <i className=\"ri-barcode-line text-indigo-600 mr-2 text-xl\"></i>\n                C√≥digo de Barras (Opcional)\n              </h3>\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                {/* Tipo de c√≥digo de barras */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Tipo de C√≥digo\n                    {formData.cod_barras && formData.cod_barras.trim() && (\n                      <span className=\"text-red-500 ml-1\">*</span>\n                    )}\n                  </label>\n                  <div className=\"relative\">\n                    <select\n                      name=\"tipo_cod_barras\"\n                      value={formData.tipo_cod_barras}\n                      onChange={handleChange}\n                      className={`w-full px-4 py-3 pr-10 border rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all appearance-none cursor-pointer ${\n                        errors.tipo_cod_barras\n                          ? 'border-red-500 bg-red-50'\n                          : formData.tipo_cod_barras > 0\n                          ? 'border-indigo-500 bg-indigo-50'\n                          : 'border-gray-300'\n                      }`}\n                      disabled={!formData.cod_barras || !formData.cod_barras.trim()}\n                    >\n                      <option value={0}>\n                        {formData.cod_barras && formData.cod_barras.trim() \n                          ? 'Seleccionar tipo' \n                          : 'Ingrese primero el c√≥digo'}\n                      </option>\n                      {tiposCodigoBarras.map((tipo) => (\n                        <option key={tipo.id_tipo_cod_barras} value={tipo.id_tipo_cod_barras}>\n                          {tipo.descripcion_tipo_cod_barras}\n                        </option>\n                      ))}\n                    </select>\n                    <div className=\"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none\">\n                      {formData.tipo_cod_barras > 0 ? (\n                        <i className=\"ri-check-line text-indigo-600 text-lg\"></i>\n                      ) : (\n                        <i className=\"ri-arrow-down-s-line text-gray-400 text-lg\"></i>\n                      )}\n                    </div>\n                  </div>\n                  {errors.tipo_cod_barras && (\n                    <p className=\"mt-2 text-sm text-red-600 flex items-center\">\n                      <i className=\"ri-error-warning-line mr-1\"></i>\n                      {errors.tipo_cod_barras}\n                    </p>\n                  )}\n                  {formData.tipo_cod_barras > 0 && (\n                    <p className=\"mt-2 text-xs text-indigo-700 flex items-center\">\n                      <i className=\"ri-information-line mr-1\"></i>\n                      {tiposCodigoBarras.find(t => t.id_tipo_cod_barras === formData.tipo_cod_barras)?.descripcion_tipo_cod_barras}\n                    </p>\n                  )}\n                </div>\n\n                {/* C√≥digo de barras */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    C√≥digo de Barras\n                  </label>\n                  <div className=\"relative\">\n                    <input\n                      type=\"text\"\n                      name=\"cod_barras\"\n                      value={formData.cod_barras}\n                      onChange={handleCodigoBarrasChange}\n                      className={`w-full px-4 py-3 pr-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all ${\n                        errors.cod_barras\n                          ? 'border-red-500 bg-red-50'\n                          : codigoValido === true\n                          ? 'border-green-500 bg-green-50'\n                          : codigoValido === false\n                          ? 'border-red-500 bg-red-50'\n                          : 'border-gray-300'\n                      }`}\n                      placeholder=\"Ingrese el c√≥digo de barras\"\n                    />\n                    <div className=\"absolute inset-y-0 right-0 flex items-center pr-3\">\n                      {validandoCodigo ? (\n                        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-indigo-600\"></div>\n                      ) : codigoValido === true ? (\n                        <i className=\"ri-check-line text-green-600 text-xl\"></i>\n                      ) : codigoValido === false ? (\n                        <i className=\"ri-close-line text-red-600 text-xl\"></i>\n                      ) : formData.cod_barras && formData.cod_barras.trim() ? (\n                        <i className=\"ri-barcode-line text-indigo-600 text-xl\"></i>\n                      ) : null}\n                    </div>\n                  </div>\n                  {errors.cod_barras && (\n                    <p className=\"mt-2 text-sm text-red-600 flex items-center\">\n                      <i className=\"ri-error-warning-line mr-1\"></i>\n                      {errors.cod_barras}\n                    </p>\n                  )}\n                  {codigoValido === true && (\n                    <p className=\"mt-2 text-sm text-green-600 flex items-center font-medium\">\n                      <i className=\"ri-check-line mr-1\"></i>\n                      C√≥digo v√°lido para {tiposCodigoBarras.find(t => t.id_tipo_cod_barras === formData.tipo_cod_barras)?.descripcion_tipo_cod_barras}\n                    </p>\n                  )}\n                  {codigoValido === false && !errors.cod_barras && (\n                    <p className=\"mt-2 text-sm text-red-600 flex items-center\">\n                      <i className=\"ri-close-line mr-1\"></i>\n                      El c√≥digo no cumple con el formato esperado\n                    </p>\n                  )}\n                </div>\n              </div>\n              <div className=\"mt-4 p-3 bg-indigo-100 rounded-lg border border-indigo-300\">\n                <p className=\"text-xs text-indigo-800 flex items-start\">\n                  <i className=\"ri-lightbulb-line mr-2 mt-0.5 flex-shrink-0\"></i>\n                  <span>\n                    <strong>Detecci√≥n autom√°tica:</strong> Ingrese el c√≥digo de barras y el sistema intentar√° detectar autom√°ticamente el tipo. Tambi√©n puede seleccionar el tipo manualmente si lo prefiere.\n                  </span>\n                </p>\n              </div>\n            </div>\n\n            {/* Medidas de L√°mina - Solo si la categor√≠a es LAMINAS */}\n            {esLamina && (\n              <div className=\"bg-amber-50 rounded-lg p-6 border-2 border-amber-200\">\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n                  <i className=\"ri-ruler-line text-amber-600 mr-2\"></i>\n                  Medidas de L√°mina\n                </h3>\n                <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n                  {/* Espesor */}\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                      Espesor (mm)\n                    </label>\n                    <div className=\"relative\">\n                      <input\n                        type=\"text\"\n                        name=\"espesor_mm\"\n                        value={formData.espesor_mm}\n                        onChange={(e) =>\n                          handleNumericChange('espesor_mm', e.target.value, 2)\n                        }\n                        className=\"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 transition-all text-right\"\n                        placeholder=\"0.00\"\n                      />\n                      <div className=\"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none\">\n                        <span className=\"text-gray-500 text-sm font-medium\">mm</span>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Largo */}\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                      Largo (mm)\n                    </label>\n                    <div className=\"relative\">\n                      <input\n                        type=\"text\"\n                        name=\"largo_lamina_mm\"\n                        value={formData.largo_lamina_mm}\n                        onChange={(e) =>\n                          handleNumericChange('largo_lamina_mm', e.target.value, 2)\n                        }\n                        className=\"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 transition-all text-right\"\n                        placeholder=\"0.00\"\n                      />\n                      <div className=\"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none\">\n                        <span className=\"text-gray-500 text-sm font-medium\">mm</span>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Ancho */}\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                      Ancho (mm)\n                    </label>\n                    <div className=\"relative\">\n                      <input\n                        type=\"text\"\n                        name=\"ancho_lamina_mm\"\n                        value={formData.ancho_lamina_mm}\n                        onChange={(e) =>\n                          handleNumericChange('ancho_lamina_mm', e.target.value, 2)\n                        }\n                        className=\"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 transition-all text-right\"\n                        placeholder=\"0.00\"\n                      />\n                      <div className=\"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none\">\n                        <span className=\"text-gray-500 text-sm font-medium\">mm</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <p className=\"text-xs text-amber-700 mt-3 flex items-center\">\n                  <i className=\"ri-information-line mr-1\"></i>\n                  Estos campos son espec√≠ficos para l√°minas y se utilizan en el optimizador de cortes\n                </p>\n              </div>\n            )}\n\n            {/* Medidas de Tapacanto - Solo si la categor√≠a es TAPACANTOS */}\n            {esTapacanto && (\n              <div className=\"bg-purple-50 rounded-lg p-6 border-2 border-purple-200\">\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n                  <i className=\"ri-ruler-2-line text-purple-600 mr-2\"></i>\n                  Medidas de Tapacanto\n                </h3>\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                  {/* Ancho */}\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                      Ancho (mm)\n                    </label>\n                    <div className=\"relative\">\n                      <input\n                        type=\"text\"\n                        name=\"ancho_tapacanto_mm\"\n                        value={formData.ancho_tapacanto_mm}\n                        onChange={(e) =>\n                          handleNumericChange('ancho_tapacanto_mm', e.target.value, 2)\n                        }\n                        className=\"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 transition-all text-right\"\n                        placeholder=\"0.00\"\n                      />\n                      <div className=\"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none\">\n                        <span className=\"text-gray-500 text-sm font-medium\">mm</span>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Grosor */}\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                      Grosor (mm)\n                    </label>\n                    <div className=\"relative\">\n                      <input\n                        type=\"text\"\n                        name=\"grosor_tapacanto_mm\"\n                        value={formData.grosor_tapacanto_mm}\n                        onChange={(e) =>\n                          handleNumericChange('grosor_tapacanto_mm', e.target.value, 2)\n                        }\n                        className=\"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 transition-all text-right\"\n                        placeholder=\"0.00\"\n                      />\n                      <div className=\"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none\">\n                        <span className=\"text-gray-500 text-sm font-medium\">mm</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <p className=\"text-xs text-purple-700 mt-3 flex items-center\">\n                  <i className=\"ri-information-line mr-1\"></i>\n                  Estos campos son espec√≠ficos para tapacantos y se utilizar√°n en el optimizador de cortes\n                </p>\n              </div>\n            )}\n\n            {/* Unidad de medida */}\n            <div className=\"bg-blue-50 rounded-lg p-6\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\n                Unidad de Medida\n              </h3>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Unidad Base *\n                </label>\n                <div className=\"relative\">\n                  <select\n                    name=\"unidad_base_id\"\n                    value={formData.unidad_base_id}\n                    onChange={handleChange}\n                    className={`w-full px-4 py-3 pr-10 border rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all appearance-none cursor-pointer ${\n                      errors.unidad_base_id\n                        ? 'border-red-500 bg-red-50'\n                        : 'border-gray-300'\n                    }`}\n                  >\n                    <option value={0}>Seleccionar unidad</option>\n                    {Object.entries(unidadesPorGrupo).map(\n                      ([grupo, unidadesGrupo]) => (\n                        <optgroup\n                          key={grupo}\n                          label={\n                            grupo.charAt(0).toUpperCase() + grupo.slice(1)\n                          }\n                        >\n                          {unidadesGrupo.map((unidad) => (\n                            <option key={unidad.id} value={unidad.id}>\n                              {unidad.nombre} ({unidad.simbolo})\n                            </option>\n                          ))}\n                        </optgroup>\n                      )\n                    )}\n                  </select>\n                  <div className=\"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none\">\n                    <i className=\"ri-arrow-down-s-line text-gray-400 text-lg\"></i>\n                  </div>\n                </div>\n                {errors.unidad_base_id && (\n                  <p className=\"mt-2 text-sm text-red-600 flex items-center\">\n                    <i className=\"ri-error-warning-line mr-1\"></i>\n                    {errors.unidad_base_id}\n                  </p>\n                )}\n              </div>\n            </div>\n\n            {/* Informaci√≥n financiera */}\n            <div className=\"bg-green-50 rounded-lg p-6\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\n                Informaci√≥n Financiera\n              </h3>\n              <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n                {/* Cantidad */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Cantidad en Stock\n                  </label>\n                  <div className=\"relative\">\n                    <input\n                      type=\"text\"\n                      name=\"cantidad_articulo\"\n                      value={formData.cantidad_articulo}\n                      onChange={(e) =>\n                        handleNumericChange(\n                          'cantidad_articulo',\n                          e.target.value,\n                          3\n                        )\n                      }\n                      className={`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all text-right ${\n                        errors.cantidad_articulo\n                          ? 'border-red-500 bg-red-50'\n                          : 'border-gray-300'\n                      }`}\n                      placeholder=\"0.000\"\n                    />\n                    <div className=\"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none\">\n                      <i className=\"ri-archive-line text-gray-400\"></i>\n                    </div>\n                  </div>\n                  {errors.cantidad_articulo && (\n                    <p className=\"mt-2 text-sm text-red-600 flex items-center\">\n                      <i className=\"ri-error-warning-line mr-1\"></i>\n                      {errors.cantidad_articulo}\n                    </p>\n                  )}\n                </div>\n\n                {/* Costo */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Costo Unitario\n                  </label>\n                  <div className=\"relative\">\n                    <input\n                      type=\"text\"\n                      name=\"costo_articulo\"\n                      value={formData.costo_articulo}\n                      onChange={(e) =>\n                        handleNumericChange(\n                          'costo_articulo',\n                          e.target.value,\n                          2\n                        )\n                      }\n                      className={`w-full px-4 py-3 pl-8 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all text-right ${\n                        errors.costo_articulo\n                          ? 'border-red-500 bg-red-50'\n                          : 'border-gray-300'\n                      }`}\n                      placeholder=\"0.00\"\n                    />\n                    <div className=\"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none\">\n                      <span className=\"text-gray-500 font-medium\">‚Ç°</span>\n                    </div>\n                  </div>\n                  {errors.costo_articulo && (\n                    <p className=\"mt-2 text-sm text-red-600 flex items-center\">\n                      <i className=\"ri-error-warning-line mr-1\"></i>\n                      {errors.costo_articulo}\n                    </p>\n                  )}\n                </div>\n\n                {/* Ganancia */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Margen sobre Precio (%)\n                  </label>\n                  <div className=\"relative\">\n                    <input\n                      type=\"text\"\n                      name=\"ganancia_articulo\"\n                      value={formData.ganancia_articulo}\n                      onChange={(e) =>\n                        handleNumericChange(\n                          'ganancia_articulo',\n                          e.target.value,\n                          2\n                        )\n                      }\n                      className={`w-full px-4 py-3 pr-8 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all text-right ${\n                        errors.ganancia_articulo\n                          ? 'border-red-500 bg-red-50'\n                          : 'border-gray-300'\n                      }`}\n                      placeholder=\"0.00\"\n                    />\n                    <div className=\"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none\">\n                      <span className=\"text-gray-500 font-medium\">%</span>\n                    </div>\n                  </div>\n                  {errors.ganancia_articulo && (\n                    <p className=\"mt-2 text-sm text-red-600 flex items-center\">\n                      <i className=\"ri-error-warning-line mr-1\"></i>\n                      {errors.ganancia_articulo}\n                    </p>\n                  )}\n                  <p className=\"text-xs text-gray-500 mt-1 flex items-center\">\n                    <i className=\"ri-information-line mr-1\"></i>\n                    Porcentaje de utilidad respecto al precio de venta\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            {/* Estado */}\n            <div className=\"flex items-center p-4 bg-gray-50 rounded-lg\">\n              <input\n                type=\"checkbox\"\n                name=\"activo\"\n                id=\"activo\"\n                checked={formData.activo}\n                onChange={handleChange}\n                className=\"h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer\"\n              />\n              <label\n                htmlFor=\"activo\"\n                className=\"ml-3 block text-sm font-medium text-gray-900 cursor-pointer\"\n              >\n                <i className=\"ri-check-line mr-1\"></i>\n                Art√≠culo activo\n              </label>\n            </div>\n\n            {/* Precio calculado */}\n            <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center\">\n                  <i className=\"ri-calculator-line text-blue-600 text-xl mr-2\"></i>\n                  <span className=\"text-sm font-medium text-blue-900\">\n                    Precio de Venta Calculado:\n                  </span>\n                </div>\n                <span className=\"text-2xl font-bold text-blue-900\">\n                  {precioCalculado > 0 ? formatCurrency(precioCalculado) : '‚Ç°0.00'}\n                </span>\n              </div>\n              <div className=\"mt-3 space-y-1\">\n                <p className=\"text-xs text-blue-700 flex items-center\">\n                  <i className=\"ri-information-line mr-1\"></i>\n                  Precio = Costo / (1 - Margen/100)\n                </p>\n                {parseFloat(formData.ganancia_articulo) >= 100 && (\n                  <p className=\"text-xs text-red-600 flex items-center font-medium\">\n                    <i className=\"ri-error-warning-line mr-1\"></i>\n                    El margen debe ser menor a 100% para calcular el precio\n                  </p>\n                )}\n                {precioCalculado > 0 && parseFloat(formData.ganancia_articulo) > 0 && (\n                  <p className=\"text-xs text-green-700 flex items-center\">\n                    <i className=\"ri-check-line mr-1\"></i>\n                    Utilidad: {formatCurrency(precioCalculado - parseFloat(formData.costo_articulo || '0'))} ({formData.ganancia_articulo}% del precio)\n                  </p>\n                )}\n              </div>\n            </div>\n\n            {/* Botones */}\n            <div className=\"flex justify-end gap-4 pt-6 border-t border-gray-200\">\n              <button\n                type=\"button\"\n                onClick={onCancel}\n                disabled={saving}\n                className=\"px-6 py-3 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors whitespace-nowrap disabled:opacity-50 flex items-center cursor-pointer\"\n              >\n                <i className=\"ri-close-line mr-2\"></i>\n                Cancelar\n              </button>\n              <button\n                type=\"submit\"\n                disabled={saving}\n                className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap disabled:opacity-50 flex items-center cursor-pointer\"\n              >\n                {saving && (\n                  <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\n                )}\n                <i className={`${saving ? 'hidden' : 'ri-save-line'} mr-2`}></i>\n                {articulo ? 'Actualizar' : 'Crear'} Art√≠culo\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n      <NotificationPopup\n        isOpen={notification.isOpen}\n        onClose={hideNotification}\n        title={notification.title}\n        message={notification.message}\n        type={notification.type}\n      />\n    </div>\n  );\n}\n","import { useState, useRef, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\nimport * as XLSX from 'xlsx';\n\ninterface FilaImportacion {\n  fila: number;\n  codigo_articulo: string;\n  descripcion_articulo: string;\n  cantidad_articulo: string;\n  costo_articulo: string;\n  ganancia_articulo: string;\n  categoria: string;\n  unidad_base: string;\n  activo: string;\n  errores: string[];\n  advertencias: string[];\n  estado: 'valido' | 'error' | 'advertencia';\n}\n\ninterface ResultadoImportacion {\n  creados: number;\n  actualizados: number;\n  errores: number;\n  detalles: string[];\n}\n\nexport default function ImportarInventario() {\n  const [archivo, setArchivo] = useState<File | null>(null);\n  const [vistaPrevia, setVistaPrevia] = useState<FilaImportacion[]>([]);\n  const [mostrarVistaPrevia, setMostrarVistaPrevia] = useState(false);\n  const [procesando, setProcesando] = useState(false);\n  const [resultado, setResultado] = useState<ResultadoImportacion | null>(null);\n  const [categorias, setCategorias] = useState<any[]>([]);\n  const [unidades, setUnidades] = useState<any[]>([]);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Cargar datos de referencia al montar el componente\n  useEffect(() => {\n    cargarDatosReferencia();\n  }, []);\n\n  const cargarDatosReferencia = async () => {\n    try {\n      // Cargar categor√≠as de inventario (NO de productos)\n      const { data: categoriasData, error: categoriasError } = await supabase\n        .from('categorias_inventario')\n        .select('id_categoria, nombre_categoria')\n        .eq('activo', true)\n        .order('nombre_categoria');\n\n      if (categoriasError) {\n        console.error('Error cargando categor√≠as de inventario:', categoriasError);\n        // Usar categor√≠as por defecto si hay error\n        setCategorias([\n          { id_categoria: 1, nombre_categoria: 'ETIQUETAS' },\n          { id_categoria: 2, nombre_categoria: 'EMBALAJE' },\n          { id_categoria: 3, nombre_categoria: 'MAQUINA' },\n          { id_categoria: 4, nombre_categoria: 'HH' },\n          { id_categoria: 5, nombre_categoria: 'DEDICADOS' },\n          { id_categoria: 6, nombre_categoria: 'HABLADORES' },\n          { id_categoria: 7, nombre_categoria: 'GENERAL' }\n        ]);\n      } else {\n        setCategorias(categoriasData || []);\n      }\n\n      // Cargar unidades reales de Supabase\n      const { data: unidadesData, error: unidadesError } = await supabase\n        .from('unidades_medida')\n        .select('id, nombre')\n        .order('nombre');\n\n      if (unidadesError) {\n        console.error('Error cargando unidades:', unidadesError);\n        // Usar unidades por defecto si hay error\n        setUnidades([\n          { id: 1, nombre: 'Unidad' },\n          { id: 2, nombre: 'Metros' },\n          { id: 3, nombre: 'Litros' },\n          { id: 4, nombre: 'Kilogramos' },\n          { id: 5, nombre: 'Cent√≠metros' },\n          { id: 6, nombre: 'Mil√≠metros' },\n          { id: 7, nombre: 'Gramos' },\n          { id: 8, nombre: 'Libras' },\n          { id: 9, nombre: 'Mililitros' },\n          { id: 10, nombre: 'Galones' },\n          { id: 11, nombre: 'Segundos' },\n          { id: 12, nombre: 'Minutos' },\n          { id: 13, nombre: 'Horas' },\n          { id: 14, nombre: 'Piezas' },\n          { id: 15, nombre: 'Cajas' },\n          { id: 16, nombre: 'Paquetes' },\n          { id: 17, nombre: 'Rollos' },\n          { id: 18, nombre: 'Hojas' },\n          { id: 19, nombre: 'Pares' },\n          { id: 20, nombre: 'Juegos' }\n        ]);\n      } else {\n        setUnidades(unidadesData || []);\n      }\n    } catch (error) {\n      console.error('Error general cargando datos:', error);\n    }\n  };\n\n  const descargarPlantillaExcel = () => {\n    // Datos de ejemplo para la plantilla\n    const datosEjemplo = [\n      {\n        codigo_articulo: 'ART001',\n        descripcion_articulo: 'Tornillo Phillips 6x25mm',\n        cantidad_articulo: 500.000,\n        costo_articulo: 0.1500,\n        ganancia_articulo: 35.00,\n        categoria: 'Ferreter√≠a',\n        unidad_base: 'Unidad',\n        activo: 'SI'\n      },\n      {\n        codigo_articulo: 'ART002',\n        descripcion_articulo: 'Cable el√©ctrico 12 AWG',\n        cantidad_articulo: 100.500,\n        costo_articulo: 2.7500,\n        ganancia_articulo: 28.50,\n        categoria: 'El√©ctricos',\n        unidad_base: 'Metros',\n        activo: 'SI'\n      },\n      {\n        codigo_articulo: 'ART003',\n        descripcion_articulo: 'Pintura acr√≠lica blanca',\n        cantidad_articulo: 25.000,\n        costo_articulo: 15.2500,\n        ganancia_articulo: 42.00,\n        categoria: 'Pinturas',\n        unidad_base: 'Litros',\n        activo: 'NO'\n      }\n    ];\n\n    // Crear hoja de instrucciones\n    const instrucciones = [\n      ['INSTRUCCIONES PARA IMPORTAR INVENTARIO'],\n      [''],\n      ['1. CAMPOS OBLIGATORIOS:'],\n      ['   - codigo_articulo: C√≥digo √∫nico del art√≠culo (sin espacios)'],\n      ['   - descripcion_articulo: Nombre descriptivo del producto'],\n      ['   - cantidad_articulo: Cantidad en stock (n√∫mero decimal)'],\n      ['   - costo_articulo: Precio de costo (n√∫mero decimal)'],\n      [''],\n      ['2. CAMPOS OPCIONALES:'],\n      ['   - ganancia_articulo: Porcentaje de ganancia (0-100)'],\n      ['   - categoria: Nombre de la categor√≠a (se crea si no existe)'],\n      ['   - unidad_base: Unidad de medida (ver lista abajo)'],\n      ['   - activo: Estado del art√≠culo (SI/NO, TRUE/FALSE, 1/0)'],\n      [''],\n      ['3. UNIDADES DE MEDIDA DISPONIBLES:'],\n      ['   - Unidad, Mil√≠metros, Cent√≠metros, Metros'],\n      ['   - Gramos, Kilogramos, Libras'],\n      ['   - Mililitros, Litros, Galones'],\n      ['   - Segundos, Minutos, Horas'],\n      [''],\n      ['4. FORMATO DE N√öMEROS:'],\n      ['   - Use punto (.) como separador decimal'],\n      ['   - Cantidad: hasta 3 decimales (ej: 100.500)'],\n      ['   - Costo: hasta 4 decimales (ej: 15.2500)'],\n      ['   - Ganancia: hasta 2 decimales sin % (ej: 35.00)'],\n      [''],\n      ['5. NOTAS IMPORTANTES:'],\n      ['   - El precio de venta se calcula autom√°ticamente'],\n      ['   - Los c√≥digos deben ser √∫nicos'],\n      ['   - M√°ximo 1000 registros por importaci√≥n'],\n      ['   - Formatos soportados: .xlsx, .csv'],\n      [''],\n      ['IMPORTANTE: Use la hoja \"Datos\" para ingresar su informaci√≥n']\n    ];\n\n    // Crear workbook\n    const wb = XLSX.utils.book_new();\n\n    // Hoja de instrucciones\n    const wsInstrucciones = XLSX.utils.aoa_to_sheet(instrucciones);\n    XLSX.utils.book_append_sheet(wb, wsInstrucciones, 'Instrucciones');\n\n    // Hoja de datos con ejemplos\n    const wsDatos = XLSX.utils.json_to_sheet(datosEjemplo);\n    XLSX.utils.book_append_sheet(wb, wsDatos, 'Datos');\n\n    // Configurar anchos de columna para la hoja de datos\n    const colWidths = [\n      { wch: 15 }, // codigo_articulo\n      { wch: 40 }, // descripcion_articulo\n      { wch: 15 }, // cantidad_articulo\n      { wch: 15 }, // costo_articulo\n      { wch: 15 }, // ganancia_articulo\n      { wch: 15 }, // categoria\n      { wch: 15 }, // unidad_base\n      { wch: 10 }  // activo\n    ];\n    wsDatos['!cols'] = colWidths;\n\n    // Configurar anchos para instrucciones\n    wsInstrucciones['!cols'] = [{ wch: 80 }];\n\n    // Descargar archivo\n    XLSX.writeFile(wb, 'plantilla_inventario.xlsx');\n  };\n\n  const descargarPlantillaCSV = () => {\n    // Crear datos de ejemplo m√°s completos\n    const plantilla = [\n      'codigo_articulo,descripcion_articulo,cantidad_articulo,costo_articulo,ganancia_articulo,categoria,unidad_base,activo',\n      'ART001,Tornillo Phillips 6x25mm,500.000,0.1500,35.00,Ferreter√≠a,Unidad,SI',\n      'ART002,Cable el√©ctrico 12 AWG,100.500,2.7500,28.50,El√©ctricos,Metros,SI',\n      'ART003,Pintura acr√≠lica blanca,25.000,15.2500,42.00,Pinturas,Litros,NO'\n    ].join('\\n');\n\n    // Crear instrucciones\n    const instrucciones = [\n      'INSTRUCCIONES PARA IMPORTAR INVENTARIO',\n      '',\n      '1. CAMPOS OBLIGATORIOS:',\n      '   - codigo_articulo: C√≥digo √∫nico del art√≠culo (sin espacios)',\n      '   - descripcion_articulo: Nombre descriptivo del producto',\n      '   - cantidad_articulo: Cantidad en stock (n√∫mero decimal)',\n      '   - costo_articulo: Precio de costo (n√∫mero decimal)',\n      '',\n      '2. CAMPOS OPCIONALES:',\n      '   - ganancia_articulo: Porcentaje de ganancia (0-100)',\n      '   - categoria: Nombre de la categor√≠a (se crea si no existe)',\n      '   - unidad_base: Unidad de medida (ver lista abajo)',\n      '   - activo: Estado del art√≠culo (SI/NO, TRUE/FALSE, 1/0)',\n      '',\n      '3. UNIDADES DE MEDIDA DISPONIBLES:',\n      '   - Unidad, Mil√≠metros, Cent√≠metros, Metros',\n      '   - Gramos, Kilogramos, Libras',\n      '   - Mililitros, Litros, Galones',\n      '   - Segundos, Minutos, Horas',\n      '',\n      '4. FORMATO DE N√öMEROS:',\n      '   - Use punto (.) como separador decimal',\n      '   - Cantidad: hasta 3 decimales (ej: 100.500)',\n      '   - Costo: hasta 4 decimales (ej: 15.2500)',\n      '   - Ganancia: hasta 2 decimales sin % (ej: 35.00)',\n      '',\n      '5. NOTAS IMPORTANTES:',\n      '   - El precio de venta se calcula autom√°ticamente',\n      '   - Los c√≥digos deben ser √∫nicos',\n      '   - M√°ximo 1000 registros por importaci√≥n',\n      '   - Formato soportado: .csv',\n      '',\n      '--- PLANTILLA DE DATOS ---'\n    ].join('\\n');\n\n    // Crear archivo completo\n    const contenidoCompleto = instrucciones + '\\n\\n' + plantilla;\n\n    // Crear y descargar archivo\n    const blob = new Blob([contenidoCompleto], { type: 'text/csv;charset=utf-8;' });\n    const link = document.createElement('a');\n    const url = URL.createObjectURL(blob);\n    link.setAttribute('href', url);\n    link.setAttribute('download', 'plantilla_inventario.csv');\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  const procesarArchivo = async (file: File) => {\n    // Asegurar que los datos de referencia est√©n cargados\n    if (unidades.length === 0) {\n      await cargarDatosReferencia();\n    }\n    \n    return new Promise<FilaImportacion[]>((resolve, reject) => {\n      const reader = new FileReader();\n      \n      reader.onload = (e) => {\n        try {\n          const data = e.target?.result;\n          let jsonData: any[] = [];\n\n          if (file.name.match(/\\.xlsx$/i)) {\n            // Procesar archivo Excel\n            const workbook = XLSX.read(data, { type: 'array' });\n            \n            // Buscar hoja de datos (priorizar \"Datos\", luego la primera hoja)\n            let sheetName = 'Datos';\n            if (!workbook.Sheets[sheetName]) {\n              sheetName = workbook.SheetNames[0];\n            }\n            \n            const worksheet = workbook.Sheets[sheetName];\n            jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });\n            \n            // Encontrar fila de encabezados\n            let headerRowIndex = -1;\n            for (let i = 0; i < jsonData.length; i++) {\n              const row = jsonData[i];\n              if (row && row.some((cell: any) => \n                typeof cell === 'string' && cell.toLowerCase().includes('codigo_articulo')\n              )) {\n                headerRowIndex = i;\n                break;\n              }\n            }\n            \n            if (headerRowIndex === -1) {\n              reject(new Error('No se encontr√≥ el encabezado con \"codigo_articulo\" en el archivo Excel'));\n              return;\n            }\n            \n            const headers = jsonData[headerRowIndex].map((h: any) => \n              typeof h === 'string' ? h.trim().toLowerCase() : ''\n            );\n            const dataRows = jsonData.slice(headerRowIndex + 1);\n            \n            // Convertir a formato objeto\n            jsonData = dataRows.map(row => {\n              const obj: any = {};\n              headers.forEach((header: string, index: number) => {\n                if (header) {\n                  obj[header] = row[index] || '';\n                }\n              });\n              return obj;\n            }).filter(row => row.codigo_articulo && row.codigo_articulo.toString().trim() !== '');\n            \n          } else {\n            // Procesar archivo CSV\n            const text = data as string;\n            const lines = text.split('\\n').filter(line => line.trim());\n            \n            // Buscar donde empiezan los datos (despu√©s de las instrucciones)\n            let startIndex = 0;\n            for (let i = 0; i < lines.length; i++) {\n              if (lines[i].includes('codigo_articulo')) {\n                startIndex = i;\n                break;\n              }\n            }\n            \n            if (startIndex === 0 && !lines[0].includes('codigo_articulo')) {\n              reject(new Error('No se encontr√≥ el encabezado con los nombres de columnas'));\n              return;\n            }\n            \n            const headers = lines[startIndex].split(',').map(h => h.trim().toLowerCase());\n            const dataLines = lines.slice(startIndex + 1);\n            \n            jsonData = dataLines.map(line => {\n              const values = line.split(',').map(v => v.trim());\n              const obj: any = {};\n              headers.forEach((header, i) => {\n                obj[header] = values[i] || '';\n              });\n              return obj;\n            }).filter(row => row.codigo_articulo && row.codigo_articulo.toString().trim() !== '');\n          }\n\n          const filasValidadas: FilaImportacion[] = jsonData.map((fila, index) => {\n            return validarFila(fila, index + 2);\n          });\n          \n          resolve(filasValidadas.slice(0, 50)); // M√°ximo 50 filas en vista previa\n        } catch (error) {\n          reject(error);\n        }\n      };\n      \n      if (file.name.match(/\\.xlsx$/i)) {\n        reader.readAsArrayBuffer(file);\n      } else {\n        reader.readAsText(file, 'UTF-8');\n      }\n    });\n  };\n\n  const validarFila = (fila: any, numeroFila: number): FilaImportacion => {\n    const errores: string[] = [];\n    const advertencias: string[] = [];\n    \n    const codigo = (fila.codigo_articulo || '').toString().trim();\n    const descripcion = (fila.descripcion_articulo || '').toString().trim();\n    const cantidad = (fila.cantidad_articulo || '').toString().trim();\n    const costo = (fila.costo_articulo || '').toString().trim();\n    const ganancia = (fila.ganancia_articulo || '').toString().trim();\n    const categoria = (fila.categoria || '').toString().trim();\n    const unidad = (fila.unidad_base || 'Unidad').toString().trim();\n    const activo = (fila.activo || 'SI').toString().trim().toUpperCase();\n    \n    // Validaciones obligatorias\n    if (!codigo) errores.push('C√≥digo de art√≠culo requerido');\n    if (!descripcion) errores.push('Descripci√≥n requerida');\n    if (!cantidad) errores.push('Cantidad requerida');\n    if (!costo) errores.push('Costo requerido');\n    \n    // Validar n√∫meros\n    const cantidadNum = parseFloat(cantidad.replace(',', '.'));\n    const costoNum = parseFloat(costo.replace(',', '.'));\n    let gananciaNum = 0;\n    \n    if (cantidad && (isNaN(cantidadNum) || cantidadNum < 0)) {\n      errores.push('Cantidad debe ser un n√∫mero ‚â• 0');\n    }\n    \n    if (costo && (isNaN(costoNum) || costoNum < 0)) {\n      errores.push('Costo debe ser un n√∫mero ‚â• 0');\n    }\n    \n    if (ganancia) {\n      const gananciaStr = ganancia.replace('%', '').replace(',', '.');\n      gananciaNum = parseFloat(gananciaStr);\n      if (isNaN(gananciaNum) || gananciaNum < 0 || gananciaNum > 100) {\n        errores.push('Ganancia debe ser entre 0 y 100%');\n      }\n    }\n    \n    // Validar categor√≠a\n    if (categoria && !categorias.find(c => c.nombre_categoria?.toLowerCase() === categoria.toLowerCase())) {\n      advertencias.push(`Categor√≠a \"${categoria}\" no existe, se crear√° autom√°ticamente`);\n    }\n    \n    // Validar unidad - Mejorada para mostrar unidades disponibles\n    const unidadValida = unidades.find(u => u.nombre.toLowerCase() === unidad.toLowerCase());\n    if (!unidadValida) {\n      const unidadesDisponibles = unidades.map(u => u.nombre).join(', ');\n      errores.push(`Unidad \"${unidad}\" no v√°lida. Unidades disponibles: ${unidadesDisponibles}`);\n    }\n    \n    // Validar activo\n    if (!['SI', 'NO', 'TRUE', 'FALSE', '1', '0'].includes(activo)) {\n      errores.push('Campo activo debe ser: SI/NO, TRUE/FALSE o 1/0');\n    }\n    \n    const estado = errores.length > 0 ? 'error' : advertencias.length > 0 ? 'advertencia' : 'valido';\n    \n    return {\n      fila: numeroFila,\n      codigo_articulo: codigo,\n      descripcion_articulo: descripcion,\n      cantidad_articulo: cantidad,\n      costo_articulo: costo,\n      ganancia_articulo: ganancia,\n      categoria,\n      unidad_base: unidad,\n      activo,\n      errores,\n      advertencias,\n      estado\n    };\n  };\n\n  const manejarSeleccionArchivo = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n    \n    // Validar tipo de archivo\n    if (!file.name.match(/\\.(csv|xlsx)$/i)) {\n      alert('Formato de archivo no v√°lido. Use archivos .csv o .xlsx');\n      return;\n    }\n    \n    setArchivo(file);\n    setProcesando(true);\n    \n    try {\n      const filas = await procesarArchivo(file);\n      setVistaPrevia(filas);\n      setMostrarVistaPrevia(true);\n    } catch (error) {\n      console.error('Error procesando archivo:', error);\n      alert(`Error al procesar el archivo: ${error}`);\n    } finally {\n      setProcesando(false);\n    }\n  };\n\n  const ejecutarImportacion = async () => {\n    if (!archivo) return;\n    \n    setProcesando(true);\n    const resultado: ResultadoImportacion = {\n      creados: 0,\n      actualizados: 0,\n      errores: 0,\n      detalles: []\n    };\n    \n    try {\n      // Procesar archivo completo\n      const todasLasFilas = await procesarArchivo(archivo);\n      const filasValidas = todasLasFilas.filter(f => f.estado !== 'error');\n      \n      // Obtener usuario actual\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) {\n        throw new Error('Usuario no autenticado');\n      }\n      \n      // Procesar cada fila v√°lida\n      for (const fila of filasValidas) {\n        try {\n          // 1. Buscar o crear categor√≠a usando la categor√≠a del archivo Excel\n          let categoriaId = null;\n          if (fila.categoria && fila.categoria.trim() !== '') {\n            // Buscar categor√≠a existente por nombre exacto\n            const { data: categoriaExistente } = await supabase\n              .from('categorias_inventario')\n              .select('id_categoria')\n              .ilike('nombre_categoria', fila.categoria.trim())\n              .single();\n            \n            if (categoriaExistente) {\n              categoriaId = categoriaExistente.id_categoria;\n              console.log(`‚úÖ Categor√≠a encontrada: \"${fila.categoria}\" -> ID: ${categoriaId}`);\n            } else {\n              // Crear nueva categor√≠a usando el nombre del archivo Excel\n              const { data: nuevaCategoria, error: errorCategoria } = await supabase\n                .from('categorias_inventario')\n                .insert({ \n                  nombre_categoria: fila.categoria.trim(),\n                  descripcion_categoria: `Categor√≠a \"${fila.categoria}\" creada autom√°ticamente durante importaci√≥n`,\n                  activo: true\n                })\n                .select('id_categoria')\n                .single();\n              \n              if (errorCategoria) {\n                console.error('Error creando categor√≠a:', errorCategoria);\n                // Si no se puede crear, usar categor√≠a por defecto\n                categoriaId = 1;\n              } else {\n                categoriaId = nuevaCategoria.id_categoria;\n                console.log(`‚úÖ Nueva categor√≠a creada: \"${fila.categoria}\" -> ID: ${categoriaId}`);\n              }\n            }\n          } else {\n            // Si no hay categor√≠a en el archivo, usar categor√≠a por defecto\n            categoriaId = 1;\n            console.log(`‚ö†Ô∏è Sin categor√≠a especificada para ${fila.codigo_articulo}, usando categor√≠a por defecto`);\n          }\n          \n          // 2. Buscar unidad usando la unidad del archivo Excel\n          let unidadId = 1; // Default a \"Unidad\"\n          if (fila.unidad_base && fila.unidad_base.trim() !== '') {\n            const { data: unidadData } = await supabase\n              .from('unidades_medida')\n              .select('id')\n              .ilike('nombre', fila.unidad_base.trim())\n              .single();\n            \n            if (unidadData) {\n              unidadId = unidadData.id;\n              console.log(`‚úÖ Unidad encontrada: \"${fila.unidad_base}\" -> ID: ${unidadId}`);\n            } else {\n              console.log(`‚ö†Ô∏è Unidad \"${fila.unidad_base}\" no encontrada, usando \"Unidad\" por defecto`);\n            }\n          }\n          \n          // 3. Calcular valores\n          const cantidad = parseFloat(fila.cantidad_articulo.replace(',', '.'));\n          const costo = parseFloat(fila.costo_articulo.replace(',', '.'));\n          const ganancia = fila.ganancia_articulo ? parseFloat(fila.ganancia_articulo.replace(',', '.')) : 0;\n          const activo = ['SI', 'TRUE', '1'].includes(fila.activo.toUpperCase());\n          \n          console.log(`üìä Procesando: ${fila.codigo_articulo} - Categor√≠a: \"${fila.categoria}\" (ID: ${categoriaId}) - Unidad: \"${fila.unidad_base}\" (ID: ${unidadId})`);\n          \n          // 4. Verificar si existe registro en inventario\n          const { data: inventarioExistente } = await supabase\n            .from('inventario')\n            .select('id_articulo')\n            .eq('codigo_articulo', fila.codigo_articulo)\n            .single();\n          \n          if (inventarioExistente) {\n            // Actualizar inventario existente - SIN precio_articulo\n            const { error: errorUpdate } = await supabase\n              .from('inventario')\n              .update({\n                descripcion_articulo: fila.descripcion_articulo,\n                cantidad_articulo: cantidad,\n                costo_articulo: costo,\n                ganancia_articulo: ganancia,\n                categoria_id: categoriaId,\n                unidad_base_id: unidadId,\n                activo: activo,\n                updated_at: new Date().toISOString()\n              })\n              .eq('id_articulo', inventarioExistente.id_articulo);\n            \n            if (errorUpdate) {\n              throw new Error(`Error actualizando inventario: ${errorUpdate.message}`);\n            }\n            \n            resultado.actualizados++;\n            resultado.detalles.push(`‚úÖ Actualizado: ${fila.codigo_articulo} - ${fila.descripcion_articulo} (Categor√≠a: ${fila.categoria})`);\n          } else {\n            // Crear nuevo registro en inventario - SIN precio_articulo\n            const { error: errorInsert } = await supabase\n              .from('inventario')\n              .insert({\n                codigo_articulo: fila.codigo_articulo,\n                descripcion_articulo: fila.descripcion_articulo,\n                cantidad_articulo: cantidad,\n                costo_articulo: costo,\n                ganancia_articulo: ganancia,\n                categoria_id: categoriaId,\n                unidad_base_id: unidadId,\n                activo: activo\n              });\n            \n            if (errorInsert) {\n              throw new Error(`Error creando inventario: ${errorInsert.message}`);\n            }\n            \n            resultado.creados++;\n            resultado.detalles.push(`‚úÖ Creado: ${fila.codigo_articulo} - ${fila.descripcion_articulo} (Categor√≠a: ${fila.categoria})`);\n          }\n        } catch (error: any) {\n          resultado.errores++;\n          resultado.detalles.push(`‚ùå Error en ${fila.codigo_articulo}: ${error.message || error}`);\n          console.error('Error procesando fila:', fila, error);\n        }\n      }\n      \n      setResultado(resultado);\n      \n      // Si hubo registros creados o actualizados, mostrar mensaje de √©xito\n      if (resultado.creados > 0 || resultado.actualizados > 0) {\n        alert(`‚úÖ Importaci√≥n completada:\\n${resultado.creados} creados\\n${resultado.actualizados} actualizados\\n${resultado.errores} errores`);\n        \n        // Recargar la p√°gina del inventario para mostrar los nuevos datos\n        setTimeout(() => {\n          window.location.reload();\n        }, 2000);\n      }\n    } catch (error: any) {\n      console.error('Error en importaci√≥n:', error);\n      alert(`Error durante la importaci√≥n: ${error.message || error}`);\n    } finally {\n      setProcesando(false);\n    }\n  };\n\n  const reiniciar = () => {\n    setArchivo(null);\n    setVistaPrevia([]);\n    setMostrarVistaPrevia(false);\n    setResultado(null);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const getColorFila = (estado: string) => {\n    switch (estado) {\n      case 'error': return 'bg-red-50 border-red-200';\n      case 'advertencia': return 'bg-yellow-50 border-yellow-200';\n      default: return 'bg-green-50 border-green-200';\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <h2 className=\"text-xl font-semibold text-gray-900\">Importar Inventario</h2>\n        <div className=\"flex gap-2\">\n          <button\n            onClick={descargarPlantillaExcel}\n            className=\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors whitespace-nowrap cursor-pointer\"\n          >\n            <i className=\"ri-file-excel-line mr-2\"></i>\n            Descargar Plantilla Excel\n          </button>\n          <button\n            onClick={descargarPlantillaCSV}\n            className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap cursor-pointer\"\n          >\n            <i className=\"ri-file-text-line mr-2\"></i>\n            Descargar Plantilla CSV\n          </button>\n        </div>\n      </div>\n\n      {!mostrarVistaPrevia && !resultado && (\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <div className=\"text-center\">\n            <i className=\"ri-file-excel-line text-4xl text-green-600 mb-4\"></i>\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n              Selecciona un archivo Excel o CSV\n            </h3>\n            <p className=\"text-gray-500 mb-6\">\n              Formatos soportados: .xlsx, .csv (m√°ximo 1000 registros)\n            </p>\n            \n            <input\n              ref={fileInputRef}\n              type=\"file\"\n              accept=\".csv,.xlsx\"\n              onChange={manejarSeleccionArchivo}\n              className=\"hidden\"\n            />\n            \n            <button\n              onClick={() => fileInputRef.current?.click()}\n              disabled={procesando}\n              className=\"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 whitespace-nowrap cursor-pointer\"\n            >\n              {procesando ? (\n                <>\n                  <i className=\"ri-loader-line animate-spin mr-2\"></i>\n                  Procesando archivo...\n                </>\n              ) : (\n                <>\n                  <i className=\"ri-upload-line mr-2\"></i>\n                  Seleccionar Archivo\n                </>\n              )}\n            </button>\n          </div>\n          \n          <div className=\"mt-8 bg-blue-50 border border-blue-200 rounded-lg p-4\">\n            <h4 className=\"font-medium text-blue-900 mb-2\">Formato esperado (nombres exactos de columnas):</h4>\n            <ul className=\"text-sm text-blue-800 space-y-1\">\n              <li>‚Ä¢ <strong>codigo_articulo:</strong> √önico, sin espacios (ej: ART001)</li>\n              <li>‚Ä¢ <strong>descripcion_articulo:</strong> Nombre del producto</li>\n              <li>‚Ä¢ <strong>cantidad_articulo:</strong> N√∫mero decimal (ej: 100.000)</li>\n              <li>‚Ä¢ <strong>costo_articulo:</strong> Precio de costo (ej: 50.0000)</li>\n              <li>‚Ä¢ <strong>ganancia_articulo:</strong> Porcentaje 0-100 (ej: 25.00)</li>\n              <li>‚Ä¢ <strong>categoria:</strong> Nombre de la categor√≠a (se crea si no existe)</li>\n              <li>‚Ä¢ <strong>unidad_base:</strong> Unidad, Mil√≠metros, Cent√≠metros, Metros, Gramos, Kilogramos, Libras, Segundos, Minutos, Horas</li>\n              <li>‚Ä¢ <strong>activo:</strong> SI/NO, TRUE/FALSE o 1/0</li>\n            </ul>\n            <div className=\"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded\">\n              <p className=\"text-xs text-yellow-800\">\n                <strong>Importante:</strong> Para archivos Excel, use la hoja \"Datos\" o aseg√∫rese de que los datos est√©n en la primera hoja.\n                Los nombres de las columnas deben ser exactamente como se muestran arriba.\n                El precio se calcula autom√°ticamente: precio = costo √ó (1 + ganancia/100)\n              </p>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {mostrarVistaPrevia && !resultado && (\n        <div className=\"space-y-4\">\n          <div className=\"bg-white rounded-lg shadow p-4\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h3 className=\"text-lg font-medium\">Vista Previa - {archivo?.name}</h3>\n              <div className=\"flex gap-2\">\n                <button\n                  onClick={reiniciar}\n                  className=\"bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors whitespace-nowrap cursor-pointer\"\n                >\n                  Cancelar\n                </button>\n                <button\n                  onClick={ejecutarImportacion}\n                  disabled={procesando || vistaPrevia.every(f => f.estado === 'error')}\n                  className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 whitespace-nowrap cursor-pointer\"\n                >\n                  {procesando ? 'Importando...' : 'Confirmar Importaci√≥n'}\n                </button>\n              </div>\n            </div>\n            \n            <div className=\"grid grid-cols-3 gap-4 mb-4\">\n              <div className=\"bg-green-50 p-3 rounded-lg text-center\">\n                <div className=\"text-2xl font-bold text-green-600\">\n                  {vistaPrevia.filter(f => f.estado === 'valido').length}\n                </div>\n                <div className=\"text-sm text-green-700\">V√°lidos</div>\n              </div>\n              <div className=\"bg-yellow-50 p-3 rounded-lg text-center\">\n                <div className=\"text-2xl font-bold text-yellow-600\">\n                  {vistaPrevia.filter(f => f.estado === 'advertencia').length}\n                </div>\n                <div className=\"text-sm text-yellow-700\">Advertencias</div>\n              </div>\n              <div className=\"bg-red-50 p-3 rounded-lg text-center\">\n                <div className=\"text-2xl font-bold text-red-600\">\n                  {vistaPrevia.filter(f => f.estado === 'error').length}\n                </div>\n                <div className=\"text-sm text-red-700\">Errores</div>\n              </div>\n            </div>\n          </div>\n          \n          <div className=\"bg-white rounded-lg shadow overflow-hidden\">\n            <div className=\"overflow-x-auto max-h-96\">\n              <table className=\"min-w-full divide-y divide-gray-200\">\n                <thead className=\"bg-gray-50 sticky top-0\">\n                  <tr>\n                    <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase\">Fila</th>\n                    <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase\">C√≥digo</th>\n                    <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase\">Descripci√≥n</th>\n                    <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase\">Categor√≠a</th>\n                    <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase\">Cantidad</th>\n                    <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase\">Costo</th>\n                    <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase\">Ganancia</th>\n                    <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase\">Activo</th>\n                    <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase\">Estado</th>\n                  </tr>\n                </thead>\n                <tbody className=\"divide-y divide-gray-200\">\n                  {vistaPrevia.map((fila, index) => (\n                    <tr key={index} className={getColorFila(fila.estado)}>\n                      <td className=\"px-3 py-2 text-sm\">{fila.fila}</td>\n                      <td className=\"px-3 py-2 text-sm font-medium\">{fila.codigo_articulo}</td>\n                      <td className=\"px-3 py-2 text-sm\">{fila.descripcion_articulo}</td>\n                      <td className=\"px-3 py-2 text-sm\">\n                        <span className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800\">\n                          {fila.categoria || 'Sin categor√≠a'}\n                        </span>\n                      </td>\n                      <td className=\"px-3 py-2 text-sm\">{fila.cantidad_articulo}</td>\n                      <td className=\"px-3 py-2 text-sm\">{fila.costo_articulo}</td>\n                      <td className=\"px-3 py-2 text-sm\">{fila.ganancia_articulo}%</td>\n                      <td className=\"px-3 py-2 text-sm\">{fila.activo}</td>\n                      <td className=\"px-3 py-2 text-sm\">\n                        <div className=\"space-y-1\">\n                          {fila.errores.map((error, i) => (\n                            <div key={i} className=\"text-red-600 text-xs\">{error}</div>\n                          ))}\n                          {fila.advertencias.map((adv, i) => (\n                            <div key={i} className=\"text-yellow-600 text-xs\">{adv}</div>\n                          ))}\n                          {fila.estado === 'valido' && (\n                            <div className=\"text-green-600 text-xs\">‚úì V√°lido</div>\n                          )}\n                        </div>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {resultado && (\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <h3 className=\"text-lg font-medium mb-4\">Resultado de la Importaci√≥n</h3>\n          \n          <div className=\"grid grid-cols-3 gap-4 mb-6\">\n            <div className=\"bg-green-50 p-4 rounded-lg text-center\">\n              <div className=\"text-3xl font-bold text-green-600\">{resultado.creados}</div>\n              <div className=\"text-sm text-green-700\">Creados</div>\n            </div>\n            <div className=\"bg-blue-50 p-4 rounded-lg text-center\">\n              <div className=\"text-3xl font-bold text-blue-600\">{resultado.actualizados}</div>\n              <div className=\"text-sm text-blue-700\">Actualizados</div>\n            </div>\n            <div className=\"bg-red-50 p-4 rounded-lg text-center\">\n              <div className=\"text-3xl font-bold text-red-600\">{resultado.errores}</div>\n              <div className=\"text-sm text-red-700\">Errores</div>\n            </div>\n          </div>\n          \n          <div className=\"bg-gray-50 rounded-lg p-4 max-h-40 overflow-y-auto\">\n            <h4 className=\"font-medium mb-2\">Detalles:</h4>\n            {resultado.detalles.map((detalle, index) => (\n              <div key={index} className=\"text-sm text-gray-600\">{detalle}</div>\n            ))}\n          </div>\n          \n          <div className=\"flex justify-center mt-6\">\n            <button\n              onClick={reiniciar}\n              className=\"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap cursor-pointer\"\n            >\n              Nueva Importaci√≥n\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}","import { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\n\ninterface CategoriaInventario {\n  id_categoria: number;\n  nombre_categoria: string;\n  descripcion_categoria?: string;\n  activo: boolean;\n  created_at: string;\n}\n\ninterface CategoriasInventarioManagerProps {\n  onClose: () => void;\n}\n\nexport default function CategoriasInventarioManager({ onClose }: CategoriasInventarioManagerProps) {\n  const [categorias, setCategorias] = useState<CategoriaInventario[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [editando, setEditando] = useState<number | null>(null);\n  const [nuevaCategoria, setNuevaCategoria] = useState({\n    nombre_categoria: '',\n    descripcion_categoria: ''\n  });\n  const [mostrarFormulario, setMostrarFormulario] = useState(false);\n\n  useEffect(() => {\n    cargarCategorias();\n  }, []);\n\n  const cargarCategorias = async () => {\n    try {\n      setLoading(true);\n      const { data, error } = await supabase\n        .from('categorias_inventario')\n        .select('*')\n        .order('nombre_categoria');\n\n      if (error) throw error;\n      setCategorias(data || []);\n    } catch (error) {\n      console.error('Error cargando categor√≠as de inventario:', error);\n      alert('Error al cargar las categor√≠as de inventario');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const crearCategoria = async () => {\n    if (!nuevaCategoria.nombre_categoria.trim()) {\n      alert('El nombre de la categor√≠a es obligatorio');\n      return;\n    }\n\n    try {\n      setSaving(true);\n      const { error } = await supabase\n        .from('categorias_inventario')\n        .insert([{\n          nombre_categoria: nuevaCategoria.nombre_categoria.trim(),\n          descripcion_categoria: nuevaCategoria.descripcion_categoria.trim() || null,\n          activo: true\n        }]);\n\n      if (error) throw error;\n\n      setNuevaCategoria({ nombre_categoria: '', descripcion_categoria: '' });\n      setMostrarFormulario(false);\n      cargarCategorias();\n      alert('Categor√≠a creada exitosamente');\n    } catch (error: any) {\n      console.error('Error creando categor√≠a:', error);\n      if (error.code === '23505') {\n        alert('Ya existe una categor√≠a con ese nombre');\n      } else {\n        alert('Error al crear la categor√≠a');\n      }\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const actualizarCategoria = async (id: number, datos: Partial<CategoriaInventario>) => {\n    try {\n      setSaving(true);\n      const { error } = await supabase\n        .from('categorias_inventario')\n        .update(datos)\n        .eq('id_categoria', id);\n\n      if (error) throw error;\n\n      setEditando(null);\n      cargarCategorias();\n      alert('Categor√≠a actualizada exitosamente');\n    } catch (error: any) {\n      console.error('Error actualizando categor√≠a:', error);\n      if (error.code === '23505') {\n        alert('Ya existe una categor√≠a con ese nombre');\n      } else {\n        alert('Error al actualizar la categor√≠a');\n      }\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const toggleEstadoCategoria = async (id: number, estadoActual: boolean) => {\n    try {\n      // Verificar si la categor√≠a est√° siendo usada\n      const { data: articulosUsando, error: errorVerificacion } = await supabase\n        .from('inventario')\n        .select('id_articulo')\n        .eq('categoria_inventario_id', id)\n        .limit(1);\n\n      if (errorVerificacion) throw errorVerificacion;\n\n      if (articulosUsando && articulosUsando.length > 0 && estadoActual) {\n        alert('No se puede desactivar esta categor√≠a porque est√° siendo utilizada por art√≠culos del inventario');\n        return;\n      }\n\n      await actualizarCategoria(id, { activo: !estadoActual });\n    } catch (error) {\n      console.error('Error cambiando estado de categor√≠a:', error);\n      alert('Error al cambiar el estado de la categor√≠a');\n    }\n  };\n\n  const eliminarCategoria = async (id: number) => {\n    try {\n      // Verificar si la categor√≠a est√° siendo usada\n      const { data: articulosUsando, error: errorVerificacion } = await supabase\n        .from('inventario')\n        .select('id_articulo')\n        .eq('categoria_inventario_id', id)\n        .limit(1);\n\n      if (errorVerificacion) throw errorVerificacion;\n\n      if (articulosUsando && articulosUsando.length > 0) {\n        alert('No se puede eliminar esta categor√≠a porque est√° siendo utilizada por art√≠culos del inventario');\n        return;\n      }\n\n      if (!confirm('¬øEst√°s seguro de que deseas eliminar esta categor√≠a? Esta acci√≥n no se puede deshacer.')) {\n        return;\n      }\n\n      setSaving(true);\n      const { error } = await supabase\n        .from('categorias_inventario')\n        .delete()\n        .eq('id_categoria', id);\n\n      if (error) throw error;\n\n      cargarCategorias();\n      alert('Categor√≠a eliminada exitosamente');\n    } catch (error) {\n      console.error('Error eliminando categor√≠a:', error);\n      alert('Error al eliminar la categor√≠a');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n        <div className=\"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full\">\n          <div className=\"flex flex-col items-center justify-center space-y-4\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n            <div className=\"text-center\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\n                Cargando categor√≠as\n              </h3>\n              <p className=\"text-sm text-gray-600\">\n                Obteniendo categor√≠as de inventario...\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto\">\n        <div className=\"p-6\">\n          <div className=\"flex justify-between items-center mb-6\">\n            <h2 className=\"text-2xl font-bold text-gray-900\">\n              Gesti√≥n de Categor√≠as de Inventario\n            </h2>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 transition-colors p-2 hover:bg-gray-100 rounded-lg\"\n            >\n              <i className=\"ri-close-line text-2xl\"></i>\n            </button>\n          </div>\n\n          {/* Bot√≥n para nueva categor√≠a */}\n          <div className=\"mb-6\">\n            <button\n              onClick={() => setMostrarFormulario(!mostrarFormulario)}\n              className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap cursor-pointer\"\n            >\n              <i className=\"ri-add-line mr-2\"></i>\n              Nueva Categor√≠a de Inventario\n            </button>\n          </div>\n\n          {/* Formulario para nueva categor√≠a */}\n          {mostrarFormulario && (\n            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6\">\n              <h3 className=\"text-lg font-semibold text-blue-900 mb-4\">Nueva Categor√≠a</h3>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Nombre *\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={nuevaCategoria.nombre_categoria}\n                    onChange={(e) => setNuevaCategoria(prev => ({ ...prev, nombre_categoria: e.target.value }))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    placeholder=\"Nombre de la categor√≠a\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Descripci√≥n\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={nuevaCategoria.descripcion_categoria}\n                    onChange={(e) => setNuevaCategoria(prev => ({ ...prev, descripcion_categoria: e.target.value }))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    placeholder=\"Descripci√≥n opcional\"\n                  />\n                </div>\n              </div>\n              <div className=\"flex justify-end gap-2 mt-4\">\n                <button\n                  onClick={() => {\n                    setMostrarFormulario(false);\n                    setNuevaCategoria({ nombre_categoria: '', descripcion_categoria: '' });\n                  }}\n                  className=\"px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors whitespace-nowrap cursor-pointer\"\n                >\n                  Cancelar\n                </button>\n                <button\n                  onClick={crearCategoria}\n                  disabled={saving || !nuevaCategoria.nombre_categoria.trim()}\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 whitespace-nowrap cursor-pointer\"\n                >\n                  {saving ? 'Creando...' : 'Crear Categor√≠a'}\n                </button>\n              </div>\n            </div>\n          )}\n\n          {/* Lista de categor√≠as */}\n          <div className=\"bg-white border rounded-lg overflow-hidden\">\n            <table className=\"w-full\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Nombre\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Descripci√≥n\n                  </th>\n                  <th className=\"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Estado\n                  </th>\n                  <th className=\"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Fecha Creaci√≥n\n                  </th>\n                  <th className=\"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Acciones\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {categorias.length === 0 ? (\n                  <tr>\n                    <td colSpan={5} className=\"px-6 py-12 text-center text-gray-500\">\n                      <i className=\"ri-folder-line text-4xl mb-4 block\"></i>\n                      No se encontraron categor√≠as de inventario\n                    </td>\n                  </tr>\n                ) : (\n                  categorias.map((categoria) => (\n                    <tr key={categoria.id_categoria} className={`hover:bg-gray-50 ${!categoria.activo ? 'opacity-60' : ''}`}>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        {editando === categoria.id_categoria ? (\n                          <input\n                            type=\"text\"\n                            defaultValue={categoria.nombre_categoria}\n                            onBlur={(e) => {\n                              if (e.target.value.trim() !== categoria.nombre_categoria) {\n                                actualizarCategoria(categoria.id_categoria, { nombre_categoria: e.target.value.trim() });\n                              } else {\n                                setEditando(null);\n                              }\n                            }}\n                            onKeyPress={(e) => {\n                              if (e.key === 'Enter') {\n                                e.currentTarget.blur();\n                              }\n                            }}\n                            className=\"w-full px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                            autoFocus\n                          />\n                        ) : (\n                          <div className=\"text-sm font-medium text-gray-900\">\n                            {categoria.nombre_categoria}\n                          </div>\n                        )}\n                      </td>\n                      <td className=\"px-6 py-4\">\n                        <div className=\"text-sm text-gray-600 max-w-xs truncate\">\n                          {categoria.descripcion_categoria || 'Sin descripci√≥n'}\n                        </div>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-center\">\n                        <button\n                          onClick={() => toggleEstadoCategoria(categoria.id_categoria, categoria.activo)}\n                          className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium cursor-pointer transition-colors ${\n                            categoria.activo \n                              ? 'bg-green-100 text-green-800 hover:bg-green-200' \n                              : 'bg-red-100 text-red-800 hover:bg-red-200'\n                          }`}\n                        >\n                          {categoria.activo ? 'Activa' : 'Inactiva'}\n                        </button>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-center text-sm text-gray-500\">\n                        {new Date(categoria.created_at).toLocaleDateString('es-ES')}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-center text-sm font-medium\">\n                        <div className=\"flex items-center justify-center gap-2\">\n                          <button\n                            onClick={() => setEditando(categoria.id_categoria)}\n                            className=\"text-blue-600 hover:text-blue-900 transition-colors p-1\"\n                            title=\"Editar nombre\"\n                          >\n                            <i className=\"ri-edit-line\"></i>\n                          </button>\n                          <button\n                            onClick={() => eliminarCategoria(categoria.id_categoria)}\n                            className=\"text-red-600 hover:text-red-900 transition-colors p-1\"\n                            title=\"Eliminar\"\n                          >\n                            <i className=\"ri-delete-bin-line\"></i>\n                          </button>\n                        </div>\n                      </td>\n                    </tr>\n                  ))\n                )}\n              </tbody>\n            </table>\n          </div>\n\n          <div className=\"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg\">\n            <div className=\"flex items-start\">\n              <i className=\"ri-information-line text-yellow-600 mt-0.5 mr-2\"></i>\n              <div className=\"text-sm text-yellow-800\">\n                <p className=\"font-medium mb-1\">Informaci√≥n importante:</p>\n                <ul className=\"list-disc list-inside space-y-1\">\n                  <li>Las categor√≠as de inventario son independientes de las categor√≠as de productos</li>\n                  <li>No se pueden eliminar categor√≠as que est√©n siendo utilizadas por art√≠culos</li>\n                  <li>Al desactivar una categor√≠a, los art√≠culos existentes mantienen su categor√≠a</li>\n                  <li>Las categor√≠as inactivas no aparecen en los formularios de nuevos art√≠culos</li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","\nimport { useState } from 'react';\nimport { InventarioLayout } from './components/InventarioLayout';\nimport InventarioFilters from './components/InventarioFilters';\nimport InventarioTable from './components/InventarioTable';\nimport InventarioForm from './components/InventarioForm';\nimport ImportarInventario from './components/ImportarInventario';\nimport CategoriasInventarioManager from './components/CategoriasInventarioManager';\n\ninterface Articulo {\n  id_articulo: number;\n  codigo_articulo: string;\n  descripcion_articulo: string;\n  cantidad_articulo: number;\n  costo_articulo: number;\n  ganancia_articulo: number;\n  precio_articulo: number;\n  categoria_id: number;\n  activo: boolean;\n}\n\nexport default function InventarioPage() {\n  const [vistaActual, setVistaActual] = useState<'inventario' | 'categorias' | 'importar'>('inventario');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedCategoria, setSelectedCategoria] = useState<number | null>(null);\n  const [sortBy, setSortBy] = useState('codigo_articulo');\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('asc');\n  const [mostrarFormulario, setMostrarFormulario] = useState(false);\n  const [articuloEditando, setArticuloEditando] = useState<Articulo | null>(null);\n  const [refreshTrigger, setRefreshTrigger] = useState(0);\n\n  const handleNuevoArticulo = () => {\n    setArticuloEditando(null);\n    setMostrarFormulario(true);\n  };\n\n  const handleEditarArticulo = (articulo: Articulo) => {\n    setArticuloEditando(articulo);\n    setMostrarFormulario(true);\n  };\n\n  const handleGuardarArticulo = () => {\n    setMostrarFormulario(false);\n    setArticuloEditando(null);\n    setRefreshTrigger(prev => prev + 1);\n  };\n\n  const handleCancelarFormulario = () => {\n    setMostrarFormulario(false);\n    setArticuloEditando(null);\n  };\n\n  const renderContent = () => {\n    switch (vistaActual) {\n      case 'inventario':\n        return (\n          <div className=\"space-y-6\">\n            {/* Header */}\n            <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n              <div>\n                <h1 className=\"text-2xl font-bold text-gray-900\">Inventario</h1>\n                <p className=\"text-gray-600\">Gesti√≥n de art√≠culos y stock</p>\n              </div>\n              <button\n                onClick={handleNuevoArticulo}\n                className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap cursor-pointer\"\n              >\n                <i className=\"ri-add-line mr-2\"></i>\n                Nuevo Art√≠culo\n              </button>\n            </div>\n\n            {/* Filtros */}\n            <InventarioFilters\n              searchTerm={searchTerm}\n              onSearchChange={setSearchTerm}\n              selectedCategoria={selectedCategoria}\n              onCategoriaChange={setSelectedCategoria}\n              sortBy={sortBy}\n              onSortByChange={setSortBy}\n              sortOrder={sortOrder}\n              onSortOrderChange={setSortOrder}\n            />\n\n            {/* Tabla */}\n            <InventarioTable\n              searchTerm={searchTerm}\n              selectedCategoria={selectedCategoria}\n              sortBy={sortBy}\n              sortOrder={sortOrder}\n              onEditar={handleEditarArticulo}\n              refreshTrigger={refreshTrigger}\n            />\n          </div>\n        );\n\n      case 'categorias':\n        return (\n          <div className=\"space-y-6\">\n            <div>\n              <h1 className=\"text-2xl font-bold text-gray-900\">Categor√≠as de Inventario</h1>\n              <p className=\"text-gray-600\">Gesti√≥n de categor√≠as para art√≠culos</p>\n            </div>\n            <div className=\"bg-white rounded-lg shadow-sm border\">\n              <CategoriasInventarioManager onClose={() => {}} />\n            </div>\n          </div>\n        );\n\n      case 'importar':\n        return (\n          <div className=\"space-y-6\">\n            <div>\n              <h1 className=\"text-2xl font-bold text-gray-900\">Importar Inventario</h1>\n              <p className=\"text-gray-600\">Importaci√≥n masiva desde Excel</p>\n            </div>\n            <div className=\"bg-white rounded-lg shadow-sm border p-6\">\n              <ImportarInventario />\n            </div>\n          </div>\n        );\n\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <InventarioLayout vistaActual={vistaActual} onCambiarVista={setVistaActual}>\n      {renderContent()}\n\n      {/* Modal de formulario */}\n      {mostrarFormulario && (\n        <InventarioForm\n          articulo={articuloEditando}\n          onSave={handleGuardarArticulo}\n          onCancel={handleCancelarFormulario}\n        />\n      )}\n    </InventarioLayout>\n  );\n}\n"],"names":["InventarioLayout","children","vistaActual","onCambiarVista","sidebarOpen","setSidebarOpen","useState","tabs","jsxs","jsx","Sidebar","TopBar","tab","MobileNav","InventarioFilters","searchTerm","onSearchChange","selectedCategoria","onCategoriaChange","categoriasExternas","sortBy","onSortByChange","sortOrder","onSortOrderChange","categorias","setCategorias","useEffect","cargarCategorias","data","error","supabase","sortOptions","e","cat","option","c","InventarioTable","onEditar","refreshTrigger","articulos","setArticulos","loading","setLoading","notification","showSuccess","showError","showWarning","hideNotification","confirmation","showConfirmation","useNotification","cargarArticulos","inventarioRes","categoriasRes","inventarioData","categoriasData","articulosFiltrados","articulo","a","b","aValue","bValue","fallbackQuery","fallbackData","fallbackError","categoriasFallback","articulosConCategoriasFallback","toggleEstadoArticulo","id","estadoActual","prev","handleEliminar","bomCheck","cotizacionCheck","pedidoCheck","Fragment","NotificationPopup","ConfirmationDialog","InventarioForm","onSave","onCancel","formData","setFormData","errors","setErrors","precioCalculado","setPrecioCalculado","unidades","setUnidades","tiposCodigoBarras","setTiposCodigoBarras","saving","setSaving","categoriaSeleccionada","setCategoriaSeleccionada","validandoCodigo","setValidandoCodigo","codigoValido","setCodigoValido","unidadesRes","tiposCodigoRes","validarCodigoBarras","categoria","costo","margen","precio","timer","codigo","tipoId","tipo","t","esValido","newErrors","detectarTipoAutomatico","handleChange","name","value","type","processedValue","handleCodigoBarrasChange","handleNumericChange","decimals","validateForm","cantidad","ganancia","handleSubmit","user","tiendaActual","tiendaError","dataToSave","result","errorMessage","formatCurrency","unidadesPorGrupo","grupos","unidad","esLamina","esTapacanto","grupo","unidadesGrupo","ImportarInventario","archivo","setArchivo","vistaPrevia","setVistaPrevia","mostrarVistaPrevia","setMostrarVistaPrevia","procesando","setProcesando","resultado","setResultado","fileInputRef","useRef","cargarDatosReferencia","categoriasError","unidadesData","unidadesError","descargarPlantillaExcel","datosEjemplo","instrucciones","wb","XLSX.utils","wsInstrucciones","wsDatos","colWidths","XLSX.writeFile","descargarPlantillaCSV","plantilla","contenidoCompleto","blob","link","url","procesarArchivo","file","resolve","reject","reader","jsonData","workbook","XLSX.read","sheetName","worksheet","headerRowIndex","i","row","cell","headers","h","obj","header","index","lines","line","startIndex","values","v","filasValidadas","fila","validarFila","numeroFila","errores","advertencias","descripcion","activo","cantidadNum","costoNum","gananciaNum","gananciaStr","u","unidadesDisponibles","estado","manejarSeleccionArchivo","filas","ejecutarImportacion","filasValidas","f","categoriaId","categoriaExistente","nuevaCategoria","errorCategoria","unidadId","unidadData","inventarioExistente","errorUpdate","errorInsert","reiniciar","getColorFila","adv","detalle","CategoriasInventarioManager","onClose","editando","setEditando","setNuevaCategoria","mostrarFormulario","setMostrarFormulario","crearCategoria","actualizarCategoria","datos","toggleEstadoCategoria","articulosUsando","errorVerificacion","eliminarCategoria","InventarioPage","setVistaActual","setSearchTerm","setSelectedCategoria","setSortBy","setSortOrder","articuloEditando","setArticuloEditando","setRefreshTrigger","handleNuevoArticulo","handleEditarArticulo","handleGuardarArticulo","handleCancelarFormulario","renderContent"],"mappings":"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"}