import{a as j,d as D,r as h,j as e,L as b,u as I,C}from"./index-Xz42BvxI.js";const R=()=>{const{permissions:r,profile:a}=j();console.log("[DEBUG PERMISOS] ðŸ” usePermissions - permisos finales:",r),console.log("[DEBUG PERMISOS] ðŸ” usePermissions - total permisos:",r.length);const n=t=>{if(!t)return!0;if(r.includes(t))return console.log(`[DEBUG PERMISOS] âœ… hasPermission("${t}") = true (directo)`),!0;const i=`${t}:own`;return r.includes(i)?(console.log(`[DEBUG PERMISOS] âœ… hasPermission("${t}") = true (tiene ${i})`),!0):(console.log(`[DEBUG PERMISOS] âŒ hasPermission("${t}") = false`),!1)},x=t=>{if(!t||!a)return!1;const i=a.rol===t;return console.log(`[DEBUG PERMISOS] hasRole("${t}") = ${i} (rol actual: ${a.rol})`),i},c=t=>{const i=`${t}:view`,l=`${t}:view:own`,s=r.includes(i)||r.includes(l);return console.log(`[DEBUG PERMISOS] canRead("${t}") = ${s} (buscando ${i} o ${l})`),s},u=t=>{const i=`${t}:create`,l=`${t}:create:own`,s=`${t}:edit`,g=`${t}:edit:own`,f=r.includes(i)||r.includes(l)||r.includes(s)||r.includes(g);return console.log(`[DEBUG PERMISOS] canWrite("${t}") = ${f}`),f},o=t=>{const i=`${t}:delete`,l=`${t}:delete:own`,s=r.includes(i)||r.includes(l);return console.log(`[DEBUG PERMISOS] canDelete("${t}") = ${s}`),s},m=a?.rol==="Admin";return{permissions:r,hasPermission:n,hasRole:x,canRead:c,canWrite:u,canDelete:o,isAdmin:m}};function A({isOpen:r,onClose:a}){const n=D(),{user:x}=j(),{hasPermission:c,hasRole:u}=R(),[o,m]=h.useState(!1),t=[{name:"Dashboard",icon:"ri-dashboard-line",path:"/dashboard",permission:"dashboard:view"},{name:"Clientes",icon:"ri-user-line",path:"/clientes",permission:"clientes:view"},{name:"Productos",icon:"ri-product-hunt-line",path:"/productos",permission:"productos:view"},{name:"Inventario",icon:"ri-store-line",path:"/inventario",permission:"inventario:view"},{name:"Mantenimiento",icon:"ri-tools-line",path:"/mantenimiento",permission:"mantenimiento:view"},{name:"Cotizaciones",icon:"ri-file-text-line",path:"/cotizaciones",permission:"cotizaciones:view"},{name:"Pedidos",icon:"ri-shopping-cart-line",path:"/pedidos",permission:"pedidos:view"},{name:"Seguimiento",icon:"ri-route-line",path:"/seguimiento",permission:"seguimiento:view"},{name:"Tareas",icon:"ri-task-line",path:"/tareas",permission:"tareas:view"},{name:"AnÃ¡lisis Tareas",icon:"ri-bar-chart-box-line",path:"/tabla-datos-tareas",permission:"tareas:view"},{name:"FacturaciÃ³n",icon:"ri-bill-line",path:"/facturacion",permission:"facturacion:view"},{name:"EmisiÃ³n de Factura",icon:"ri-file-add-line",path:"/facturacion/emision",permission:"facturacion:emision:view"},{name:"Seguridad",icon:"ri-shield-user-line",path:"/seguridad",role:"Admin"},{name:"CostBot Admin",icon:"ri-robot-line",path:"/costbot-admin",role:"Admin"},{name:"Perfil",icon:"ri-user-settings-line",path:"/perfil",requireAuth:!0}],i=s=>s.role?u(s.role):s.permission?c(s.permission):s.requireAuth?!!x:!0,l=s=>n.pathname===s||n.pathname.startsWith(s+"/");return e.jsxs(e.Fragment,{children:[r&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:a}),e.jsxs("aside",{onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),className:`
          fixed lg:static inset-y-0 left-0 z-50
          bg-white border-r border-gray-200
          transform transition-all duration-300 ease-in-out
          ${r?"translate-x-0":"-translate-x-full lg:translate-x-0"}
          ${o?"lg:w-64":"lg:w-20"}
        `,children:[e.jsxs("div",{className:"h-16 flex items-center justify-between px-4 border-b border-gray-200",children:[e.jsxs(b,{to:"/dashboard",className:"flex items-center space-x-3 overflow-hidden",children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center flex-shrink-0",children:e.jsx("img",{src:"https://static.readdy.ai/image/96746b7ba583c55b81aa58d37fd022fd/8044848901197a0577b8befd634c6da9.png",alt:"Logo",className:"w-full h-full object-contain"})}),e.jsxs("div",{className:`transition-opacity duration-300 ${o?"opacity-100":"lg:opacity-0 lg:w-0"}`,children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 whitespace-nowrap",style:{fontFamily:'"Pacifico", serif'},children:"SCO"}),e.jsx("p",{className:"text-xs text-gray-500 -mt-1 whitespace-nowrap",children:"Sistema de Costeos OLO"})]})]}),e.jsx("button",{onClick:a,className:"lg:hidden text-gray-500 hover:text-gray-700 cursor-pointer",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),e.jsxs("nav",{className:"p-4 space-y-1 overflow-y-auto h-[calc(100vh-4rem)]",children:[t.filter(i).map(s=>e.jsxs(b,{to:s.path,onClick:a,className:`
                flex items-center space-x-3 px-4 py-3 rounded-lg
                transition-colors duration-200 cursor-pointer
                ${l(s.path)?"bg-blue-50 text-blue-600 font-medium":"text-gray-700 hover:bg-gray-50"}
              `,children:[e.jsx("i",{className:`${s.icon} text-xl flex-shrink-0`}),e.jsx("span",{className:`transition-opacity duration-300 whitespace-nowrap ${o?"opacity-100":"lg:opacity-0 lg:w-0 lg:hidden"}`,children:s.name})]},s.path)),c("optimizador:view")&&e.jsxs(b,{to:"/optimizador",className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors cursor-pointer ${n.pathname==="/optimizador"?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"}`,children:[e.jsx("i",{className:"ri-layout-grid-line text-xl flex-shrink-0"}),e.jsx("span",{className:`font-medium transition-opacity duration-300 whitespace-nowrap ${o?"opacity-100":"lg:opacity-0 lg:w-0 lg:hidden"}`,children:"Optimizador 2D"})]})]})]})]})}function B({onToggleSidebar:r}){const[a,n]=h.useState(!1),[x,c]=h.useState(!1),[u,o]=h.useState(!1),[m,t]=h.useState(!1),i=I(),{user:l,profile:s,signOut:g,stores:f,currentStore:p,setCurrentStore:U}=j(),S=()=>{n(!1),i("/perfil")},$=()=>{n(!1),i("/seguridad")},P=()=>{n(!1),c(!0)},k=async()=>{n(!1),o(!0)},E=async()=>{o(!1);try{console.log("ðŸšª Iniciando logout desde TopBar..."),await g()}catch(d){console.error("âŒ Error en logout:",d),window.location.href="/login"}},y=()=>{c(!1)},M=d=>{d.preventDefault(),t(!0),c(!1)},N=()=>{if(!s?.nombre_completo)return"U";const d=s.nombre_completo.split(" ");return d.length>=2?`${d[0][0]}${d[1][0]}`.toUpperCase():s.nombre_completo[0].toUpperCase()},v=()=>s?.nombre_completo?s.nombre_completo:"Usuario",w=()=>s?.email?s.email:l?.email||"Sin email",O=()=>{i("/dashboard")};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer lg:hidden",title:"Abrir menÃº",children:e.jsx("i",{className:"ri-menu-line text-xl text-gray-600"})}),e.jsxs("div",{onClick:O,className:"flex items-center space-x-3 cursor-pointer hover:opacity-80 transition-opacity",title:"Ir al inicio",children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:e.jsx("img",{src:"https://static.readdy.ai/image/96746b7ba583c55b81aa58d37fd022fd/8044848901197a0577b8befd634c6da9.png",alt:"Logo",className:"w-full h-full object-contain"})}),e.jsxs("div",{className:"hidden sm:block",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",style:{fontFamily:'"Pacifico", serif'},children:"SCO"}),e.jsx("p",{className:"text-sm text-gray-500 -mt-1",children:"Sistema de Costeos OLO"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[p&&e.jsxs("div",{className:"hidden md:flex items-center space-x-2 px-3 py-2 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("i",{className:"ri-store-2-line text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-900",children:p.nombre})]}),e.jsxs("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",title:"Notificaciones",children:[e.jsx("i",{className:"ri-notification-line text-xl text-gray-600"}),e.jsx("span",{className:"absolute -mt-8 ml-4 w-2 h-2 bg-red-500 rounded-full"})]}),e.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",title:"BÃºsqueda global",children:e.jsx("i",{className:"ri-search-line text-xl text-gray-600"})}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>n(!a),className:"flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",title:"MenÃº de usuario",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-blue-500 rounded-full flex items-center justify-center shadow-sm",children:e.jsx("span",{className:"text-white text-sm font-medium",children:N()})}),e.jsxs("div",{className:"hidden md:block text-left",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:v()}),e.jsx("div",{className:"text-xs text-gray-500",children:w()})]}),e.jsx("i",{className:`ri-arrow-${a?"up":"down"}-s-line text-gray-600 transition-transform`})]}),a&&e.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-blue-500 rounded-full flex items-center justify-center shadow-sm",children:e.jsx("span",{className:"text-white text-lg font-medium",children:N()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:v()}),e.jsx("div",{className:"text-xs text-gray-500 truncate",children:w()}),s?.rol&&e.jsxs("div",{className:"text-xs text-purple-600 font-medium mt-1",children:[e.jsx("i",{className:"ri-shield-user-line mr-1"}),s.rol]})]})]})}),p&&e.jsx("div",{className:"px-4 py-2 bg-blue-50 border-b border-blue-100",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("i",{className:"ri-store-2-line text-blue-600 text-sm"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Tienda actual:"}),e.jsx("p",{className:"text-sm font-medium text-blue-900",children:p.nombre})]})]})}),e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:S,className:"flex items-center w-full px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 transition-colors cursor-pointer",children:[e.jsx("i",{className:"ri-user-line mr-3 text-gray-400 w-4"}),"Mi Perfil"]}),e.jsxs("button",{onClick:$,className:"flex items-center w-full px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 transition-colors cursor-pointer",children:[e.jsx("i",{className:"ri-settings-line mr-3 text-gray-400 w-4"}),"ConfiguraciÃ³n"]}),e.jsxs("button",{onClick:P,className:"flex items-center w-full px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 transition-colors cursor-pointer",children:[e.jsx("i",{className:"ri-phone-line mr-3 text-gray-400 w-4"}),"ContÃ¡ctenos"]}),e.jsx("hr",{className:"my-1"}),e.jsxs("button",{onClick:k,className:"flex items-center w-full px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition-colors cursor-pointer",children:[e.jsx("i",{className:"ri-logout-box-line mr-3 w-4"}),"Cerrar SesiÃ³n"]})]})]})]})]})]})}),x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"ContÃ¡ctenos"}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-gray-600 transition-colors cursor-pointer",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),e.jsxs("form",{onSubmit:M,className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Asunto"}),e.jsxs("select",{required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors cursor-pointer",children:[e.jsx("option",{value:"",children:"Seleccione un asunto"}),e.jsx("option",{value:"soporte_tecnico",children:"Soporte TÃ©cnico"}),e.jsx("option",{value:"consulta_comercial",children:"Consulta Comercial"}),e.jsx("option",{value:"reporte_error",children:"Reporte de Error"}),e.jsx("option",{value:"solicitud_mejora",children:"Solicitud de Mejora"}),e.jsx("option",{value:"capacitacion",children:"CapacitaciÃ³n"}),e.jsx("option",{value:"otro",children:"Otro"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prioridad"}),e.jsxs("select",{required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors cursor-pointer",children:[e.jsx("option",{value:"",children:"Seleccione prioridad"}),e.jsx("option",{value:"baja",children:"Baja"}),e.jsx("option",{value:"media",children:"Media"}),e.jsx("option",{value:"alta",children:"Alta"}),e.jsx("option",{value:"critica",children:"CrÃ­tica"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje"}),e.jsx("textarea",{required:!0,rows:4,maxLength:500,placeholder:"Describa su consulta o problema...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none transition-colors"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"MÃ¡ximo 500 caracteres"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"TelÃ©fono de contacto (opcional)"}),e.jsx("input",{type:"tel",placeholder:"Ej: +506 8888-8888",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"})]})]}),e.jsxs("div",{className:"flex space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:y,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer whitespace-nowrap",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors cursor-pointer whitespace-nowrap",children:"Enviar Mensaje"})]})]}),e.jsxs("div",{className:"px-6 pb-6 border-t border-gray-200 pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Otros medios de contacto:"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("i",{className:"ri-mail-line text-blue-500"}),e.jsx("span",{children:"soporte@sco.com"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("i",{className:"ri-phone-line text-green-500"}),e.jsx("span",{children:"+506 2222-2222"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("i",{className:"ri-whatsapp-line text-green-500"}),e.jsx("span",{children:"+506 8888-8888"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("i",{className:"ri-time-line text-orange-500"}),e.jsx("span",{children:"Lun-Vie: 8:00 AM - 6:00 PM"})]})]})]})]})}),e.jsx(C,{isOpen:m,onClose:()=>t(!1),onConfirm:()=>t(!1),title:"Mensaje Enviado",message:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mx-auto mb-4",children:e.jsx("i",{className:"ri-check-line text-2xl text-green-600"})}),e.jsx("p",{className:"text-gray-600",children:"âœ… Mensaje enviado exitosamente. Nos pondremos en contacto pronto."})]}),type:"success",confirmText:"Entendido",showCancel:!1}),e.jsx(C,{isOpen:u,type:"warning",title:"Cerrar SesiÃ³n",message:"Â¿EstÃ¡ seguro que desea cerrar sesiÃ³n? DeberÃ¡ iniciar sesiÃ³n nuevamente para acceder al sistema.",confirmText:"SÃ­, Cerrar SesiÃ³n",cancelText:"Cancelar",onConfirm:E,onCancel:()=>o(!1)})]})}export{A as S,B as T,R as u};
//# sourceMappingURL=TopBar-BLe2nnBZ.js.map
