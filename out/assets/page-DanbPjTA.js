import{r as i,s as h,j as e}from"./index-Bb3NupjY.js";import{f as G}from"./currency-BmxXlzML.js";import{P as U}from"./PermissionButton-DmJRPklx.js";import{S as J,T as K}from"./TopBar-BP5RF_Jd.js";import{M as W}from"./MobileNav-Dp72TdL_.js";function X({nombreInicial:l,onCreado:q,onCerrar:b}){const[a,y]=i.useState({codigo_articulo:"",descripcion_articulo:l,cantidad_articulo:"0",costo_articulo:"0",ganancia_articulo:"0",categoria_id:"",unidad_base_id:"10"}),[d,m]=i.useState([]),[_,I]=i.useState([]),[k,C]=i.useState(!1),[n,r]=i.useState("");i.useEffect(()=>{x()},[]);const x=async()=>{const[s,j]=await Promise.all([h.from("categorias").select("*").order("nombre"),h.from("unidades_medida").select("*").order("nombre")]);m(s.data||[]),I(j.data||[])},f=()=>{const s=Date.now().toString().slice(-6),j=Math.floor(Math.random()*100).toString().padStart(2,"0");return`ART${s}${j}`},S=async()=>{if(r(""),!a.codigo_articulo.trim())return r("El código del artículo es requerido"),!1;if(!a.descripcion_articulo.trim())return r("La descripción es requerida"),!1;if(!a.categoria_id)return r("La categoría es requerida"),!1;const s=parseFloat(a.costo_articulo),j=parseFloat(a.ganancia_articulo);if(isNaN(s)||s<0)return r("El costo debe ser un número mayor o igual a 0"),!1;if(isNaN(j)||j<0||j>100)return r("La ganancia debe ser entre 0 y 100%"),!1;const{data:p}=await h.from("inventario").select("id").ilike("codigo_articulo",a.codigo_articulo.trim()).single();return p?(r("Ya existe un artículo con este código"),!1):!0},P=async s=>{if(s.preventDefault(),!!await S()){C(!0);try{const j=parseFloat(a.costo_articulo),p=parseFloat(a.ganancia_articulo),F={codigo_articulo:a.codigo_articulo.trim(),descripcion_articulo:a.descripcion_articulo.trim(),cantidad_articulo:parseFloat(a.cantidad_articulo),costo_articulo:j,ganancia_articulo:p,categoria_id:parseInt(a.categoria_id),unidad_base_id:parseInt(a.unidad_base_id)},{data:D,error:A}=await h.from("inventario").insert(F).select(`
          *,
          categoria:categorias(nombre),
          unidad:unidades_medida(nombre, simbolo)
        `).single();if(A)throw A;q(D)}catch(j){console.error("Error creando artículo:",j),r("Error al crear el artículo")}finally{C(!1)}}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg w-full max-w-md max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Crear Nuevo Artículo"}),e.jsx("button",{onClick:b,className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),n&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4",children:n}),e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Código del Artículo *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:a.codigo_articulo,onChange:s=>y({...a,codigo_articulo:s.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ej: ART001",required:!0}),e.jsx("button",{type:"button",onClick:()=>y({...a,codigo_articulo:f()}),className:"bg-gray-100 text-gray-600 px-3 py-2 rounded-lg hover:bg-gray-200 transition-colors whitespace-nowrap",title:"Generar código automático",children:e.jsx("i",{className:"ri-refresh-line"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción *"}),e.jsx("input",{type:"text",value:a.descripcion_articulo,onChange:s=>y({...a,descripcion_articulo:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Descripción del artículo",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoría *"}),e.jsxs("select",{value:a.categoria_id,onChange:s=>y({...a,categoria_id:s.target.value}),className:"w-full px-3 py-2 pr-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Seleccionar categoría"}),d.map(s=>e.jsx("option",{value:s.id,children:s.nombre},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unidad Base *"}),e.jsx("select",{value:a.unidad_base_id,onChange:s=>y({...a,unidad_base_id:s.target.value}),className:"w-full px-3 py-2 pr-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:_.map(s=>e.jsxs("option",{value:s.id,children:[s.nombre," (",s.simbolo,")"]},s.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cantidad Inicial"}),e.jsx("input",{type:"number",step:"0.001",min:"0",value:a.cantidad_articulo,onChange:s=>y({...a,cantidad_articulo:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Costo Unitario"}),e.jsx("input",{type:"number",step:"0.0001",min:"0",value:a.costo_articulo,onChange:s=>y({...a,costo_articulo:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ganancia (%)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:a.ganancia_articulo,onChange:s=>y({...a,ganancia_articulo:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Precio final: $",(parseFloat(a.costo_articulo||"0")*(1+parseFloat(a.ganancia_articulo||"0")/100)).toFixed(2)]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:k,className:"flex-1 bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 whitespace-nowrap",children:k?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-line animate-spin mr-2"}),"Creando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Crear Artículo"]})}),e.jsx("button",{type:"button",onClick:b,className:"flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-colors whitespace-nowrap",children:"Cancelar"})]})]})]})})})}function Z({articulo:l,onConfirmar:q,onCerrar:b}){const[a,y]=i.useState("1.00"),[d,m]=i.useState(""),[_,I]=i.useState([]),[k,C]=i.useState(0),[n,r]=i.useState(1),[x,f]=i.useState("");i.useEffect(()=>{S()},[]),i.useEffect(()=>{s()},[a,d,n]);const S=async()=>{const{data:u}=await h.from("unidades_medida").select("*").order("grupo, nombre");if(I(u||[]),l.unidad&&u){const N=u.find(E=>E.nombre===l.unidad?.nombre);N&&m(N.id.toString())}},P=async u=>{if(!(!u||!l.unidad))try{const{data:N}=await h.from("unidades_medida").select("*").eq("nombre",l.unidad.nombre).single(),{data:E}=await h.from("unidades_medida").select("*").eq("id",parseInt(u)).single();if(N&&E){if(N.grupo!==E.grupo){f(`No se puede convertir de ${N.grupo} a ${E.grupo}`);return}const B=E.factor_base/N.factor_base;r(B),f("")}}catch(N){console.error("Error calculando conversión:",N),f("Error en la conversión de unidades")}},s=()=>{const u=parseFloat(a)||0,N=l.precio_articulo,E=u*n*N;C(E)},j=u=>{m(u),P(u)},p=u=>{(/^\d*\.?\d{0,2}$/.test(u)||u==="")&&y(u)},F=()=>{const u=parseFloat(a);if(!u||u<=0){f("La cantidad debe ser mayor a 0");return}if(!d){f("Selecciona una unidad");return}x||q(u,parseInt(d),k)},A=(()=>{const u={};return _.forEach(N=>{u[N.grupo]||(u[N.grupo]=[]),u[N.grupo].push(N)}),u})();return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg w-full max-w-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Configurar Componente"}),e.jsx("button",{onClick:b,className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:l.descripcion_articulo}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Código: ",l.codigo_articulo]}),l.categoria&&e.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full mt-1",children:l.categoria.nombre})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-semibold text-green-600",children:["$",l.precio_articulo.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["por ",l.unidad?.simbolo||"unidad"]})]})]})}),x&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4",children:x}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Cantidad por unidad para ",l.descripcion_articulo," *"]}),e.jsx("input",{type:"text",value:a,onChange:u=>p(u.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"1.00",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Cantidad necesaria de este componente por unidad del producto final (máximo 2 decimales)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unidad de Medida *"}),e.jsxs("select",{value:d,onChange:u=>j(u.target.value),className:"w-full px-3 py-2 pr-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Seleccionar unidad"}),Object.entries(A).map(([u,N])=>e.jsx("optgroup",{label:u.charAt(0).toUpperCase()+u.slice(1),children:N.map(E=>e.jsxs("option",{value:E.id,children:[E.nombre," (",E.simbolo,")"]},E.id))},u))]})]}),n!==1&&!x&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("i",{className:"ri-information-line mr-1"}),"Factor de conversión: ",n.toFixed(6)]}),e.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[a," ",_.find(u=>u.id===parseInt(d))?.simbolo," = ",(parseFloat(a)*n).toFixed(4)," ",l.unidad?.simbolo]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-green-900",children:"Precio Total del Componente:"}),e.jsxs("span",{className:"text-xl font-bold text-green-900",children:["$",k.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"text-xs text-green-700 mt-1",children:[a," × ",n.toFixed(4)," × $",l.precio_articulo.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6",children:[e.jsxs("button",{onClick:F,className:"flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-check-line mr-2"}),"Agregar Componente"]}),e.jsx("button",{onClick:b,className:"flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-colors whitespace-nowrap",children:"Cancelar"})]})]})})})}function ee({onSeleccionar:l,onCerrar:q}){const[b,a]=i.useState(""),[y,d]=i.useState([]),[m,_]=i.useState(!1),[I,k]=i.useState(!1),[C,n]=i.useState(!1),[r,x]=i.useState(null),f=i.useRef();i.useEffect(()=>(b.trim().length>=2?(f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{S()},300)):d([]),()=>{f.current&&clearTimeout(f.current)}),[b]);const S=async()=>{_(!0);try{const{data:p,error:F}=await h.from("inventario").select(`
          id_articulo,
          codigo_articulo,
          descripcion_articulo,
          precio_articulo,
          categoria:categorias(nombre),
          unidad:unidades_medida(nombre, simbolo)
        `).or(`descripcion_articulo.ilike.%${b}%,codigo_articulo.ilike.%${b}%,id_articulo.eq.${isNaN(parseInt(b))?0:parseInt(b)}`).limit(10);if(F)throw F;d(p||[])}catch(p){console.error("Error buscando artículos:",p)}finally{_(!1)}},P=p=>{x(p),n(!0)},s=(p,F,D)=>{r&&l(r,p,F,D)},j=p=>{k(!1),x(p),n(!0)};return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:[e.jsx("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[80vh] overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Buscar o Crear Artículo/Servicio"}),e.jsx("button",{onClick:q,className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("i",{className:"ri-search-line text-gray-400"})}),e.jsx("input",{type:"text",value:b,onChange:p=>a(p.target.value),placeholder:"Buscar por nombre, ID o Código...",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",autoFocus:!0}),m&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"})})]}),e.jsxs("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:[b.trim().length<2&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"ri-search-line text-3xl mb-2"}),e.jsx("p",{children:"Escribe al menos 2 caracteres para buscar"})]}),b.trim().length>=2&&y.length===0&&!m&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("i",{className:"ri-file-search-line text-3xl text-gray-400 mb-2"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No se encontraron artículos"}),e.jsxs("button",{onClick:()=>k(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Crear Nuevo Artículo"]})]}),y.map(p=>e.jsx("div",{onClick:()=>P(p),className:"p-4 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 cursor-pointer transition-colors",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-gray-900",children:p.descripcion_articulo}),p.categoria&&e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:p.categoria.nombre})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Código: ",p.codigo_articulo," | ID: ",p.id_articulo]}),p.unidad&&e.jsxs("div",{className:"text-xs text-gray-400",children:["Unidad base: ",p.unidad.nombre," (",p.unidad.simbolo,")"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-semibold text-green-600",children:["$",p.precio_articulo.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("div",{className:"text-xs text-gray-500",children:"por unidad"})]})]})},p.id_articulo))]}),b.trim().length>=2&&y.length>0&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("button",{onClick:()=>k(!0),className:"w-full bg-gray-100 text-gray-700 py-2 rounded-lg hover:bg-gray-200 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"¿No encuentras lo que buscas? Crear nuevo artículo"]})})]})}),I&&e.jsx(X,{nombreInicial:b,onCreado:j,onCerrar:()=>k(!1)}),C&&r&&e.jsx(Z,{articulo:r,onConfirmar:s,onCerrar:()=>{n(!1),x(null)}})]})}function te({items:l,onEliminar:q,onEditar:b}){const[a,y]=i.useState(null),[d,m]=i.useState({cantidad:"",unidadId:"",precioAjustado:0}),_=(n,r,x)=>{n.preventDefault(),n.stopPropagation(),y(r),m({cantidad:x.cantidad_x_unidad.toString(),unidadId:x.unidad_id.toString(),precioAjustado:x.precio_ajustado})},I=n=>{if(n.preventDefault(),n.stopPropagation(),a!==null){const r=parseFloat(d.cantidad),x=parseInt(d.unidadId);r>0&&x&&(b(a,r,x,d.precioAjustado),k())}},k=n=>{n&&(n.preventDefault(),n.stopPropagation()),y(null),m({cantidad:"",unidadId:"",precioAjustado:0})},C=(n,r)=>{n.preventDefault(),n.stopPropagation(),q(r)};return l.length===0?e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[e.jsx("i",{className:"ri-list-check-line text-3xl text-gray-400 mb-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"Sin componentes BOM"}),e.jsx("p",{className:"text-gray-500",children:"Agrega componentes para construir la lista de materiales"})]}):e.jsx("div",{className:"bg-white rounded-lg border overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Componente"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cantidad"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unidad"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Categoría"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Precio Unitario"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((n,r)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:n.id_componente}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:n.nombre_componente})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:a===r?e.jsx("input",{type:"number",step:"0.0001",min:"0.0001",value:d.cantidad,onChange:x=>m({...d,cantidad:x.target.value}),className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",onClick:x=>x.stopPropagation()}):e.jsx("div",{className:"text-sm text-gray-900",children:n.cantidad_x_unidad.toLocaleString("es-ES",{minimumFractionDigits:4,maximumFractionDigits:4})})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:n.unidad_simbolo||n.unidad_nombre})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:n.categoria_nombre&&e.jsx("span",{className:"bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded-full",children:n.categoria_nombre})}),e.jsxs("td",{className:"px-4 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-green-600",children:G(n.precio_ajustado)}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Base: ",G(n.precio_unitario_base)]})]}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right text-sm font-medium",children:a===r?e.jsxs("div",{className:"flex gap-1 justify-end",children:[e.jsx("button",{type:"button",onClick:I,className:"text-green-600 hover:text-green-900 p-1",title:"Guardar",children:e.jsx("i",{className:"ri-check-line"})}),e.jsx("button",{type:"button",onClick:k,className:"text-gray-600 hover:text-gray-900 p-1",title:"Cancelar",children:e.jsx("i",{className:"ri-close-line"})})]}):e.jsxs("div",{className:"flex gap-1 justify-end",children:[e.jsx("button",{type:"button",onClick:x=>_(x,r,n),className:"text-blue-600 hover:text-blue-900 p-1",title:"Editar",children:e.jsx("i",{className:"ri-edit-line"})}),e.jsx("button",{type:"button",onClick:x=>C(x,r),className:"text-red-600 hover:text-red-900 p-1",title:"Eliminar",children:e.jsx("i",{className:"ri-delete-bin-line"})})]})})]},r))})]})})})}function ae({producto:l,onGuardar:q,onCerrar:b}){const a=l,y=q,d=b,[m,_]=i.useState({codigo_producto:"",descripcion_producto:"",categoria_id:"",codigo_sistema:""}),[I,k]=i.useState([]),[C,n]=i.useState([]),[r,x]=i.useState(!1),[f,S]=i.useState(!1),[P,s]=i.useState(""),[j,p]=i.useState(0);i.useEffect(()=>{F(),a?(_({codigo_producto:a.codigo_producto||"",descripcion_producto:a.descripcion_producto||"",categoria_id:a.categoria_id?.toString()||"",codigo_sistema:a.codigo_sistema||""}),u(a.id_producto)):(A(),n([]))},[a]),i.useEffect(()=>{N()},[C]);const F=async()=>{const{data:t}=await h.from("categorias").select("*").order("nombre");k(t||[])},D=async()=>{try{const{data:t}=await h.from("productos").select("codigo_sistema").not("codigo_sistema","is",null).order("codigo_sistema",{ascending:!1}).limit(1);let c=1;if(t&&t.length>0&&t[0].codigo_sistema){const v=t[0].codigo_sistema,M=parseInt(v);isNaN(M)||(c=M+1)}let g=!1,w=0,o="";for(;!g&&w<100;){o=(c+w).toString().padStart(6,"0");const{data:v}=await h.from("productos").select("id_producto").eq("codigo_sistema",o).single();v?w++:g=!0}_(v=>({...v,codigo_sistema:o}))}catch(t){console.error("Error generando código de sistema:",t),_(c=>({...c,codigo_sistema:Date.now().toString().slice(-6)}))}},A=async()=>{try{const{data:t}=await h.from("productos").select("codigo_producto").like("codigo_producto","PROD-%").order("codigo_producto",{ascending:!1}).limit(1);let c=1;if(t&&t.length>0&&t[0].codigo_producto){const M=t[0].codigo_producto.match(/PROD-(\d+)/);if(M){const O=parseInt(M[1]);isNaN(O)||(c=O+1)}}let g=!1,w=0,o="";for(;!g&&w<100;){o=`PROD-${(c+w).toString().padStart(3,"0")}`;const{data:v}=await h.from("productos").select("id_producto").eq("codigo_producto",o).single();v?w++:g=!0}_(v=>({...v,codigo_producto:o}))}catch(t){console.error("Error generando código de producto:",t);const c=Date.now().toString().slice(-6);_(g=>({...g,codigo_producto:`PROD-${c}`}))}},u=async t=>{try{const{data:c,error:g}=await h.from("bom_items").select(`
          *,
          inventario:inventario!id_componente(descripcion_articulo, categoria:categorias(nombre)),
          unidad_medida:unidades_medida!unidad_id(nombre, simbolo)
        `).eq("product_id",t);if(g){console.error("Error cargando BOM items:",g);return}if(c){const w=c.map(o=>({id:o.id,id_componente:o.id_componente,nombre_componente:o.nombre_componente,cantidad_x_unidad:o.cantidad_x_unidad,unidad_id:o.unidad_id,precio_unitario_base:o.precio_unitario_base,precio_ajustado:o.precio_ajustado,categoria_nombre:o.inventario?.categoria?.nombre,unidad_nombre:o.unidad_medida?.nombre,unidad_simbolo:o.unidad_medida?.simbolo}));n(w)}}catch(c){console.error("Error cargando componentes BOM:",c)}},N=()=>{const t=C.reduce((c,g)=>c+g.precio_ajustado,0);p(t)},E=async()=>{if(s(""),!m.codigo_producto.trim())return s("El código del producto es requerido"),!1;if(!m.descripcion_producto.trim())return s("La descripción del producto es requerida"),!1;if(!m.categoria_id||m.categoria_id==="")return s("La categoría es requerida"),!1;if(!a||m.codigo_producto!==a.codigo_producto)try{const{data:t}=await h.from("productos").select("id_producto").eq("codigo_producto",m.codigo_producto).maybeSingle();if(t&&(!a||t.id_producto!==a.id_producto))return s("El código de producto ya existe. Generando uno nuevo..."),await A(),!1}catch(t){console.error("Error validando código:",t)}if(m.codigo_sistema)try{const{data:t}=await h.from("productos").select("id_producto").eq("codigo_sistema",m.codigo_sistema).maybeSingle();if(t&&(!a||t.id_producto!==a.id_producto))return s("El código de sistema ya existe. Generando uno nuevo..."),await D(),!1}catch(t){console.error("Error validando código de sistema:",t)}return!0},B=t=>({1:"Uni",2:"kg",3:"g",4:"m",5:"cm",6:"mm",7:"h",8:"min",9:"s",10:"Uni"})[t]||"Uni",T=async t=>{t.preventDefault(),S(!0),s("");try{if(!await E()){S(!1);return}let g;if(a){const{data:w,error:o}=await h.from("productos").update({codigo_producto:m.codigo_producto,descripcion_producto:m.descripcion_producto,categoria_id:parseInt(m.categoria_id),codigo_sistema:m.codigo_sistema,costo_total_bom:j}).eq("id_producto",a.id_producto).select().single();if(o)throw o;g=w.id_producto;const{error:v}=await h.from("bom_items").delete().eq("product_id",g);if(v)throw v}else{const{data:w,error:o}=await h.from("productos").insert({codigo_producto:m.codigo_producto,descripcion_producto:m.descripcion_producto,categoria_id:parseInt(m.categoria_id),codigo_sistema:m.codigo_sistema,costo_total_bom:j}).select().single();if(o)throw o;g=w.id_producto}if(C.length>0){const w=C.map(v=>({product_id:g,id_componente:v.id_componente,nombre_componente:v.nombre_componente,cantidad_x_unidad:v.cantidad_x_unidad,unidad_id:v.unidad_id,unidad:B(v.unidad_id),precio_unitario_base:v.precio_unitario_base,precio_ajustado:v.precio_ajustado})),{error:o}=await h.from("bom_items").insert(w);if(o)throw o}y(),d()}catch(c){console.error("Error guardando producto:",c),s("Error al guardar el producto. Por favor, intenta nuevamente.")}finally{S(!1)}},$=(t,c,g,w)=>{if(!t?.id_articulo||!g||c<=0){s("Datos incompletos para agregar el componente");return}const o={id_componente:t.id_articulo,nombre_componente:t.descripcion_articulo,cantidad_x_unidad:c,unidad_id:g,precio_unitario_base:t.precio_articulo,precio_ajustado:w,categoria_nombre:t.categoria?.nombre,unidad_nombre:t.unidad?.nombre,unidad_simbolo:t.unidad?.simbolo};n([...C,o]),x(!1)},R=t=>{n(C.filter((c,g)=>g!==t))},L=(t,c,g,w)=>{const o=[...C];t>=0&&t<o.length&&(o[t]={...o[t],cantidad_x_unidad:c,unidad_id:g,precio_ajustado:w},n(o))};return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:[e.jsx("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:l?"Editar Producto":"Nuevo Producto"}),e.jsx("button",{onClick:b,className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),P&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4",children:P}),e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Código del Producto * (Autoincremental)"}),e.jsx("input",{type:"text",value:m.codigo_producto,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600 cursor-not-allowed",placeholder:"Se genera automáticamente"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Este código se genera automáticamente (PROD-001, PROD-002, etc.)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoría *"}),e.jsxs("select",{value:m.categoria_id,onChange:t=>_({...m,categoria_id:t.target.value}),className:"w-full px-3 py-2 pr-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Seleccionar categoría"}),I.map(t=>e.jsx("option",{value:t.id,children:t.nombre},t.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción del Producto *"}),e.jsx("textarea",{value:m.descripcion_producto,onChange:t=>_({...m,descripcion_producto:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,required:!0,placeholder:"Descripción detallada del producto"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Código de Sistema ",!l&&"*"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:m.codigo_sistema,onChange:t=>_({...m,codigo_sistema:t.target.value}),readOnly:!!l,className:`flex-1 px-3 py-2 border border-gray-300 rounded-lg ${l?"bg-gray-50 text-gray-600 cursor-not-allowed":"focus:ring-2 focus:ring-blue-500 focus:border-transparent"}`,placeholder:l?"Código asignado":"Ingrese código de sistema",required:!l}),!l&&e.jsx("button",{type:"button",onClick:D,className:"bg-blue-100 text-blue-600 px-3 py-2 rounded-lg hover:bg-blue-200 transition-colors whitespace-nowrap",title:"Generar código automático",children:e.jsx("i",{className:"ri-refresh-line"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:l?"El código de sistema no se puede modificar al editar":"Ingrese un código único o genere uno automáticamente"})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Lista de Materiales (BOM)"}),e.jsxs("button",{type:"button",onClick:()=>x(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Agregar Componente"]})]}),e.jsx(te,{items:C,onEliminar:R,onEditar:L}),C.length>0&&e.jsxs("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-blue-900",children:"Costo Total del Producto:"}),e.jsx("span",{className:"text-xl font-bold text-blue-900",children:G(j)})]}),e.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Suma de todos los componentes BOM"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsx("button",{type:"submit",disabled:f,className:"flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-770 transition-colors disabled:opacity-50 whitespace-nowrap",children:f?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-line animate-spin mr-2"}),"Guardando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-save-line mr-2"}),l?"Actualizar":"Crear"," Producto"]})}),e.jsx("button",{type:"button",onClick:b,className:"flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-colors whitespace-nowrap",children:"Cancelar"})]})]})]})}),r&&e.jsx(ee,{onSeleccionar:$,onCerrar:()=>x(!1)})]})}function re({productos:l,loading:q,onEdit:b,onEliminar:a,onInactivar:y}){return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Código"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descripción"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Categoría"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Código Sistema"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Costo Total BOM"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha Creación"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(d=>e.jsxs("tr",{className:`border-b hover:bg-gray-50 ${d.activo?"":"bg-red-50"}`,children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${d.activo?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:d.activo?"Activo":"Inactivo"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.codigo_producto}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:d.descripcion_producto||d.descripcion}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.categorias?.nombre||d.categoria?.nombre||"Sin categoría"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.codigo_sistema||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Intl.NumberFormat("es-CR",{style:"currency",currency:"CRC",minimumFractionDigits:2,maximumFractionDigits:2}).format(d.costo_total_bom||0)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.created_at?new Date(d.created_at).toLocaleDateString("es-ES"):"Sin fecha"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"flex space-x-2 justify-end",children:[e.jsx(U,{permission:"productos:edit",variant:"icon",onClick:()=>b(d),title:"Editar producto",className:"text-blue-600 hover:bg-blue-50",children:e.jsx("i",{className:"ri-edit-line w-4 h-4 flex items-center justify-center"})}),e.jsx(U,{permission:"productos:edit",variant:"icon",onClick:()=>y(d.id_producto),title:d.activo?"Inactivar producto":"Activar producto",className:d.activo?"text-orange-600 hover:bg-orange-50":"text-green-600 hover:bg-green-50",children:e.jsx("i",{className:`${d.activo?"ri-pause-line":"ri-play-line"} w-4 h-4 flex items-center justify-center`})}),e.jsx(U,{permission:"productos:delete",variant:"icon",onClick:()=>a(d.id_producto),title:"Eliminar permanentemente",className:"text-red-600 hover:bg-red-50",children:e.jsx("i",{className:"ri-delete-bin-line w-4 h-4 flex items-center justify-center"})})]})})]},d.id_producto))})]})})}function V({children:l}){const[q,b]=i.useState(!1);return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[e.jsx(J,{isOpen:q,onClose:()=>b(!1)}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsx(K,{onMenuClick:()=>b(!0)}),e.jsx("main",{className:"flex-1 p-4 lg:p-6 pb-20 lg:pb-6 overflow-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:l})})]}),e.jsx(W,{})]})}function de(){const[l,q]=i.useState([]),[b,a]=i.useState(!0),[y,d]=i.useState(!1),[m,_]=i.useState(null),[I,k]=i.useState([]),[C,n]=i.useState(0),[r,x]=i.useState({busqueda:"",categoria:null,mostrarInactivos:!1,ordenar:"codigo_producto"}),[f,S]=i.useState(1),[P,s]=i.useState(10),[j,p]=i.useState(0);i.useEffect(()=>{D(),F()},[]),i.useEffect(()=>{D()},[r.busqueda,r.categoria,r.mostrarInactivos,r.ordenar,C,f,P]);const F=async()=>{const{data:t}=await h.from("categorias").select("*").order("nombre");k(t||[])},D=async()=>{a(!0);try{let t=h.from("productos").select("*",{count:"exact",head:!0});r.busqueda.trim()&&(t=t.or(`codigo_producto.ilike.%${r.busqueda}%,descripcion_producto.ilike.%${r.busqueda}%,codigo_sistema.ilike.%${r.busqueda}%`)),r.categoria&&(t=t.eq("categoria_id",r.categoria)),r.mostrarInactivos||(t=t.eq("activo",!0));const{count:c}=await t;p(c||0);const g=(f-1)*P,w=g+P-1;let o=h.from("productos").select(`
          *,
          categorias(nombre),
          costo_total_bom:bom_items(precio_ajustado)
        `).range(g,w);r.busqueda.trim()&&(o=o.or(`codigo_producto.ilike.%${r.busqueda}%,descripcion_producto.ilike.%${r.busqueda}%,codigo_sistema.ilike.%${r.busqueda}%`)),r.categoria&&(o=o.eq("categoria_id",r.categoria)),r.mostrarInactivos||(o=o.eq("activo",!0)),o=o.order(r.ordenar);const{data:v,error:M}=await o;if(M)throw M;const O=(v||[]).map(z=>{const H=z.costo_total_bom?.reduce((Q,Y)=>Q+(Y.precio_ajustado||0),0)||0;return{...z,costo_total_bom:H}});q(O||[])}catch(t){console.error("Error cargando productos:",t)}finally{a(!1)}},A=t=>{x(c=>({...c,busqueda:t})),S(1)},u=async t=>{if(confirm("¿Estás seguro de eliminar permanentemente este producto? Esta acción no se puede deshacer."))try{const{data:c}=await h.from("bom_items").select("id").eq("producto_id",t);if(c&&c.length>0){alert("No se puede eliminar este producto porque tiene componentes BOM asociados. Considera inactivarlo en su lugar.");return}const{error:g}=await h.from("productos").delete().eq("id_producto",t);if(g)throw g;D(),alert("Producto eliminado exitosamente")}catch(c){console.error("Error eliminando producto:",c),alert("Error al eliminar el producto")}},N=async t=>{try{const{data:c}=await h.from("productos").select("activo").eq("id_producto",t).single(),g=!c?.activo;if(!confirm(`¿Estás seguro de ${g?"activar":"inactivar"} este producto?`))return;const{error:o}=await h.from("productos").update({activo:g}).eq("id_producto",t);if(o)throw o;await D(),alert(`Producto ${g?"activado":"inactivado"} correctamente`)}catch(c){console.error("Error cambiando estado del producto:",c),alert("Error al cambiar el estado del producto")}},E=t=>{_(t),d(!0)},B=()=>{d(!1),_(null)},T=()=>{D(),B()},$=Math.ceil(j/P),R=j===0?0:(f-1)*P+1,L=Math.min(f*P,j);return b&&l.length===0?e.jsx(V,{children:e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):e.jsx(V,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestión de Productos"}),e.jsxs(U,{permission:"productos:create",variant:"primary",onClick:()=>d(!0),children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Nuevo Producto"]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buscar"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:r.busqueda,onChange:t=>A(t.target.value),placeholder:"Código, descripción o código sistema...",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),b&&r.busqueda&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoría"}),e.jsxs("select",{value:r.categoria||"",onChange:t=>{x(c=>({...c,categoria:t.target.value?parseInt(t.target.value):null})),S(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8",children:[e.jsx("option",{value:"",children:"Todas las categorías"}),I.map(t=>e.jsx("option",{value:t.id,children:t.nombre},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ordenar por"}),e.jsxs("select",{value:r.ordenar,onChange:t=>x(c=>({...c,ordenar:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8",children:[e.jsx("option",{value:"codigo_producto",children:"Código Producto"}),e.jsx("option",{value:"descripcion_producto",children:"Descripción"}),e.jsx("option",{value:"codigo_sistema",children:"Código Sistema"}),e.jsx("option",{value:"created_at",children:"Fecha Creación"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.mostrarInactivos,onChange:t=>{x(c=>({...c,mostrarInactivos:t.target.checked})),S(1)},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Mostrar inactivos"})]})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Mostrar"}),e.jsxs("select",{value:P,onChange:t=>{s(Number(t.target.value)),S(1)},className:"px-3 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]}),e.jsx("span",{className:"text-sm text-gray-700",children:"registros"})]}),e.jsxs("div",{className:"text-sm text-gray-700",children:["Mostrando ",R," a ",L," de ",j," registros"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>S(1),disabled:f===1,className:"px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"Primera página",children:e.jsx("i",{className:"ri-skip-back-mini-line"})}),e.jsx("button",{onClick:()=>S(t=>Math.max(1,t-1)),disabled:f===1,className:"px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"Página anterior",children:e.jsx("i",{className:"ri-arrow-left-s-line"})}),e.jsxs("span",{className:"px-4 py-1 text-sm text-gray-700",children:["Página ",f," de ",$||1]}),e.jsx("button",{onClick:()=>S(t=>Math.min($,t+1)),disabled:f>=$,className:"px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"Página siguiente",children:e.jsx("i",{className:"ri-arrow-right-s-line"})}),e.jsx("button",{onClick:()=>S($),disabled:f>=$,className:"px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"Última página",children:e.jsx("i",{className:"ri-skip-forward-mini-line"})})]})]})}),y&&e.jsx(ae,{producto:m,onGuardar:T,onCerrar:()=>{d(!1),_(null)}}),e.jsx(re,{productos:l,loading:b,onEdit:E,onInactivar:N,onEliminar:u})]})})}export{de as default};
//# sourceMappingURL=page-DanbPjTA.js.map
