{"version":3,"file":"PermissionButton-BMmIwIyf.js","sources":["../../src/components/base/PermissionButton.tsx"],"sourcesContent":["\nimport { ReactNode } from 'react';\nimport { useAuth } from '../../hooks/useAuth';\n\ninterface PermissionButtonProps {\n  permission?: string;\n  permissions?: string[];\n  requireAll?: boolean;\n  hideIfNoPermission?: boolean;\n  variant?: 'primary' | 'secondary' | 'danger' | 'success' | 'warning' | 'icon';\n  className?: string;\n  onClick?: () => void;\n  disabled?: boolean;\n  type?: 'button' | 'submit' | 'reset';\n  title?: string;\n  children: ReactNode;\n}\n\nexport function PermissionButton({\n  permission,\n  permissions,\n  requireAll = false,\n  hideIfNoPermission = true,\n  variant = 'primary',\n  className = '',\n  onClick,\n  disabled = false,\n  type = 'button',\n  title,\n  children,\n}: PermissionButtonProps) {\n  const { hasPermission, hasAnyPermission, hasAllPermissions, loading, isAuthenticated } = useAuth();\n\n  // SEGURIDAD CRÍTICA: Verificar autenticación primero\n  if (!isAuthenticated) {\n    if (hideIfNoPermission) return null;\n    return (\n      <button type=\"button\" disabled className={`inline-flex items-center justify-center transition-colors whitespace-nowrap cursor-not-allowed opacity-50 ${getVariantClasses(variant)} ${className}`}>\n        {children}\n      </button>\n    );\n  }\n\n  const hasAccess = () => {\n    if (permission) return hasPermission(permission);\n    if (permissions?.length) {\n      return requireAll ? hasAllPermissions(permissions) : hasAnyPermission(permissions);\n    }\n    return true;\n  };\n\n  if (loading) {\n    return (\n      <button type=\"button\" disabled className={`inline-flex items-center justify-center transition-colors whitespace-nowrap cursor-not-allowed opacity-50 ${getVariantClasses(variant)} ${className}`}>\n        {children}\n      </button>\n    );\n  }\n\n  const access = hasAccess();\n  \n  // SEGURIDAD CRÍTICA: Si no tiene permisos, ocultar o deshabilitar completamente\n  if (!access) {\n    if (hideIfNoPermission) return null;\n    \n    return (\n      <button \n        type=\"button\" \n        disabled \n        title=\"No tienes permisos para esta acción\"\n        className={`inline-flex items-center justify-center transition-colors whitespace-nowrap cursor-not-allowed opacity-30 ${getVariantClasses(variant)} ${className}`}\n      >\n        {children}\n      </button>\n    );\n  }\n\n  return (\n    <button\n      type={type}\n      onClick={access ? onClick : undefined} // SEGURIDAD: Solo ejecutar si tiene permisos\n      disabled={disabled || !access}\n      title={title}\n      className={`inline-flex items-center justify-center transition-colors whitespace-nowrap cursor-pointer disabled:cursor-not-allowed ${getVariantClasses(variant)} ${className}`}\n    >\n      {children}\n    </button>\n  );\n}\n\n// Función auxiliar para obtener clases de variantes\nfunction getVariantClasses(variant: string): string {\n  const variants = {\n    primary: 'bg-blue-600 text-white hover:bg-blue-700 disabled:bg-gray-300 disabled:text-gray-500 px-4 py-2 text-sm font-medium rounded-lg',\n    secondary: 'bg-gray-600 text-white hover:bg-gray-700 disabled:bg-gray-300 disabled:text-gray-500 px-4 py-2 text-sm font-medium rounded-lg',\n    danger: 'bg-red-600 text-white hover:bg-red-700 disabled:bg-gray-300 disabled:text-gray-500 px-4 py-2 text-sm font-medium rounded-lg',\n    success: 'bg-green-600 text-white hover:bg-green-700 disabled:bg-gray-300 disabled:text-gray-500 px-4 py-2 text-sm font-medium rounded-lg',\n    warning: 'bg-yellow-600 text-white hover:bg-yellow-700 disabled:bg-gray-300 disabled:text-gray-500 px-4 py-2 text-sm font-medium rounded-lg',\n    icon: 'p-1 rounded hover:bg-opacity-10 disabled:opacity-50',\n  };\n\n  return variants[variant as keyof typeof variants] || variants.primary;\n}\n"],"names":["PermissionButton","permission","permissions","requireAll","hideIfNoPermission","variant","className","onClick","disabled","type","title","children","hasPermission","hasAnyPermission","hasAllPermissions","loading","isAuthenticated","useAuth","jsx","getVariantClasses","hasAccess","access","variants"],"mappings":"+CAkBO,SAASA,EAAiB,CAC/B,WAAAC,EACA,YAAAC,EACA,WAAAC,EAAa,GACb,mBAAAC,EAAqB,GACrB,QAAAC,EAAU,UACV,UAAAC,EAAY,GACZ,QAAAC,EACA,SAAAC,EAAW,GACX,KAAAC,EAAO,SACP,MAAAC,EACA,SAAAC,CACF,EAA0B,CACxB,KAAM,CAAE,cAAAC,EAAe,iBAAAC,EAAkB,kBAAAC,EAAmB,QAAAC,EAAS,gBAAAC,CAAA,EAAoBC,EAAA,EAGzF,GAAI,CAACD,EACH,OAAIZ,EAA2B,KAE7Bc,EAAAA,IAAC,SAAA,CAAO,KAAK,SAAS,SAAQ,GAAC,UAAW,6GAA6GC,EAAkBd,CAAO,CAAC,IAAIC,CAAS,GAC3L,SAAAK,EACH,EAIJ,MAAMS,EAAY,IACZnB,EAAmBW,EAAcX,CAAU,EAC3CC,GAAa,OACRC,EAAaW,EAAkBZ,CAAW,EAAIW,EAAiBX,CAAW,EAE5E,GAGT,GAAIa,EACF,OACEG,EAAAA,IAAC,SAAA,CAAO,KAAK,SAAS,SAAQ,GAAC,UAAW,6GAA6GC,EAAkBd,CAAO,CAAC,IAAIC,CAAS,GAC3L,SAAAK,EACH,EAIJ,MAAMU,EAASD,EAAA,EAGf,OAAKC,EAgBHH,EAAAA,IAAC,SAAA,CACC,KAAAT,EACA,QAASY,EAASd,EAAU,OAC5B,SAAUC,GAAY,CAACa,EACvB,MAAAX,EACA,UAAW,0HAA0HS,EAAkBd,CAAO,CAAC,IAAIC,CAAS,GAE3K,SAAAK,CAAA,CAAA,EAtBCP,EAA2B,KAG7Bc,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,SAAQ,GACR,MAAM,sCACN,UAAW,6GAA6GC,EAAkBd,CAAO,CAAC,IAAIC,CAAS,GAE9J,SAAAK,CAAA,CAAA,CAgBT,CAGA,SAASQ,EAAkBd,EAAyB,CAClD,MAAMiB,EAAW,CACf,QAAS,gIACT,UAAW,gIACX,OAAQ,8HACR,QAAS,kIACT,QAAS,oIACT,KAAM,qDAAA,EAGR,OAAOA,EAASjB,CAAgC,GAAKiB,EAAS,OAChE"}