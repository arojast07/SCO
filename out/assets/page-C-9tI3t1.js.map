{"version":3,"file":"page-C-9tI3t1.js","sources":["../../src/pages/seguridad/components/SeguridadLayout.tsx","../../src/pages/seguridad/components/UsuarioForm.tsx","../../src/services/usuariosPendientesService.ts","../../src/pages/seguridad/components/AsignarTiendaModal.tsx","../../src/pages/seguridad/components/UsuariosTab.tsx","../../src/pages/seguridad/components/UsuariosPendientesTab.tsx","../../src/pages/seguridad/components/RolForm.tsx","../../src/pages/seguridad/components/RolesTab.tsx","../../src/pages/seguridad/components/PermisoForm.tsx","../../src/pages/seguridad/components/PermisosTab.tsx","../../src/components/security/PermissionMatrix.tsx","../../src/components/base/PermissionWrapper.tsx","../../src/pages/seguridad/page.tsx"],"sourcesContent":["import { ReactNode, useState } from 'react';\nimport Sidebar from '../../../components/feature/Sidebar';\nimport TopBar from '../../../components/feature/TopBar';\nimport MobileNav from '../../../components/feature/MobileNav';\n\ninterface SeguridadLayoutProps {\n  children: ReactNode;\n}\n\nexport function SeguridadLayout({ children }: SeguridadLayoutProps) {\n  const [sidebarOpen, setSidebarOpen] = useState(false);\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex\">\n      {/* Sidebar */}\n      <Sidebar isOpen={sidebarOpen} onClose={() => setSidebarOpen(false)} />\n\n      {/* Contenido principal */}\n      <div className=\"flex-1 flex flex-col min-w-0\">\n        {/* TopBar */}\n        <TopBar onMenuClick={() => setSidebarOpen(true)} />\n        \n        {/* Contenido */}\n        <main className=\"flex-1 p-4 lg:p-6 pb-20 lg:pb-6 overflow-auto\">\n          <div className=\"max-w-7xl mx-auto\">\n            {children}\n          </div>\n        </main>\n      </div>\n\n      {/* Navegaci√≥n m√≥vil */}\n      <MobileNav />\n    </div>\n  );\n}\n","import { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\n\ninterface Usuario {\n  id: string;\n  email: string;\n  nombre_completo: string;\n  rol: string;\n  activo: boolean;\n  created_at: string;\n  updated_at: string;\n}\n\n// ‚úÖ Nueva interfaz para tiendas\ninterface Tienda {\n  id: string;\n  nombre: string;\n}\n\ninterface UsuarioFormProps {\n  usuario: Usuario | null;\n  onClose: () => void;\n  onSave: () => void;\n}\n\n// ‚úÖ Cambio de export default a export nombrado\nexport function UsuarioForm({ usuario, onClose, onSave }: UsuarioFormProps) {\n  const [formData, setFormData] = useState({\n    email: '',\n    nombre_completo: '',\n    rol: 'Usuario',\n    activo: true,\n    tienda_id: '', // ‚úÖ Nueva propiedad para la tienda\n  });\n  const [roles, setRoles] = useState<string[]>([]);\n  const [tiendas, setTiendas] = useState<Tienda[]>([]); // ‚úÖ Estado para tiendas\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    cargarRoles();\n    cargarTiendas(); // ‚úÖ Cargar tiendas disponibles\n    if (usuario) {\n      cargarTiendaActual(usuario.id); // ‚úÖ Cargar tienda actual del usuario\n    }\n  }, [usuario]);\n\n  const cargarRoles = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('roles')\n        .select('nombre')\n        .order('nombre');\n\n      if (error) throw error;\n      \n      const rolesArray = data?.map(r => r.nombre) || ['Admin', 'Usuario', 'Supervisor'];\n      setRoles(rolesArray);\n    } catch (error) {\n      console.error('Error cargando roles:', error);\n      setRoles(['Admin', 'Usuario', 'Supervisor']);\n    }\n  };\n\n  // ‚úÖ Nueva funci√≥n para cargar tiendas\n  const cargarTiendas = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('tiendas')\n        .select('id, nombre')\n        .eq('activo', true)\n        .order('nombre');\n\n      if (error) throw error;\n      \n      setTiendas(data || []);\n    } catch (error) {\n      console.error('Error cargando tiendas:', error);\n    }\n  };\n\n  // ‚úÖ Nueva funci√≥n para cargar la tienda actual del usuario\n  const cargarTiendaActual = async (usuarioId: string) => {\n    try {\n      const { data, error } = await supabase\n        .from('usuario_tienda_actual')\n        .select('tienda_id')\n        .eq('usuario_id', usuarioId)\n        .single();\n\n      if (error && error.code !== 'PGRST116') throw error; // Ignorar error si no existe\n      \n      setFormData(prev => ({\n        ...prev,\n        email: usuario!.email,\n        nombre_completo: usuario!.nombre_completo,\n        rol: usuario!.rol,\n        activo: usuario!.activo,\n        tienda_id: data?.tienda_id || '',\n      }));\n    } catch (error) {\n      console.error('Error cargando tienda actual:', error);\n      // Si hay error, solo cargar datos b√°sicos del usuario\n      setFormData({\n        email: usuario!.email,\n        nombre_completo: usuario!.nombre_completo,\n        rol: usuario!.rol,\n        activo: usuario!.activo,\n        tienda_id: '',\n      });\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError('');\n    setLoading(true);\n\n    try {\n      if (usuario) {\n        // Actualizar usuario existente\n        const { error } = await supabase\n          .from('usuarios')\n          .update({\n            nombre_completo: formData.nombre_completo,\n            rol: formData.rol,\n            activo: formData.activo,\n            updated_at: new Date().toISOString(),\n          })\n          .eq('id', usuario.id);\n\n        if (error) throw error;\n\n        // ‚úÖ Actualizar tienda asignada\n        if (formData.tienda_id) {\n          // Primero verificar si el usuario tiene acceso a esta tienda\n          const { data: tiendaAcceso, error: accesoError } = await supabase\n            .from('usuario_tiendas')\n            .select('tienda_id')\n            .eq('usuario_id', usuario.id)\n            .eq('tienda_id', formData.tienda_id)\n            .maybeSingle();\n\n          // Si no tiene acceso, agregarlo\n          if (!tiendaAcceso) {\n            const { error: insertAccesoError } = await supabase\n              .from('usuario_tiendas')\n              .insert({\n                usuario_id: usuario.id,\n                tienda_id: formData.tienda_id,\n                activo: true,\n              });\n\n            if (insertAccesoError) {\n              console.error('Error agregando acceso a tienda:', insertAccesoError);\n              throw new Error(`No se pudo agregar acceso a la tienda: ${insertAccesoError.message}`);\n            }\n          }\n\n          // Actualizar tienda actual\n          const { error: tiendaError } = await supabase\n            .from('usuario_tienda_actual')\n            .upsert({\n              usuario_id: usuario.id,\n              tienda_id: formData.tienda_id,\n            }, {\n              onConflict: 'usuario_id'\n            });\n\n          if (tiendaError) {\n            console.error('Error actualizando tienda actual:', tiendaError);\n            \n            // Mensaje de error m√°s claro\n            if (tiendaError.code === '42501') {\n              throw new Error(\n                'No tienes permisos para asignar tiendas. ' +\n                'Por favor, ejecuta el script SQL: sql_fix_rls_usuario_tienda_actual_admin.sql ' +\n                'en Supabase Dashboard > SQL Editor'\n              );\n            }\n            \n            throw new Error(`Error al asignar tienda: ${tiendaError.message}`);\n          }\n        } else {\n          // Si no hay tienda seleccionada, eliminar la tienda actual\n          const { error: deleteError } = await supabase\n            .from('usuario_tienda_actual')\n            .delete()\n            .eq('usuario_id', usuario.id);\n\n          if (deleteError && deleteError.code !== 'PGRST116') {\n            console.error('Error eliminando tienda actual:', deleteError);\n            // No lanzar error si no existe la fila\n          }\n        }\n      } else {\n        // Crear nuevo usuario\n        const { error } = await supabase\n          .from('usuarios')\n          .insert([{\n            email: formData.email,\n            nombre_completo: formData.nombre_completo,\n            rol: formData.rol,\n            activo: formData.activo,\n            created_at: new Date().toISOString(),\n            updated_at: new Date().toISOString(),\n          }]);\n\n        if (error) throw error;\n      }\n\n      onSave();\n    } catch (error: any) {\n      console.error('Error guardando usuario:', error);\n      setError(error.message || 'Error al guardar el usuario');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-medium text-gray-900\">\n            {usuario ? 'Editar Usuario' : 'Nuevo Usuario'}\n          </h3>\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600\"\n          >\n            <i className=\"ri-close-line text-xl\"></i>\n          </button>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded\">\n              {error}\n            </div>\n          )}\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Email\n            </label>\n            <input\n              type=\"email\"\n              required\n              disabled={!!usuario}\n              value={formData.email}\n              onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 text-sm\"\n            />\n            {usuario && (\n              <p className=\"text-xs text-gray-500 mt-1\">\n                El email no se puede modificar\n              </p>\n            )}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Nombre Completo\n            </label>\n            <input\n              type=\"text\"\n              required\n              value={formData.nombre_completo}\n              onChange={(e) => setFormData({ ...formData, nombre_completo: e.target.value })}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Rol\n            </label>\n            <select\n              value={formData.rol}\n              onChange={(e) => setFormData({ ...formData, rol: e.target.value })}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm\"\n            >\n              {roles.map(rol => (\n                <option key={rol} value={rol}>{rol}</option>\n              ))}\n            </select>\n          </div>\n\n          {/* ‚úÖ Nuevo selector de tienda */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              <i className=\"ri-store-2-line mr-1 text-teal-600\"></i>\n              Tienda Asignada\n            </label>\n            <select\n              value={formData.tienda_id}\n              onChange={(e) => setFormData({ ...formData, tienda_id: e.target.value })}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm\"\n            >\n              <option value=\"\">Sin tienda asignada</option>\n              {tiendas.map(tienda => (\n                <option key={tienda.id} value={tienda.id}>\n                  {tienda.nombre}\n                </option>\n              ))}\n            </select>\n            <p className=\"text-xs text-gray-500 mt-1\">\n              Selecciona la tienda a la que pertenece este usuario\n            </p>\n          </div>\n\n          <div className=\"flex items-center\">\n            <input\n              type=\"checkbox\"\n              id=\"activo\"\n              checked={formData.activo}\n              onChange={(e) => setFormData({ ...formData, activo: e.target.checked })}\n              className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n            />\n            <label htmlFor=\"activo\" className=\"ml-2 block text-sm text-gray-900\">\n              Usuario activo\n            </label>\n          </div>\n\n          <div className=\"flex justify-end space-x-3 pt-4\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md whitespace-nowrap\"\n            >\n              Cancelar\n            </button>\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md disabled:opacity-50 whitespace-nowrap\"\n            >\n              {loading ? 'Guardando...' : 'Guardar'}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n","\nimport { supabase } from '../lib/supabase';\n\nexport interface UsuarioPendiente {\n  id: string;\n  nombre_completo: string;\n  email: string;\n  rol: string;\n  activo: boolean;\n  created_at: string;\n}\n\nexport interface TiendaDisponible {\n  id: string;\n  nombre: string;\n  codigo: string;\n  activo: boolean;\n}\n\nexport interface AsignarTiendaRequest {\n  usuario_id: string;\n  tienda_id: string;\n}\n\nclass UsuariosPendientesService {\n  async obtenerUsuariosPendientes(): Promise<UsuarioPendiente[]> {\n    try {\n      console.log('üîç Obteniendo usuarios pendientes...');\n      \n      // Paso 1: Obtener usuarios que ya tienen tienda asignada\n      const { data: usuariosConTienda, error: errorTiendas } = await supabase\n        .from('usuario_tiendas')\n        .select('usuario_id')\n        .eq('activo', true);\n\n      if (errorTiendas) {\n        console.error('‚ùå Error obteniendo usuarios con tienda:', errorTiendas);\n        throw errorTiendas;\n      }\n\n      const idsConTienda = usuariosConTienda?.map(ut => ut.usuario_id) || [];\n      console.log('üìã IDs con tienda asignada:', idsConTienda);\n\n      // Paso 2: Obtener usuarios sin tienda asignada\n      let query = supabase\n        .from('usuarios')\n        .select(`\n          id,\n          nombre_completo,\n          email,\n          activo,\n          created_at,\n          roles(nombre)\n        `)\n        .eq('activo', true);\n\n      // Si hay usuarios con tienda, excluirlos\n      if (idsConTienda.length > 0) {\n        const idsString = idsConTienda.map(id => `\"${id}\"`).join(',');\n        query = query.not('id', 'in', `(${idsString})`);\n      }\n\n      const { data: usuariosPendientes, error: errorUsuarios } = await query;\n\n      if (errorUsuarios) {\n        console.error('‚ùå Error obteniendo usuarios pendientes:', errorUsuarios);\n        throw errorUsuarios;\n      }\n\n      // Formatear respuesta\n      const resultado = usuariosPendientes?.map(usuario => ({\n        id: usuario.id,\n        nombre_completo: usuario.nombre_completo,\n        email: usuario.email,\n        rol: usuario.roles?.nombre || 'Sin rol',\n        activo: usuario.activo,\n        created_at: usuario.created_at\n      })) || [];\n\n      console.log('‚úÖ Usuarios pendientes obtenidos:', resultado.length);\n      return resultado;\n\n    } catch (error) {\n      console.error('‚ùå Error en obtenerUsuariosPendientes:', error);\n      throw new Error(`Error cargando usuarios pendientes: ${JSON.stringify(error)}`);\n    }\n  }\n\n  async obtenerTiendasDisponibles(): Promise<TiendaDisponible[]> {\n    try {\n      console.log('üè™ Obteniendo tiendas disponibles...');\n      \n      const { data, error } = await supabase\n        .from('tiendas')\n        .select('id, nombre, codigo, activo')\n        .eq('activo', true)\n        .order('nombre');\n\n      if (error) {\n        console.error('‚ùå Error obteniendo tiendas:', error);\n        throw error;\n      }\n\n      console.log('‚úÖ Tiendas disponibles:', data?.length || 0);\n      return data || [];\n\n    } catch (error) {\n      console.error('‚ùå Error en obtenerTiendasDisponibles:', error);\n      throw new Error(`Error cargando tiendas: ${JSON.stringify(error)}`);\n    }\n  }\n\n  async asignarTienda(request: AsignarTiendaRequest): Promise<void> {\n    try {\n      console.log('üè™ Asignando tienda:', request);\n\n      // Validar que el usuario existe\n      const { data: usuario, error: errorUsuario } = await supabase\n        .from('usuarios')\n        .select('id, nombre_completo')\n        .eq('id', request.usuario_id)\n        .eq('activo', true)\n        .single();\n\n      if (errorUsuario || !usuario) {\n        throw new Error('Usuario no encontrado o inactivo');\n      }\n\n      // Validar que la tienda existe y est√° activa\n      const { data: tienda, error: errorTienda } = await supabase\n        .from('tiendas')\n        .select('id, nombre')\n        .eq('id', request.tienda_id)\n        .eq('activo', true)\n        .single();\n\n      if (errorTienda || !tienda) {\n        throw new Error('Tienda no encontrada o inactiva');\n      }\n\n      console.log('‚úÖ Usuario y tienda v√°lidos:', { \n        usuario: usuario.nombre_completo, \n        tienda: tienda.nombre \n      });\n\n      // Crear registro en usuario_tiendas\n      const { error: errorAsignacion } = await supabase\n        .from('usuario_tiendas')\n        .insert({\n          usuario_id: request.usuario_id,\n          tienda_id: request.tienda_id,\n          activo: true\n        });\n\n      if (errorAsignacion) {\n        console.error('‚ùå Error creando usuario_tiendas:', errorAsignacion);\n        throw errorAsignacion;\n      }\n\n      console.log('‚úÖ Registro usuario_tiendas creado');\n\n      // Establecer como tienda actual\n      const { error: errorTiendaActual } = await supabase\n        .from('usuario_tienda_actual')\n        .upsert({\n          usuario_id: request.usuario_id,\n          tienda_id: request.tienda_id\n        });\n\n      if (errorTiendaActual) {\n        console.error('‚ùå Error estableciendo tienda actual:', errorTiendaActual);\n        \n        // Rollback: eliminar registro de usuario_tiendas\n        await supabase\n          .from('usuario_tiendas')\n          .delete()\n          .eq('usuario_id', request.usuario_id)\n          .eq('tienda_id', request.tienda_id);\n        \n        throw errorTiendaActual;\n      }\n\n      console.log('‚úÖ Tienda asignada exitosamente:', { \n        usuario: usuario.nombre_completo, \n        tienda: tienda.nombre \n      });\n\n    } catch (error) {\n      console.error('‚ùå Error en asignarTienda:', error);\n      throw new Error(`Error asignando tienda: ${JSON.stringify(error)}`);\n    }\n  }\n}\n\nexport const usuariosPendientesService = new UsuariosPendientesService();\n","import { useState, useEffect } from 'react';\nimport { usuariosPendientesService, UsuarioPendiente, TiendaDisponible } from '../../../services/usuariosPendientesService';\nimport { useNotification } from '../../../hooks/useNotification';\n\ninterface AsignarTiendaModalProps {\n  usuario: UsuarioPendiente;\n  onClose: () => void;\n  onSuccess: () => void;\n}\n\nexport function AsignarTiendaModal({ usuario, onClose, onSuccess }: AsignarTiendaModalProps) {\n  const [tiendas, setTiendas] = useState<TiendaDisponible[]>([]);\n  const [selectedTienda, setSelectedTienda] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [loadingTiendas, setLoadingTiendas] = useState(true);\n  const { showNotification } = useNotification();\n\n  useEffect(() => {\n    cargarTiendas();\n  }, []);\n\n  const cargarTiendas = async () => {\n    try {\n      setLoadingTiendas(true);\n      const data = await usuariosPendientesService.obtenerTiendasDisponibles();\n      setTiendas(data);\n      \n      // Si solo hay una tienda, seleccionarla autom√°ticamente\n      if (data.length === 1) {\n        setSelectedTienda(data[0].id);\n      }\n    } catch (error) {\n      console.error('Error cargando tiendas:', error);\n      showNotification('Error al cargar tiendas disponibles', 'error');\n    } finally {\n      setLoadingTiendas(false);\n    }\n  };\n\n  const handleAsignar = async () => {\n    if (!selectedTienda) {\n      showNotification('Por favor selecciona una tienda', 'error');\n      return;\n    }\n\n    try {\n      setLoading(true);\n      await usuariosPendientesService.asignarTienda({\n        usuario_id: usuario.id,\n        tienda_id: selectedTienda\n      });\n      \n      onSuccess();\n    } catch (error) {\n      console.error('Error asignando tienda:', error);\n      showNotification('Error al asignar la tienda', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const tiendaSeleccionada = tiendas.find(t => t.id === selectedTienda);\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto\">\n        {/* Header */}\n        <div className=\"px-6 py-4 border-b border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <h3 className=\"text-lg font-medium text-gray-900\">\n              Asignar Tienda a Usuario\n            </h3>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n            >\n              <i className=\"ri-close-line text-xl\"></i>\n            </button>\n          </div>\n        </div>\n\n        {/* Content */}\n        <div className=\"px-6 py-4 space-y-6\">\n          {/* Informaci√≥n del Usuario */}\n          <div className=\"bg-gray-50 rounded-lg p-4\">\n            <h4 className=\"text-sm font-medium text-gray-900 mb-3\">\n              Informaci√≥n del Usuario\n            </h4>\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center\">\n                <i className=\"ri-user-line text-gray-400 mr-2\"></i>\n                <span className=\"text-sm text-gray-600\">Nombre:</span>\n                <span className=\"text-sm font-medium text-gray-900 ml-2\">\n                  {usuario.nombre_completo}\n                </span>\n              </div>\n              <div className=\"flex items-center\">\n                <i className=\"ri-mail-line text-gray-400 mr-2\"></i>\n                <span className=\"text-sm text-gray-600\">Email:</span>\n                <span className=\"text-sm font-medium text-gray-900 ml-2\">\n                  {usuario.email}\n                </span>\n              </div>\n              <div className=\"flex items-center\">\n                <i className=\"ri-shield-user-line text-gray-400 mr-2\"></i>\n                <span className=\"text-sm text-gray-600\">Rol:</span>\n                <span className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 ml-2\">\n                  {usuario.rol}\n                </span>\n              </div>\n              <div className=\"flex items-center\">\n                <i className=\"ri-calendar-line text-gray-400 mr-2\"></i>\n                <span className=\"text-sm text-gray-600\">Registro:</span>\n                <span className=\"text-sm font-medium text-gray-900 ml-2\">\n                  {new Date(usuario.created_at).toLocaleDateString()}\n                </span>\n              </div>\n            </div>\n          </div>\n\n          {/* Estado Actual */}\n          <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\n            <div className=\"flex items-start\">\n              <i className=\"ri-time-line text-yellow-600 mt-0.5 mr-2\"></i>\n              <div>\n                <p className=\"text-sm font-medium text-yellow-800\">\n                  Estado Actual: Pendiente de Asignaci√≥n de Tienda\n                </p>\n                <p className=\"text-sm text-yellow-700 mt-1\">\n                  Este usuario no puede acceder al sistema hasta que se le asigne una tienda.\n                </p>\n              </div>\n            </div>\n          </div>\n\n          {/* Selecci√≥n de Tienda */}\n          <div>\n            <label htmlFor=\"tienda\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Seleccionar Tienda *\n            </label>\n            \n            {loadingTiendas ? (\n              <div className=\"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-500\">\n                <div className=\"flex items-center\">\n                  <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-400 mr-2\"></div>\n                  Cargando tiendas...\n                </div>\n              </div>\n            ) : tiendas.length === 0 ? (\n              <div className=\"w-full px-3 py-2 border border-red-300 rounded-md bg-red-50 text-red-600 text-sm\">\n                <div className=\"flex items-center\">\n                  <i className=\"ri-error-warning-line mr-2\"></i>\n                  No hay tiendas disponibles\n                </div>\n              </div>\n            ) : (\n              <select\n                id=\"tienda\"\n                value={selectedTienda}\n                onChange={(e) => setSelectedTienda(e.target.value)}\n                className=\"w-full px-3 py-2 pr-8 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\n                disabled={loading}\n              >\n                <option value=\"\">Selecciona una tienda</option>\n                {tiendas.map((tienda) => (\n                  <option key={tienda.id} value={tienda.id}>\n                    {tienda.nombre} ({tienda.codigo})\n                  </option>\n                ))}\n              </select>\n            )}\n            \n            {tiendaSeleccionada && (\n              <div className=\"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-md\">\n                <div className=\"flex items-start\">\n                  <i className=\"ri-store-line text-blue-600 mt-0.5 mr-2\"></i>\n                  <div>\n                    <p className=\"text-sm font-medium text-blue-800\">\n                      Tienda Seleccionada: {tiendaSeleccionada.nombre}\n                    </p>\n                    <p className=\"text-sm text-blue-700\">\n                      C√≥digo: {tiendaSeleccionada.codigo}\n                    </p>\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Informaci√≥n Importante */}\n          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n            <div className=\"flex items-start\">\n              <i className=\"ri-information-line text-blue-600 mt-0.5 mr-2\"></i>\n              <div>\n                <p className=\"text-sm font-medium text-blue-800 mb-1\">\n                  ¬øQu√© suceder√° al asignar la tienda?\n                </p>\n                <ul className=\"text-sm text-blue-700 space-y-1\">\n                  <li>‚Ä¢ El usuario podr√° iniciar sesi√≥n normalmente</li>\n                  <li>‚Ä¢ Tendr√° acceso a todas las funcionalidades del sistema</li>\n                  <li>‚Ä¢ La tienda seleccionada ser√° su tienda por defecto</li>\n                  <li>‚Ä¢ Podr√° cambiar de tienda si tiene permisos</li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Footer */}\n        <div className=\"px-6 py-4 border-t border-gray-200 flex justify-end space-x-3\">\n          <button\n            onClick={onClose}\n            disabled={loading}\n            className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 whitespace-nowrap\"\n          >\n            Cancelar\n          </button>\n          \n          <button\n            onClick={handleAsignar}\n            disabled={loading || !selectedTienda || loadingTiendas || tiendas.length === 0}\n            className=\"px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap\"\n          >\n            {loading ? (\n              <div className=\"flex items-center\">\n                <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\n                Asignando...\n              </div>\n            ) : (\n              <>\n                <i className=\"ri-check-line mr-2\"></i>\n                Asignar Tienda\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}","import React, { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\nimport { UsuarioForm } from './UsuarioForm';\nimport { AsignarTiendaModal } from './AsignarTiendaModal';\n\ninterface Usuario {\n  id: string;\n  email: string;\n  nombre_completo: string;\n  rol: string;\n  activo: boolean;\n  created_at: string;\n  tienda_nombre?: string | null;\n}\n\nexport function UsuariosTab() {\n  const [usuarios, setUsuarios] = useState<Usuario[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [showForm, setShowForm] = useState(false);\n  const [editingUsuario, setEditingUsuario] = useState<Usuario | null>(null);\n  const [showAsignarTienda, setShowAsignarTienda] = useState(false);\n  const [usuarioParaTienda, setUsuarioParaTienda] = useState<Usuario | null>(null);\n\n  useEffect(() => {\n    cargarUsuarios();\n  }, []);\n\n  const cargarUsuarios = async () => {\n    try {\n      setLoading(true);\n      \n      // ‚úÖ Cargar usuarios con su tienda actual mediante LEFT JOIN\n      const { data, error } = await supabase\n        .from('usuarios')\n        .select(`\n          *,\n          usuario_tienda_actual(\n            tienda_id,\n            tiendas(\n              id,\n              nombre\n            )\n          )\n        `)\n        .order('created_at', { ascending: false });\n\n      if (error) {\n        console.error('Error en query:', error);\n        throw error;\n      }\n      \n      console.log('üìä Datos crudos de Supabase:', data);\n      \n      // Mapear los datos para incluir el nombre de la tienda\n      const usuariosConTienda = (data || []).map(usuario => {\n        console.log('üë§ Usuario:', usuario.email, 'Tienda data:', usuario.usuario_tienda_actual);\n        \n        // Extraer el nombre de la tienda seg√∫n la estructura real\n        let tiendaNombre = null;\n        \n        if (usuario.usuario_tienda_actual) {\n          // Puede venir como objeto √∫nico o como array\n          const tiendaData = Array.isArray(usuario.usuario_tienda_actual) \n            ? usuario.usuario_tienda_actual[0] \n            : usuario.usuario_tienda_actual;\n          \n          if (tiendaData?.tiendas) {\n            tiendaNombre = Array.isArray(tiendaData.tiendas)\n              ? tiendaData.tiendas[0]?.nombre\n              : tiendaData.tiendas?.nombre;\n          }\n        }\n        \n        return {\n          ...usuario,\n          tienda_nombre: tiendaNombre\n        };\n      });\n      \n      console.log('‚úÖ Usuarios procesados:', usuariosConTienda);\n      setUsuarios(usuariosConTienda);\n    } catch (error) {\n      console.error('Error cargando usuarios:', error);\n      \n      // Fallback: cargar usuarios sin tienda si falla el JOIN\n      try {\n        const { data: usuariosSinTienda, error: errorFallback } = await supabase\n          .from('usuarios')\n          .select('*')\n          .order('created_at', { ascending: false });\n        \n        if (!errorFallback && usuariosSinTienda) {\n          setUsuarios(usuariosSinTienda.map(u => ({ ...u, tienda_nombre: null })));\n        }\n      } catch (fallbackError) {\n        console.error('Error en fallback:', fallbackError);\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleEdit = (usuario: Usuario) => {\n    setEditingUsuario(usuario);\n    setShowForm(true);\n  };\n\n  const handleDelete = async (id: string) => {\n    if (!confirm('¬øEst√° seguro de eliminar este usuario?')) return;\n\n    try {\n      const { error } = await supabase\n        .from('usuarios')\n        .delete()\n        .eq('id', id);\n\n      if (error) throw error;\n\n      cargarUsuarios();\n    } catch (error) {\n      console.error('Error eliminando usuario:', error);\n      alert('Error al eliminar el usuario');\n    }\n  };\n\n  const handleToggleActivo = async (usuario: Usuario) => {\n    try {\n      const { error } = await supabase\n        .from('usuarios')\n        .update({ activo: !usuario.activo })\n        .eq('id', usuario.id);\n\n      if (error) throw error;\n\n      cargarUsuarios();\n    } catch (error) {\n      console.error('Error actualizando estado:', error);\n      alert('Error al actualizar el estado del usuario');\n    }\n  };\n\n  const handleAsignarTienda = (usuario: Usuario) => {\n    setUsuarioParaTienda(usuario);\n    setShowAsignarTienda(true);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center items-center h-64\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Header con bot√≥n Nuevo */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-xl font-semibold text-gray-900\">Usuarios del Sistema</h2>\n          <p className=\"text-sm text-gray-600\">Gestiona los usuarios y sus permisos</p>\n        </div>\n        <button\n          onClick={() => {\n            setEditingUsuario(null);\n            setShowForm(true);\n          }}\n          className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center cursor-pointer\"\n        >\n          <i className=\"ri-add-line mr-2\"></i>\n          Nuevo Usuario\n        </button>\n      </div>\n\n      {/* Tabla de usuarios */}\n      <div className=\"bg-white rounded-lg shadow overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full divide-y divide-gray-200\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Usuario\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Email\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Rol\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Tienda\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Estado\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Fecha Registro\n                </th>\n                <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Acciones\n                </th>\n              </tr>\n            </thead>\n            <tbody className=\"bg-white divide-y divide-gray-200\">\n              {usuarios.map((usuario) => (\n                <tr key={usuario.id} className=\"hover:bg-gray-50\">\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center\">\n                        <i className=\"ri-user-line text-blue-600 text-lg\"></i>\n                      </div>\n                      <div className=\"ml-4\">\n                        <div className=\"text-sm font-medium text-gray-900\">\n                          {usuario.nombre_completo || 'Sin nombre'}\n                        </div>\n                      </div>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"text-sm text-gray-900\">{usuario.email}</div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <span className=\"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-purple-100 text-purple-800\">\n                      {usuario.rol || 'Sin rol'}\n                    </span>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    {usuario.tienda_nombre ? (\n                      <div className=\"flex items-center text-sm text-gray-900\">\n                        <i className=\"ri-store-2-line text-teal-600 mr-2\"></i>\n                        {usuario.tienda_nombre}\n                      </div>\n                    ) : (\n                      <span className=\"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-600\">\n                        <i className=\"ri-alert-line mr-1\"></i>\n                        Sin tienda\n                      </span>\n                    )}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <button\n                      onClick={() => handleToggleActivo(usuario)}\n                      className=\"cursor-pointer\"\n                    >\n                      <span className={`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${\n                        usuario.activo\n                          ? 'bg-green-100 text-green-800'\n                          : 'bg-red-100 text-red-800'\n                      }`}>\n                        {usuario.activo ? 'Activo' : 'Inactivo'}\n                      </span>\n                    </button>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                    {new Date(usuario.created_at).toLocaleDateString()}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                    <div className=\"flex justify-end space-x-2\">\n                      <button\n                        onClick={() => handleAsignarTienda(usuario)}\n                        className=\"text-teal-600 hover:text-teal-900 cursor-pointer\"\n                        title=\"Asignar Tienda\"\n                      >\n                        <i className=\"ri-store-2-line text-lg\"></i>\n                      </button>\n                      <button\n                        onClick={() => handleEdit(usuario)}\n                        className=\"text-blue-600 hover:text-blue-900 cursor-pointer\"\n                        title=\"Editar\"\n                      >\n                        <i className=\"ri-edit-line text-lg\"></i>\n                      </button>\n                      <button\n                        onClick={() => handleDelete(usuario.id)}\n                        className=\"text-red-600 hover:text-red-900 cursor-pointer\"\n                        title=\"Eliminar\"\n                      >\n                        <i className=\"ri-delete-bin-line text-lg\"></i>\n                      </button>\n                    </div>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n\n        {usuarios.length === 0 && (\n          <div className=\"text-center py-12\">\n            <i className=\"ri-user-line text-gray-400 text-5xl mb-4\"></i>\n            <p className=\"text-gray-500\">No hay usuarios registrados</p>\n          </div>\n        )}\n      </div>\n\n      {/* Modal de formulario */}\n      {showForm && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\n            <div className=\"p-6\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h3 className=\"text-xl font-semibold text-gray-900\">\n                  {editingUsuario ? 'Editar Usuario' : 'Nuevo Usuario'}\n                </h3>\n                <button\n                  onClick={() => {\n                    setShowForm(false);\n                    setEditingUsuario(null);\n                  }}\n                  className=\"text-gray-400 hover:text-gray-600 cursor-pointer\"\n                >\n                  <i className=\"ri-close-line text-2xl\"></i>\n                </button>\n              </div>\n              <UsuarioForm\n                usuario={editingUsuario}\n                onSuccess={() => {\n                  setShowForm(false);\n                  setEditingUsuario(null);\n                  cargarUsuarios();\n                }}\n                onCancel={() => {\n                  setShowForm(false);\n                  setEditingUsuario(null);\n                }}\n              />\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Modal de asignar tienda */}\n      {showAsignarTienda && usuarioParaTienda && (\n        <AsignarTiendaModal\n          usuario={usuarioParaTienda}\n          onClose={() => {\n            setShowAsignarTienda(false);\n            setUsuarioParaTienda(null);\n          }}\n          onSuccess={() => {\n            setShowAsignarTienda(false);\n            setUsuarioParaTienda(null);\n            cargarUsuarios();\n          }}\n        />\n      )}\n    </div>\n  );\n}\n","import { useState, useEffect } from 'react';\nimport { usuariosPendientesService, UsuarioPendiente, TiendaDisponible } from '../../../services/usuariosPendientesService';\nimport { PermissionButton } from '../../../components/base/PermissionButton';\nimport { useNotification } from '../../../hooks/useNotification';\nimport { AsignarTiendaModal } from './AsignarTiendaModal';\n\nexport function UsuariosPendientesTab() {\n  const [usuarios, setUsuarios] = useState<UsuarioPendiente[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [showAsignarModal, setShowAsignarModal] = useState(false);\n  const [selectedUsuario, setSelectedUsuario] = useState<UsuarioPendiente | null>(null);\n  const { showNotification } = useNotification();\n\n  useEffect(() => {\n    cargarUsuariosPendientes();\n  }, []);\n\n  const cargarUsuariosPendientes = async () => {\n    try {\n      setLoading(true);\n      const data = await usuariosPendientesService.obtenerUsuariosPendientes();\n      setUsuarios(data);\n    } catch (error) {\n      console.error('Error cargando usuarios pendientes:', error);\n      showNotification('Error al cargar usuarios pendientes', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleAsignarTienda = (usuario: UsuarioPendiente) => {\n    setSelectedUsuario(usuario);\n    setShowAsignarModal(true);\n  };\n\n  const handleRechazarRegistro = async (usuario: UsuarioPendiente) => {\n    if (!confirm(`¬øEst√°s seguro de que deseas rechazar el registro de ${usuario.nombre_completo}?`)) {\n      return;\n    }\n\n    try {\n      await usuariosPendientesService.rechazarRegistro(usuario.id);\n      showNotification('Registro rechazado exitosamente', 'success');\n      await cargarUsuariosPendientes();\n    } catch (error) {\n      console.error('Error rechazando registro:', error);\n      showNotification('Error al rechazar el registro', 'error');\n    }\n  };\n\n  const handleAsignacionExitosa = () => {\n    setShowAsignarModal(false);\n    setSelectedUsuario(null);\n    cargarUsuariosPendientes();\n    showNotification('Tienda asignada exitosamente', 'success');\n  };\n\n  const usuariosFiltrados = usuarios.filter(usuario => \n    usuario.nombre_completo.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    usuario.email.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header y Filtros */}\n      <div className=\"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between\">\n        <div>\n          <h3 className=\"text-lg font-medium text-gray-900\">Usuarios Pendientes</h3>\n          <p className=\"text-sm text-gray-600\">\n            Usuarios que necesitan asignaci√≥n de tienda para acceder al sistema\n          </p>\n        </div>\n        \n        <div className=\"flex items-center space-x-4\">\n          <div className=\"relative\">\n            <i className=\"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\"></i>\n            <input\n              type=\"text\"\n              placeholder=\"Buscar usuarios...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm\"\n            />\n          </div>\n          \n          <button\n            onClick={cargarUsuariosPendientes}\n            className=\"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-md text-sm font-medium whitespace-nowrap\"\n            title=\"Actualizar lista\"\n          >\n            <i className=\"ri-refresh-line\"></i>\n          </button>\n        </div>\n      </div>\n\n      {/* Estad√≠sticas */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n        <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\n          <div className=\"flex items-center\">\n            <div className=\"flex-shrink-0\">\n              <i className=\"ri-time-line text-yellow-600 text-xl\"></i>\n            </div>\n            <div className=\"ml-3\">\n              <p className=\"text-sm font-medium text-yellow-800\">Usuarios Pendientes</p>\n              <p className=\"text-2xl font-bold text-yellow-900\">{usuarios.length}</p>\n            </div>\n          </div>\n        </div>\n        \n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n          <div className=\"flex items-center\">\n            <div className=\"flex-shrink-0\">\n              <i className=\"ri-user-add-line text-blue-600 text-xl\"></i>\n            </div>\n            <div className=\"ml-3\">\n              <p className=\"text-sm font-medium text-blue-800\">Registros Hoy</p>\n              <p className=\"text-2xl font-bold text-blue-900\">\n                {usuarios.filter(u => {\n                  const today = new Date().toDateString();\n                  const userDate = new Date(u.created_at).toDateString();\n                  return today === userDate;\n                }).length}\n              </p>\n            </div>\n          </div>\n        </div>\n        \n        <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\n          <div className=\"flex items-center\">\n            <div className=\"flex-shrink-0\">\n              <i className=\"ri-check-line text-green-600 text-xl\"></i>\n            </div>\n            <div className=\"ml-3\">\n              <p className=\"text-sm font-medium text-green-800\">Usuarios Activos</p>\n              <p className=\"text-2xl font-bold text-green-900\">\n                {usuarios.filter(u => u.activo).length}\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Tabla de Usuarios Pendientes */}\n      <div className=\"bg-white shadow rounded-lg overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full divide-y divide-gray-200\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Usuario\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Rol\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Estado\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Fecha Registro\n                </th>\n                <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Acciones\n                </th>\n              </tr>\n            </thead>\n            <tbody className=\"bg-white divide-y divide-gray-200\">\n              {usuariosFiltrados.map((usuario) => (\n                <tr key={usuario.id} className=\"hover:bg-gray-50\">\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div>\n                      <div className=\"text-sm font-medium text-gray-900\">\n                        {usuario.nombre_completo}\n                      </div>\n                      <div className=\"text-sm text-gray-500\">\n                        {usuario.email}\n                      </div>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\">\n                      {usuario.rol}\n                    </span>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 h-2 w-2 bg-yellow-400 rounded-full mr-2\"></div>\n                      <span className=\"text-sm text-yellow-700 font-medium\">\n                        Pendiente de tienda\n                      </span>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                    <div>\n                      <div>{new Date(usuario.created_at).toLocaleDateString()}</div>\n                      <div className=\"text-xs text-gray-400\">\n                        {new Date(usuario.created_at).toLocaleTimeString()}\n                      </div>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                    <div className=\"flex items-center justify-end space-x-2\">\n                      <PermissionButton\n                        permission=\"seguridad:usuarios:asignar_tienda\"\n                        onClick={() => handleAsignarTienda(usuario)}\n                        className=\"text-green-600 hover:text-green-900\"\n                        title=\"Asignar tienda\"\n                      >\n                        <i className=\"ri-store-line\"></i>\n                      </PermissionButton>\n                      \n                      <PermissionButton\n                        permission=\"seguridad:usuarios:rechazar_registro\"\n                        onClick={() => handleRechazarRegistro(usuario)}\n                        className=\"text-red-600 hover:text-red-900\"\n                        title=\"Rechazar registro\"\n                      >\n                        <i className=\"ri-close-line\"></i>\n                      </PermissionButton>\n                    </div>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n\n        {usuariosFiltrados.length === 0 && (\n          <div className=\"text-center py-12\">\n            {usuarios.length === 0 ? (\n              <>\n                <i className=\"ri-check-double-line text-green-400 text-4xl mb-4\"></i>\n                <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n                  ¬°Excelente! No hay usuarios pendientes\n                </h3>\n                <p className=\"text-gray-500\">\n                  Todos los usuarios registrados tienen tienda asignada.\n                </p>\n              </>\n            ) : (\n              <>\n                <i className=\"ri-search-line text-gray-400 text-4xl mb-4\"></i>\n                <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n                  No se encontraron usuarios\n                </h3>\n                <p className=\"text-gray-500\">\n                  No hay usuarios que coincidan con tu b√∫squeda.\n                </p>\n              </>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Modal de Asignaci√≥n de Tienda */}\n      {showAsignarModal && selectedUsuario && (\n        <AsignarTiendaModal\n          usuario={selectedUsuario}\n          onClose={() => {\n            setShowAsignarModal(false);\n            setSelectedUsuario(null);\n          }}\n          onSuccess={handleAsignacionExitosa}\n        />\n      )}\n    </div>\n  );\n}","\nimport { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\n\ninterface Rol {\n  id: string;\n  nombre: string;\n  descripcion: string;\n  created_at: string;\n  updated_at: string;\n}\n\ninterface Permiso {\n  id: string;\n  nombre: string;\n  descripcion: string;\n}\n\ninterface RolFormProps {\n  rol: Rol | null;\n  onClose: () => void;\n  onSave: () => void;\n}\n\nexport default function RolForm({ rol, onClose, onSave }: RolFormProps) {\n  const [formData, setFormData] = useState({\n    nombre: '',\n    descripcion: '',\n  });\n  const [permisos, setPermisos] = useState<Permiso[]>([]);\n  const [permisosSeleccionados, setPermisosSeleccionados] = useState<string[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    cargarPermisos();\n    if (rol) {\n      setFormData({\n        nombre: rol.nombre,\n        descripcion: rol.descripcion,\n      });\n      cargarPermisosRol(rol.id);\n    }\n  }, [rol]);\n\n  const cargarPermisos = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('permisos')\n        .select('*')\n        .order('nombre');\n\n      if (error) throw error;\n      setPermisos(data || []);\n    } catch (error) {\n      console.error('Error cargando permisos:', error);\n    }\n  };\n\n  const cargarPermisosRol = async (rolId: string) => {\n    try {\n      const { data, error } = await supabase\n        .from('rol_permisos')\n        .select('permiso_id')\n        .eq('rol_id', rolId);\n\n      if (error) throw error;\n      \n      const permisosIds = data?.map(rp => rp.permiso_id) || [];\n      setPermisosSeleccionados(permisosIds);\n    } catch (error) {\n      console.error('Error cargando permisos del rol:', error);\n    }\n  };\n\n  const handlePermisoChange = (permisoId: string, checked: boolean) => {\n    if (checked) {\n      setPermisosSeleccionados([...permisosSeleccionados, permisoId]);\n    } else {\n      setPermisosSeleccionados(permisosSeleccionados.filter(id => id !== permisoId));\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError('');\n    setLoading(true);\n\n    try {\n      let rolId: string;\n\n      if (rol) {\n        // Actualizar rol existente\n        const { error } = await supabase\n          .from('roles')\n          .update({\n            nombre: formData.nombre,\n            descripcion: formData.descripcion,\n          })\n          .eq('id', rol.id);\n\n        if (error) throw error;\n        rolId = rol.id;\n      } else {\n        // Crear nuevo rol\n        const { data, error } = await supabase\n          .from('roles')\n          .insert([{\n            nombre: formData.nombre,\n            descripcion: formData.descripcion,\n          }])\n          .select()\n          .single();\n\n        if (error) throw error;\n        rolId = data.id;\n      }\n\n      // Actualizar permisos del rol\n      if (rol) {\n        // Eliminar permisos existentes\n        await supabase\n          .from('rol_permisos')\n          .delete()\n          .eq('rol_id', rolId);\n      }\n\n      // Insertar nuevos permisos\n      if (permisosSeleccionados.length > 0) {\n        const rolPermisos = permisosSeleccionados.map(permisoId => ({\n          rol_id: rolId,\n          permiso_id: permisoId,\n        }));\n\n        const { error: permisosError } = await supabase\n          .from('rol_permisos')\n          .insert(rolPermisos);\n\n        if (permisosError) throw permisosError;\n      }\n\n      onSave();\n    } catch (error: any) {\n      console.error('Error guardando rol:', error);\n      setError(error.message || 'Error al guardar el rol');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-medium text-gray-900\">\n            {rol ? 'Editar Rol' : 'Nuevo Rol'}\n          </h3>\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600\"\n          >\n            <i className=\"ri-close-line text-xl\"></i>\n          </button>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded\">\n              {error}\n            </div>\n          )}\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Nombre del Rol\n              </label>\n              <input\n                type=\"text\"\n                required\n                value={formData.nombre}\n                onChange={(e) => setFormData({ ...formData, nombre: e.target.value })}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Descripci√≥n\n              </label>\n              <input\n                type=\"text\"\n                value={formData.descripcion}\n                onChange={(e) => setFormData({ ...formData, descripcion: e.target.value })}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm\"\n              />\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n              Permisos\n            </label>\n            <div className=\"border border-gray-200 rounded-md p-4 max-h-60 overflow-y-auto\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                {permisos.map((permiso) => (\n                  <div key={permiso.id} className=\"flex items-start\">\n                    <input\n                      type=\"checkbox\"\n                      id={`permiso-${permiso.id}`}\n                      checked={permisosSeleccionados.includes(permiso.id)}\n                      onChange={(e) => handlePermisoChange(permiso.id, e.target.checked)}\n                      className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded mt-0.5\"\n                    />\n                    <label htmlFor={`permiso-${permiso.id}`} className=\"ml-2 block text-sm\">\n                      <div className=\"font-medium text-gray-900\">{permiso.nombre}</div>\n                      {permiso.descripcion && (\n                        <div className=\"text-gray-500 text-xs\">{permiso.descripcion}</div>\n                      )}\n                    </label>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n\n          <div className=\"flex justify-end space-x-3 pt-4\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md whitespace-nowrap\"\n            >\n              Cancelar\n            </button>\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-7\n\n              00 rounded-md disabled:opacity-50 whitespace-nowrap\"\n            >\n              {loading ? 'Guardando...' : 'Guardar'}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n","\nimport { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\nimport RolForm from './RolForm';\n\ninterface Rol {\n  id: string;\n  nombre: string;\n  descripcion: string;\n  created_at: string;\n  updated_at: string;\n}\n\n// Cambiar export default por export named\nexport function RolesTab() {\n  const [roles, setRoles] = useState<Rol[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [showForm, setShowForm] = useState(false);\n  const [editingRol, setEditingRol] = useState<Rol | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n\n  useEffect(() => {\n    cargarRoles();\n  }, []);\n\n  const cargarRoles = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('roles')\n        .select('*')\n        .order('nombre');\n\n      if (error) throw error;\n      setRoles(data || []);\n    } catch (error) {\n      console.error('Error cargando roles:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleEdit = (rol: Rol) => {\n    setEditingRol(rol);\n    setShowForm(true);\n  };\n\n  const handleDelete = async (id: string) => {\n    if (!confirm('¬øEst√°s seguro de que deseas eliminar este rol?')) return;\n\n    try {\n      // Verificar si hay usuarios con este rol\n      const { data: usuarios } = await supabase\n        .from('usuarios')\n        .select('id')\n        .eq('rol', roles.find(r => r.id === id)?.nombre);\n\n      if (usuarios && usuarios.length > 0) {\n        alert('No se puede eliminar este rol porque hay usuarios asignados a √©l.');\n        return;\n      }\n\n      const { error } = await supabase\n        .from('roles')\n        .delete()\n        .eq('id', id);\n\n      if (error) throw error;\n      \n      await cargarRoles();\n    } catch (error) {\n      console.error('Error eliminando rol:', error);\n      alert('Error al eliminar el rol');\n    }\n  };\n\n  const rolesFiltrados = roles.filter(rol =>\n    rol.nombre.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    rol.descripcion.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Filtros y Acciones */}\n      <div className=\"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between\">\n        <div className=\"relative flex-1 max-w-md\">\n          <i className=\"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\"></i>\n          <input\n            type=\"text\"\n            placeholder=\"Buscar roles...\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            className=\"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm\"\n          />\n        </div>\n\n        <button\n          onClick={() => {\n            setEditingRol(null);\n            setShowForm(true);\n          }}\n          className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium whitespace-nowrap\"\n        >\n          <i className=\"ri-add-line mr-2\"></i>\n          Nuevo Rol\n        </button>\n      </div>\n\n      {/* Grid de Roles */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n        {rolesFiltrados.map((rol) => (\n          <div key={rol.id} className=\"bg-white rounded-lg shadow p-6 hover:shadow-md transition-shadow\">\n            <div className=\"flex items-start justify-between mb-4\">\n              <div className=\"flex items-center\">\n                <div className=\"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3\">\n                  <i className=\"ri-shield-user-line text-blue-600\"></i>\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-medium text-gray-900\">{rol.nombre}</h3>\n                  <p className=\"text-sm text-gray-500\">\n                    Creado: {new Date(rol.created_at).toLocaleDateString()}\n                  </p>\n                </div>\n              </div>\n              \n              <div className=\"flex items-center space-x-2\">\n                <button\n                  onClick={() => handleEdit(rol)}\n                  className=\"text-blue-600 hover:text-blue-900\"\n                  title=\"Editar\"\n                >\n                  <i className=\"ri-edit-line\"></i>\n                </button>\n                <button\n                  onClick={() => handleDelete(rol.id)}\n                  className=\"text-red-600 hover:text-red-900\"\n                  title=\"Eliminar\"\n                >\n                  <i className=\"ri-delete-bin-line\"></i>\n                </button>\n              </div>\n            </div>\n\n            <p className=\"text-gray-600 text-sm mb-4\">\n              {rol.descripcion || 'Sin descripci√≥n'}\n            </p>\n\n            <div className=\"flex items-center justify-between text-sm\">\n              <span className=\"text-gray-500\">\n                √öltima actualizaci√≥n: {new Date(rol.updated_at).toLocaleDateString()}\n              </span>\n            </div>\n          </div>\n        ))}\n      </div>\n\n      {rolesFiltrados.length === 0 && (\n        <div className=\"text-center py-12\">\n          <i className=\"ri-shield-user-line text-gray-400 text-4xl mb-4\"></i>\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No hay roles</h3>\n          <p className=\"text-gray-500\">No se encontraron roles con los filtros aplicados.</p>\n        </div>\n      )}\n\n      {/* Modal de Formulario */}\n      {showForm && (\n        <RolForm\n          rol={editingRol}\n          onClose={() => {\n            setShowForm(false);\n            setEditingRol(null);\n          }}\n          onSave={() => {\n            setShowForm(false);\n            setEditingRol(null);\n            cargarRoles();\n          }}\n        />\n      )}\n    </div>\n  );\n}\n","\nimport { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\n\ninterface Permiso {\n  id: string;\n  nombre: string;\n  descripcion: string;\n  created_at: string;\n  updated_at: string;\n}\n\ninterface PermisoFormProps {\n  permiso: Permiso | null;\n  onClose: () => void;\n  onSave: () => void;\n}\n\nexport default function PermisoForm({ permiso, onClose, onSave }: PermisoFormProps) {\n  const [formData, setFormData] = useState({\n    nombre: '',\n    descripcion: '',\n  });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    if (permiso) {\n      setFormData({\n        nombre: permiso.nombre,\n        descripcion: permiso.descripcion,\n      });\n    }\n  }, [permiso]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError('');\n    setLoading(true);\n\n    try {\n      if (permiso) {\n        // Actualizar permiso existente\n        const { error } = await supabase\n          .from('permisos')\n          .update({\n            nombre: formData.nombre,\n            descripcion: formData.descripcion,\n            updated_at: new Date().toISOString(),\n          })\n          .eq('id', permiso.id);\n\n        if (error) throw error;\n      } else {\n        // Crear nuevo permiso\n        const { error } = await supabase\n          .from('permisos')\n          .insert([{\n            nombre: formData.nombre,\n            descripcion: formData.descripcion,\n            created_at: new Date().toISOString(),\n            updated_at: new Date().toISOString(),\n          }]);\n\n        if (error) throw error;\n      }\n\n      onSave();\n    } catch (error: any) {\n      console.error('Error guardando permiso:', error);\n      setError(error.message || 'Error al guardar el permiso');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-md mx-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-medium text-gray-900\">\n            {permiso ? 'Editar Permiso' : 'Nuevo Permiso'}\n          </h3>\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600\"\n          >\n            <i className=\"ri-close-line text-xl\"></i>\n          </button>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded\">\n              {error}\n            </div>\n          )}\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Nombre del Permiso\n            </label>\n            <input\n              type=\"text\"\n              required\n              value={formData.nombre}\n              onChange={(e) => setFormData({ ...formData, nombre: e.target.value })}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm\"\n              placeholder=\"ej: dashboard:read, users:write\"\n            />\n            <p className=\"text-xs text-gray-500 mt-1\">\n              Usa formato m√≥dulo:acci√≥n (ej: dashboard:read, users:write)\n            </p>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Descripci√≥n\n            </label>\n            <textarea\n              value={formData.descripcion}\n              onChange={(e) => setFormData({ ...formData, descripcion: e.target.value })}\n              rows={3}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm\"\n              placeholder=\"Describe qu√© permite hacer este permiso...\"\n            />\n          </div>\n\n          <div className=\"flex justify-end space-x-3 pt-4\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md whitespace-nowrap\"\n            >\n              Cancelar\n            </button>\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md disabled:opacity-50 whitespace-nowrap\"\n            >\n              {loading ? 'Guardando...' : 'Guardar'}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n","import { useState, useEffect } from 'react';\nimport { supabase } from '../../../lib/supabase';\nimport PermisoForm from './PermisoForm';\nimport NotificationPopup from '../../../components/base/NotificationPopup';\nimport { useNotification } from '../../../hooks/useNotification';\n\ninterface Permiso {\n  id: string;\n  nombre: string;\n  descripcion: string;\n  created_at: string;\n  updated_at: string;\n}\n\n// Cambiar export default por export named\nexport function PermisosTab() {\n  const [permisos, setPermisos] = useState<Permiso[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [showForm, setShowForm] = useState(false);\n  const [editingPermiso, setEditingPermiso] = useState<Permiso | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  \n  const { notification, showSuccess, showError, hideNotification } = useNotification();\n\n  useEffect(() => {\n    cargarPermisos();\n  }, []);\n\n  const cargarPermisos = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('permisos')\n        .select('*')\n        .order('nombre');\n\n      if (error) throw error;\n      setPermisos(data || []);\n    } catch (error) {\n      console.error('Error cargando permisos:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleEdit = (permiso: Permiso) => {\n    setEditingPermiso(permiso);\n    setShowForm(true);\n  };\n\n  const handleDelete = async (id: string) => {\n    if (!confirm('¬øEst√°s seguro de que deseas eliminar este permiso?')) return;\n\n    try {\n      // Verificar si hay roles con este permiso\n      const { data: rolPermisos } = await supabase\n        .from('rol_permisos')\n        .select('id')\n        .eq('permiso_id', id);\n\n      if (rolPermisos && rolPermisos.length > 0) {\n        showError('Error', 'No se puede eliminar este permiso porque est√° asignado a uno o m√°s roles.');\n        return;\n      }\n\n      const { error } = await supabase\n        .from('permisos')\n        .delete()\n        .eq('id', id);\n\n      if (error) throw error;\n      \n      showSuccess('√âxito', 'Permiso eliminado correctamente');\n      await cargarPermisos();\n    } catch (error) {\n      console.error('Error eliminando permiso:', error);\n      showError('Error', 'Error al eliminar el permiso');\n    }\n  };\n\n  const permisosFiltrados = permisos.filter(permiso =>\n    permiso.nombre.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    permiso.descripcion.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Filtros y Acciones */}\n      <div className=\"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between\">\n        <div className=\"relative flex-1 max-w-md\">\n          <i className=\"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\"></i>\n          <input\n            type=\"text\"\n            placeholder=\"Buscar permisos...\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            className=\"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm\"\n          />\n        </div>\n\n        <button\n          onClick={() => {\n            setEditingPermiso(null);\n            setShowForm(true);\n          }}\n          className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium whitespace-nowrap\"\n        >\n          <i className=\"ri-add-line mr-2\"></i>\n          Nuevo Permiso\n        </button>\n      </div>\n\n      {/* Tabla de Permisos */}\n      <div className=\"bg-white shadow rounded-lg overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full divide-y divide-gray-200\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Permiso\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Descripci√≥n\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Fecha Creaci√≥n\n                </th>\n                <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Acciones\n                </th>\n              </tr>\n            </thead>\n            <tbody className=\"bg-white divide-y divide-gray-200\">\n              {permisosFiltrados.map((permiso) => (\n                <tr key={permiso.id} className=\"hover:bg-gray-50\">\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"flex items-center\">\n                      <div className=\"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3\">\n                        <i className=\"ri-key-line text-green-600\"></i>\n                      </div>\n                      <div className=\"text-sm font-medium text-gray-900\">\n                        {permiso.nombre}\n                      </div>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4\">\n                    <div className=\"text-sm text-gray-900\">\n                      {permiso.descripcion || 'Sin descripci√≥n'}\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                    {new Date(permiso.created_at).toLocaleDateString()}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                    <div className=\"flex items-center justify-end space-x-2\">\n                      <button\n                        onClick={() => handleEdit(permiso)}\n                        className=\"text-blue-600 hover:text-blue-900\"\n                        title=\"Editar\"\n                      >\n                        <i className=\"ri-edit-line\"></i>\n                      </button>\n                      <button\n                        onClick={() => handleDelete(permiso.id)}\n                        className=\"text-red-600 hover:text-red-900\"\n                        title=\"Eliminar\"\n                      >\n                        <i className=\"ri-delete-bin-line\"></i>\n                      </button>\n                    </div>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n\n        {permisosFiltrados.length === 0 && (\n          <div className=\"text-center py-12\">\n            <i className=\"ri-key-line text-gray-400 text-4xl mb-4\"></i>\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No hay permisos</h3>\n            <p className=\"text-gray-500\">No se encontraron permisos con los filtros aplicados.</p>\n          </div>\n        )}\n      </div>\n\n      {/* Modal de Formulario */}\n      {showForm && (\n        <PermisoForm\n          permiso={editingPermiso}\n          onClose={() => {\n            setShowForm(false);\n            setEditingPermiso(null);\n          }}\n          onSave={() => {\n            setShowForm(false);\n            setEditingPermiso(null);\n            cargarPermisos();\n          }}\n        />\n      )}\n\n      {/* Notification Popup */}\n      <NotificationPopup\n        isOpen={notification.isOpen}\n        type={notification.type}\n        message={notification.message}\n        onClose={hideNotification}\n      />\n    </div>\n  );\n}\n","/**\n * Matriz visual para gesti√≥n de permisos por roles\n * Interfaz administrativa para asignar permisos granulares\n */\n\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { supabase } from '../../lib/supabase';\nimport { useNotification } from '../../hooks/useNotification';\nimport NotificationPopup from '../base/NotificationPopup';\n\ninterface Permission {\n  id: number;\n  nombre: string;\n  descripcion: string;\n}\n\ninterface Role {\n  id: number;\n  nombre: string;\n  descripcion: string;\n}\n\ninterface RolePermission {\n  rol_id: number;\n  permiso_id: number;\n}\n\ninterface PermissionGroup {\n  module: string;\n  permissions: Permission[];\n}\n\ninterface PermissionMatrixProps {\n  onSave?: () => void;\n  className?: string;\n}\n\nexport function PermissionMatrix({ onSave, className = '' }: PermissionMatrixProps) {\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [permissions, setPermissions] = useState<Permission[]>([]);\n  const [rolePermissions, setRolePermissions] = useState<RolePermission[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedModule, setSelectedModule] = useState<string>('all');\n  const [error, setError] = useState<string>('');\n  const { notification, showNotification, hideNotification } = useNotification();\n\n  // Cargar datos iniciales\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      setLoading(true);\n      setError('');\n\n      // Cargar roles\n      const { data: rolesData, error: rolesError } = await supabase\n        .from('roles')\n        .select('*')\n        .order('nombre');\n\n      if (rolesError) throw rolesError;\n\n      // Cargar permisos\n      const { data: permissionsData, error: permissionsError } = await supabase\n        .from('permisos')\n        .select('*')\n        .order('nombre');\n\n      if (permissionsError) throw permissionsError;\n\n      // Cargar relaciones rol-permiso\n      const { data: rolePermissionsData, error: rolePermissionsError } = await supabase\n        .from('rol_permisos')\n        .select('rol_id, permiso_id');\n\n      if (rolePermissionsError) throw rolePermissionsError;\n\n      setRoles(rolesData || []);\n      setPermissions(permissionsData || []);\n      setRolePermissions(rolePermissionsData || []);\n    } catch (error) {\n      console.error('Error al cargar datos:', error);\n      setError('Error al cargar los datos de permisos');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Agrupar permisos por m√≥dulo\n  const permissionGroups = useMemo((): PermissionGroup[] => {\n    const groups = new Map<string, Permission[]>();\n\n    permissions.forEach(permission => {\n      const module = permission.nombre.split(':')[0];\n      if (!groups.has(module)) {\n        groups.set(module, []);\n      }\n      groups.get(module)!.push(permission);\n    });\n\n    return Array.from(groups.entries()).map(([module, perms]) => ({\n      module,\n      permissions: perms.sort((a, b) => a.nombre.localeCompare(b.nombre))\n    }));\n  }, [permissions]);\n\n  // Filtrar permisos seg√∫n b√∫squeda y m√≥dulo seleccionado\n  const filteredGroups = useMemo(() => {\n    let filtered = permissionGroups;\n\n    // Filtrar por m√≥dulo\n    if (selectedModule !== 'all') {\n      filtered = filtered.filter(group => group.module === selectedModule);\n    }\n\n    // Filtrar por t√©rmino de b√∫squeda\n    if (searchTerm) {\n      filtered = filtered.map(group => ({\n        ...group,\n        permissions: group.permissions.filter(\n          perm => \n            perm.nombre.toLowerCase().includes(searchTerm.toLowerCase()) ||\n            perm.descripcion.toLowerCase().includes(searchTerm.toLowerCase())\n        )\n      })).filter(group => group.permissions.length > 0);\n    }\n\n    return filtered;\n  }, [permissionGroups, selectedModule, searchTerm]);\n\n  // Verificar si un rol tiene un permiso\n  const hasPermission = (roleId: number, permissionId: number): boolean => {\n    return rolePermissions.some(rp => rp.rol_id === roleId && rp.permiso_id === permissionId);\n  };\n\n  // Toggle permiso para un rol\n  const togglePermission = (roleId: number, permissionId: number) => {\n    const exists = hasPermission(roleId, permissionId);\n    \n    if (exists) {\n      // Remover permiso\n      setRolePermissions(prev => \n        prev.filter(rp => !(rp.rol_id === roleId && rp.permiso_id === permissionId))\n      );\n    } else {\n      // Agregar permiso\n      setRolePermissions(prev => [\n        ...prev,\n        { rol_id: roleId, permiso_id: permissionId }\n      ]);\n    }\n  };\n\n  // Seleccionar/deseleccionar todos los permisos de un m√≥dulo para un rol\n  const toggleModulePermissions = (roleId: number, module: string) => {\n    const modulePermissions = permissionGroups.find(g => g.module === module)?.permissions || [];\n    const allSelected = modulePermissions.every(perm => hasPermission(roleId, perm.id));\n\n    if (allSelected) {\n      // Deseleccionar todos\n      setRolePermissions(prev => \n        prev.filter(rp => \n          rp.rol_id !== roleId || \n          !modulePermissions.some(perm => perm.id === rp.permiso_id)\n        )\n      );\n    } else {\n      // Seleccionar todos\n      const newPermissions = modulePermissions\n        .filter(perm => !hasPermission(roleId, perm.id))\n        .map(perm => ({ rol_id: roleId, permiso_id: perm.id }));\n      \n      setRolePermissions(prev => [...prev, ...newPermissions]);\n    }\n  };\n\n  // Aplicar plantilla de rol\n  const applyRoleTemplate = (roleId: number, template: string) => {\n    // Primero limpiar permisos existentes del rol\n    setRolePermissions(prev => prev.filter(rp => rp.rol_id !== roleId));\n\n    let templatePermissions: string[] = [];\n\n    switch (template) {\n      case 'admin':\n        templatePermissions = permissions.map(p => p.nombre);\n        break;\n      case 'vendedor':\n        templatePermissions = [\n          'dashboard:view',\n          'clientes:view:own', 'clientes:create', 'clientes:edit:own',\n          'cotizaciones:view:own', 'cotizaciones:create', 'cotizaciones:edit:own', 'cotizaciones:print',\n          'pedidos:view:own', 'pedidos:create', 'pedidos:edit:own', 'pedidos:print',\n          'productos:view', 'inventario:view',\n          'seguimiento:view:own'\n        ];\n        break;\n      case 'supervisor':\n        templatePermissions = [\n          'dashboard:view', 'dashboard:analytics',\n          'clientes:view', 'clientes:create', 'clientes:edit', 'clientes:export',\n          'cotizaciones:view', 'cotizaciones:create', 'cotizaciones:edit', 'cotizaciones:approve', 'cotizaciones:reject', 'cotizaciones:convert', 'cotizaciones:print', 'cotizaciones:export',\n          'pedidos:view', 'pedidos:create', 'pedidos:edit', 'pedidos:confirm', 'pedidos:print',\n          'productos:view', 'inventario:view',\n          'seguimiento:view', 'seguimiento:edit',\n          'tareas:view', 'tareas:create', 'tareas:edit', 'tareas:assign'\n        ];\n        break;\n      case 'contador':\n        templatePermissions = [\n          'dashboard:view', 'dashboard:analytics', 'dashboard:reports',\n          'clientes:view', 'clientes:export',\n          'cotizaciones:view', 'cotizaciones:export',\n          'pedidos:view', 'pedidos:invoice', 'pedidos:print',\n          'facturas:view', 'facturas:create', 'facturas:edit', 'facturas:send', 'facturas:cancel', 'facturas:print', 'facturas:export', 'facturas:config',\n          'seguimiento:view'\n        ];\n        break;\n      case 'inventario':\n        templatePermissions = [\n          'dashboard:view',\n          'productos:view', 'productos:create', 'productos:edit', 'productos:bom', 'productos:export',\n          'inventario:view', 'inventario:create', 'inventario:edit', 'inventario:adjust', 'inventario:transfer', 'inventario:import', 'inventario:export', 'inventario:categories', 'inventario:thresholds',\n          'mantenimiento:view', 'mantenimiento:alerts', 'mantenimiento:thresholds', 'mantenimiento:replenishment', 'mantenimiento:predictions',\n          'optimizador:view', 'optimizador:create', 'optimizador:optimize', 'optimizador:export'\n        ];\n        break;\n      case 'produccion':\n        templatePermissions = [\n          'dashboard:view',\n          'pedidos:view', 'pedidos:print',\n          'productos:view', 'productos:bom',\n          'inventario:view', 'inventario:adjust',\n          'seguimiento:view', 'seguimiento:edit',\n          'tareas:view', 'tareas:edit', 'tareas:complete',\n          'optimizador:view', 'optimizador:create', 'optimizador:optimize', 'optimizador:export'\n        ];\n        break;\n      case 'lectura':\n        templatePermissions = [\n          'dashboard:view',\n          'clientes:view', 'clientes:export',\n          'cotizaciones:view', 'cotizaciones:print', 'cotizaciones:export',\n          'pedidos:view', 'pedidos:print',\n          'productos:view', 'inventario:view',\n          'facturas:view', 'facturas:print', 'facturas:export',\n          'seguimiento:view',\n          'tareas:view',\n          'mantenimiento:view'\n        ];\n        break;\n    }\n\n    // Agregar permisos de la plantilla\n    const newPermissions = permissions\n      .filter(perm => templatePermissions.includes(perm.nombre))\n      .map(perm => ({ rol_id: roleId, permiso_id: perm.id }));\n\n    setRolePermissions(prev => [...prev, ...newPermissions]);\n  };\n\n  // Guardar cambios\n  const saveChanges = async () => {\n    try {\n      setSaving(true);\n      setError('');\n\n      // Eliminar todas las relaciones existentes\n      const { error: deleteError } = await supabase\n        .from('rol_permisos')\n        .delete()\n        .neq('id', 0); // Eliminar todos\n\n      if (deleteError) throw deleteError;\n\n      // Insertar nuevas relaciones\n      if (rolePermissions.length > 0) {\n        const { error: insertError } = await supabase\n          .from('rol_permisos')\n          .insert(rolePermissions);\n\n        if (insertError) throw insertError;\n      }\n\n      showNotification('Permisos guardados correctamente', 'success');\n      onSave?.();\n    } catch (error) {\n      console.error('Error al guardar permisos:', error);\n      setError('Error al guardar los cambios');\n      showNotification('Error al guardar los permisos', 'error');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className={`bg-white rounded-lg shadow p-6 ${className}`}>\n        <div className=\"animate-pulse\">\n          <div className=\"h-6 bg-gray-200 rounded w-1/4 mb-4\"></div>\n          <div className=\"space-y-3\">\n            {[...Array(5)].map((_, i) => (\n              <div key={i} className=\"h-4 bg-gray-200 rounded\"></div>\n            ))}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <NotificationPopup\n        message={notification.message}\n        type={notification.type}\n        isVisible={notification.isVisible}\n        onClose={hideNotification}\n      />\n      \n      <div className={`bg-white rounded-lg shadow ${className}`}>\n        {/* Header */}\n        <div className=\"p-6 border-b border-gray-200\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div>\n              <h2 className=\"text-lg font-semibold text-gray-900\">Matriz de Permisos</h2>\n              <p className=\"text-sm text-gray-600\">Gestiona los permisos por rol de forma visual</p>\n            </div>\n            <button\n              onClick={saveChanges}\n              disabled={saving}\n              className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center whitespace-nowrap\"\n            >\n              {saving ? (\n                <>\n                  <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\n                  Guardando...\n                </>\n              ) : (\n                <>\n                  <i className=\"ri-save-line mr-2\"></i>\n                  Guardar Cambios\n                </>\n              )}\n            </button>\n          </div>\n\n          {/* Filtros */}\n          <div className=\"flex flex-col sm:flex-row gap-4\">\n            <div className=\"flex-1\">\n              <input\n                type=\"text\"\n                placeholder=\"Buscar permisos...\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm\"\n              />\n            </div>\n            <div className=\"sm:w-48\">\n              <select\n                value={selectedModule}\n                onChange={(e) => setSelectedModule(e.target.value)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm\"\n              >\n                <option value=\"all\">Todos los m√≥dulos</option>\n                {permissionGroups.map(group => (\n                  <option key={group.module} value={group.module}>\n                    {group.module.charAt(0).toUpperCase() + group.module.slice(1)}\n                  </option>\n                ))}\n              </select>\n            </div>\n          </div>\n\n          {error && (\n            <div className=\"mt-4 bg-red-50 border border-red-200 rounded-lg p-3\">\n              <div className=\"flex items-center\">\n                <i className=\"ri-error-warning-line text-red-500 mr-2\"></i>\n                <span className=\"text-red-700 text-sm\">{error}</span>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Plantillas r√°pidas */}\n        <div className=\"p-6 border-b border-gray-200 bg-gray-50\">\n          <h3 className=\"text-sm font-medium text-gray-900 mb-3\">Plantillas R√°pidas</h3>\n          <div className=\"space-y-3\">\n            {roles.map(role => (\n              <div key={role.id} className=\"flex flex-col sm:flex-row sm:items-center gap-2\">\n                <span className=\"text-sm font-medium text-gray-700 min-w-[120px]\">{role.nombre}:</span>\n                <div className=\"flex flex-wrap gap-2\">\n                  <button\n                    onClick={() => applyRoleTemplate(role.id, 'admin')}\n                    className=\"px-3 py-1.5 text-xs bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 whitespace-nowrap\"\n                    title=\"Acceso total al sistema\"\n                  >\n                    <i className=\"ri-admin-line mr-1\"></i>\n                    Admin\n                  </button>\n                  <button\n                    onClick={() => applyRoleTemplate(role.id, 'vendedor')}\n                    className=\"px-3 py-1.5 text-xs bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 whitespace-nowrap\"\n                    title=\"Ventas y cotizaciones propias\"\n                  >\n                    <i className=\"ri-user-line mr-1\"></i>\n                    Vendedor\n                  </button>\n                  <button\n                    onClick={() => applyRoleTemplate(role.id, 'supervisor')}\n                    className=\"px-3 py-1.5 text-xs bg-green-100 text-green-700 rounded-lg hover:bg-green-200 whitespace-nowrap\"\n                    title=\"Supervisi√≥n de ventas y operaciones\"\n                  >\n                    <i className=\"ri-shield-user-line mr-1\"></i>\n                    Supervisor\n                  </button>\n                  <button\n                    onClick={() => applyRoleTemplate(role.id, 'contador')}\n                    className=\"px-3 py-1.5 text-xs bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200 whitespace-nowrap\"\n                    title=\"Facturaci√≥n y reportes financieros\"\n                  >\n                    <i className=\"ri-calculator-line mr-1\"></i>\n                    Contador\n                  </button>\n                  <button\n                    onClick={() => applyRoleTemplate(role.id, 'inventario')}\n                    className=\"px-3 py-1.5 text-xs bg-orange-100 text-orange-700 rounded-lg hover:bg-orange-200 whitespace-nowrap\"\n                    title=\"Gesti√≥n de inventario y productos\"\n                  >\n                    <i className=\"ri-archive-line mr-1\"></i>\n                    Inventario\n                  </button>\n                  <button\n                    onClick={() => applyRoleTemplate(role.id, 'produccion')}\n                    className=\"px-3 py-1.5 text-xs bg-indigo-100 text-indigo-700 rounded-lg hover:bg-indigo-200 whitespace-nowrap\"\n                    title=\"Producci√≥n, tareas y optimizador\"\n                  >\n                    <i className=\"ri-tools-line mr-1\"></i>\n                    Producci√≥n\n                  </button>\n                  <button\n                    onClick={() => applyRoleTemplate(role.id, 'lectura')}\n                    className=\"px-3 py-1.5 text-xs bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 whitespace-nowrap\"\n                    title=\"Solo visualizaci√≥n de datos\"\n                  >\n                    <i className=\"ri-eye-line mr-1\"></i>\n                    Solo Lectura\n                  </button>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* Matriz de permisos */}\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sticky left-0 bg-gray-50 z-10\">\n                  Permiso\n                </th>\n                {roles.map(role => (\n                  <th key={role.id} className=\"px-3 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[100px]\">\n                    {role.nombre}\n                  </th>\n                ))}\n              </tr>\n            </thead>\n            <tbody className=\"bg-white divide-y divide-gray-200\">\n              {filteredGroups.map(group => (\n                <React.Fragment key={group.module}>\n                  {/* Header del m√≥dulo */}\n                  <tr className=\"bg-blue-50\">\n                    <td className=\"px-6 py-3 text-sm font-medium text-blue-900 sticky left-0 bg-blue-50 z-10\">\n                      <div className=\"flex items-center\">\n                        <i className=\"ri-folder-line mr-2\"></i>\n                        {group.module.charAt(0).toUpperCase() + group.module.slice(1)}\n                      </div>\n                    </td>\n                    {roles.map(role => (\n                      <td key={role.id} className=\"px-3 py-3 text-center\">\n                        <button\n                          onClick={() => toggleModulePermissions(role.id, group.module)}\n                          className=\"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded hover:bg-blue-200 whitespace-nowrap\"\n                        >\n                          Todo\n                        </button>\n                      </td>\n                    ))}\n                  </tr>\n                  \n                  {/* Permisos del m√≥dulo */}\n                  {group.permissions.map(permission => (\n                    <tr key={permission.id} className=\"hover:bg-gray-50\">\n                      <td className=\"px-6 py-3 sticky left-0 bg-white z-10\">\n                        <div>\n                          <div className=\"text-sm font-medium text-gray-900\">\n                            {permission.nombre}\n                          </div>\n                          <div className=\"text-xs text-gray-500\">\n                            {permission.descripcion}\n                          </div>\n                        </div>\n                      </td>\n                      {roles.map(role => (\n                        <td key={role.id} className=\"px-3 py-3 text-center\">\n                          <input\n                            type=\"checkbox\"\n                            checked={hasPermission(role.id, permission.id)}\n                            onChange={() => togglePermission(role.id, permission.id)}\n                            className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer\"\n                          />\n                        </td>\n                      ))}\n                    </tr>\n                  ))}\n                </React.Fragment>\n              ))}\n            </tbody>\n          </table>\n        </div>\n\n        {filteredGroups.length === 0 && (\n          <div className=\"p-6 text-center text-gray-500\">\n            <i className=\"ri-search-line text-2xl mb-2\"></i>\n            <p>No se encontraron permisos que coincidan con los filtros</p>\n          </div>\n        )}\n      </div>\n    </>\n  );\n}","\nimport { ReactNode } from 'react';\nimport { useAuth } from '../../hooks/useAuth';\n\ninterface PermissionWrapperProps {\n  permission?: string;\n  role?: string;\n  module?: string;\n  action?: 'read' | 'write' | 'delete';\n  children: ReactNode;\n  fallback?: ReactNode;\n}\n\nexport function PermissionWrapper({\n  permission,\n  role,\n  module,\n  action,\n  children,\n  fallback = null\n}: PermissionWrapperProps) {\n  const { hasPermission, hasRole, canRead, canWrite, canDelete, isAuthenticated, loading } = useAuth();\n\n  // SEGURIDAD CR√çTICA: Verificar autenticaci√≥n primero\n  if (!isAuthenticated || loading) {\n    return <>{fallback}</>;\n  }\n\n  // Verificar permisos de forma estricta\n  const hasAccess = () => {\n    // Verificar rol espec√≠fico\n    if (role && !hasRole(role)) return false;\n    \n    // Verificar permiso espec√≠fico\n    if (permission && !hasPermission(permission)) return false;\n    \n    // Verificar permisos por m√≥dulo y acci√≥n\n    if (module && action) {\n      switch (action) {\n        case 'read':\n          return canRead(module);\n        case 'write':\n          return canWrite(module);\n        case 'delete':\n          return canDelete(module);\n        default:\n          return false;\n      }\n    }\n    \n    return true;\n  };\n\n  // SEGURIDAD CR√çTICA: Solo mostrar contenido si tiene acceso\n  if (!hasAccess()) {\n    return <>{fallback}</>;\n  }\n\n  return <>{children}</>;\n}\n","\nimport React, { useState } from 'react';\nimport { SeguridadLayout } from './components/SeguridadLayout';\nimport { UsuariosTab } from './components/UsuariosTab';\nimport { UsuariosPendientesTab } from './components/UsuariosPendientesTab';\nimport { RolesTab } from './components/RolesTab';\nimport { PermisosTab } from './components/PermisosTab';\nimport { PermissionMatrix } from '../../components/security/PermissionMatrix';\nimport { PermissionWrapper } from '../../components/base/PermissionWrapper';\nimport { supabase } from '../../lib/supabase';\n\ntype TabType = 'usuarios' | 'pendientes' | 'roles' | 'permisos' | 'matriz' | 'password';\n\nexport default function SeguridadPage() {\n  const [activeTab, setActiveTab] = useState<TabType>('usuarios');\n  const [passwordData, setPasswordData] = useState({\n    currentPassword: '',\n    newPassword: '',\n    confirmPassword: ''\n  });\n  const [passwordLoading, setPasswordLoading] = useState(false);\n  const [passwordMessage, setPasswordMessage] = useState<{ type: 'success' | 'error'; text: string } | null>(null);\n\n  const tabs = [\n    { id: 'usuarios' as TabType, name: 'Usuarios', icon: 'ri-user-line' },\n    { \n      id: 'pendientes' as TabType, \n      name: 'Usuarios Pendientes', \n      icon: 'ri-time-line',\n      permission: 'seguridad:usuarios:view_pendientes'\n    },\n    { id: 'roles' as TabType, name: 'Roles', icon: 'ri-shield-user-line' },\n    { id: 'permisos' as TabType, name: 'Permisos', icon: 'ri-key-line' },\n    { id: 'matriz' as TabType, name: 'Matriz de Permisos', icon: 'ri-grid-line' },\n    { id: 'password' as TabType, name: 'Cambiar Contrase√±a', icon: 'ri-lock-password-line' }\n  ];\n\n  const handlePasswordChange = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setPasswordMessage(null);\n\n    // Validaciones\n    if (!passwordData.newPassword || !passwordData.confirmPassword) {\n      setPasswordMessage({ type: 'error', text: 'Por favor complete todos los campos' });\n      return;\n    }\n\n    if (passwordData.newPassword.length < 6) {\n      setPasswordMessage({ type: 'error', text: 'La contrase√±a debe tener al menos 6 caracteres' });\n      return;\n    }\n\n    if (passwordData.newPassword !== passwordData.confirmPassword) {\n      setPasswordMessage({ type: 'error', text: 'Las contrase√±as no coinciden' });\n      return;\n    }\n\n    setPasswordLoading(true);\n    try {\n      const { error } = await supabase.auth.updateUser({\n        password: passwordData.newPassword\n      });\n\n      if (error) throw error;\n\n      setPasswordMessage({ type: 'success', text: 'Contrase√±a actualizada exitosamente' });\n      setPasswordData({ currentPassword: '', newPassword: '', confirmPassword: '' });\n    } catch (error: any) {\n      console.error('Error cambiando contrase√±a:', error);\n      setPasswordMessage({ type: 'error', text: error.message || 'Error al cambiar la contrase√±a' });\n    } finally {\n      setPasswordLoading(false);\n    }\n  };\n\n  const renderPasswordTab = () => (\n    <div className=\"max-w-md mx-auto\">\n      <div className=\"bg-white rounded-lg shadow p-6\">\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Cambiar Contrase√±a</h3>\n        \n        {passwordMessage && (\n          <div className={`p-4 rounded-lg mb-4 ${\n            passwordMessage.type === 'success' \n              ? 'bg-green-50 text-green-800 border border-green-200' \n              : 'bg-red-50 text-red-800 border border-red-200'\n          }`}>\n            <div className=\"flex items-center\">\n              <i className={`${passwordMessage.type === 'success' ? 'ri-check-line' : 'ri-error-warning-line'} mr-2`}></i>\n              {passwordMessage.text}\n            </div>\n          </div>\n        )}\n\n        <form onSubmit={handlePasswordChange} className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Nueva Contrase√±a\n            </label>\n            <input\n              type=\"password\"\n              value={passwordData.newPassword}\n              onChange={(e) => setPasswordData(prev => ({ ...prev, newPassword: e.target.value }))}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              placeholder=\"Ingrese la nueva contrase√±a\"\n              minLength={6}\n            />\n            <p className=\"text-xs text-gray-500 mt-1\">M√≠nimo 6 caracteres</p>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Confirmar Nueva Contrase√±a\n            </label>\n            <input\n              type=\"password\"\n              value={passwordData.confirmPassword}\n              onChange={(e) => setPasswordData(prev => ({ ...prev, confirmPassword: e.target.value }))}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              placeholder=\"Confirme la nueva contrase√±a\"\n            />\n          </div>\n\n          <button\n            type=\"submit\"\n            disabled={passwordLoading}\n            className=\"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors cursor-pointer whitespace-nowrap\"\n          >\n            {passwordLoading ? (\n              <>\n                <i className=\"ri-loader-4-line animate-spin mr-2\"></i>\n                Actualizando...\n              </>\n            ) : (\n              <>\n                <i className=\"ri-lock-password-line mr-2\"></i>\n                Cambiar Contrase√±a\n              </>\n            )}\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n\n  const renderTabContent = () => {\n    switch (activeTab) {\n      case 'usuarios':\n        return <UsuariosTab />;\n      case 'pendientes':\n        return (\n          <PermissionWrapper permission=\"seguridad:usuarios:view_pendientes\">\n            <UsuariosPendientesTab />\n          </PermissionWrapper>\n        );\n      case 'roles':\n        return <RolesTab />;\n      case 'permisos':\n        return <PermisosTab />;\n      case 'matriz':\n        return (\n          <PermissionMatrix \n            onSave={() => {\n              console.log('Permisos guardados exitosamente');\n            }}\n          />\n        );\n      case 'password':\n        return renderPasswordTab();\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <SeguridadLayout>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">Seguridad</h1>\n          <p className=\"text-gray-600\">Gestiona usuarios, roles y permisos del sistema</p>\n        </div>\n\n        {/* Tabs */}\n        <div className=\"border-b border-gray-200\">\n          <nav className=\"-mb-px flex space-x-8 overflow-x-auto\">\n            {tabs.map((tab) => {\n              // Si la pesta√±a requiere permisos, verificar antes de mostrarla\n              if (tab.permission) {\n                return (\n                  <PermissionWrapper key={tab.id} permission={tab.permission}>\n                    <button\n                      onClick={() => setActiveTab(tab.id)}\n                      className={`py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap flex items-center cursor-pointer ${\n                        activeTab === tab.id\n                          ? 'border-blue-500 text-blue-600'\n                          : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                      }`}\n                    >\n                      <i className={`${tab.icon} mr-2`}></i>\n                      {tab.name}\n                    </button>\n                  </PermissionWrapper>\n                );\n              }\n\n              return (\n                <button\n                  key={tab.id}\n                  onClick={() => setActiveTab(tab.id)}\n                  className={`py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap flex items-center cursor-pointer ${\n                    activeTab === tab.id\n                      ? 'border-blue-500 text-blue-600'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                  }`}\n                >\n                  <i className={`${tab.icon} mr-2`}></i>\n                  {tab.name}\n                </button>\n              );\n            })}\n          </nav>\n        </div>\n\n        {/* Tab Content */}\n        <div className=\"mt-6\">\n          {renderTabContent()}\n        </div>\n      </div>\n    </SeguridadLayout>\n  );\n}\n"],"names":["SeguridadLayout","children","sidebarOpen","setSidebarOpen","useState","jsxs","jsx","Sidebar","TopBar","MobileNav","UsuarioForm","usuario","onClose","onSave","formData","setFormData","roles","setRoles","tiendas","setTiendas","loading","setLoading","error","setError","useEffect","cargarRoles","cargarTiendas","cargarTiendaActual","data","supabase","rolesArray","r","usuarioId","prev","handleSubmit","e","tiendaAcceso","accesoError","insertAccesoError","tiendaError","deleteError","rol","tienda","UsuariosPendientesService","usuariosConTienda","errorTiendas","idsConTienda","ut","query","idsString","id","usuariosPendientes","errorUsuarios","resultado","request","errorUsuario","errorTienda","errorAsignacion","errorTiendaActual","usuariosPendientesService","AsignarTiendaModal","onSuccess","selectedTienda","setSelectedTienda","loadingTiendas","setLoadingTiendas","showNotification","useNotification","handleAsignar","tiendaSeleccionada","t","Fragment","UsuariosTab","usuarios","setUsuarios","showForm","setShowForm","editingUsuario","setEditingUsuario","showAsignarTienda","setShowAsignarTienda","usuarioParaTienda","setUsuarioParaTienda","cargarUsuarios","tiendaNombre","tiendaData","usuariosSinTienda","errorFallback","u","fallbackError","handleEdit","handleDelete","handleToggleActivo","handleAsignarTienda","UsuariosPendientesTab","searchTerm","setSearchTerm","showAsignarModal","setShowAsignarModal","selectedUsuario","setSelectedUsuario","cargarUsuariosPendientes","handleRechazarRegistro","handleAsignacionExitosa","usuariosFiltrados","today","userDate","PermissionButton","RolForm","permisos","setPermisos","permisosSeleccionados","setPermisosSeleccionados","cargarPermisos","cargarPermisosRol","rolId","permisosIds","rp","handlePermisoChange","permisoId","checked","rolPermisos","permisosError","permiso","RolesTab","editingRol","setEditingRol","rolesFiltrados","PermisoForm","PermisosTab","editingPermiso","setEditingPermiso","notification","showSuccess","showError","hideNotification","permisosFiltrados","NotificationPopup","PermissionMatrix","className","permissions","setPermissions","rolePermissions","setRolePermissions","saving","setSaving","selectedModule","setSelectedModule","loadData","rolesData","rolesError","permissionsData","permissionsError","rolePermissionsData","rolePermissionsError","permissionGroups","useMemo","groups","permission","module","perms","a","b","filteredGroups","filtered","group","perm","hasPermission","roleId","permissionId","togglePermission","exists","toggleModulePermissions","modulePermissions","g","newPermissions","applyRoleTemplate","template","templatePermissions","p","saveChanges","insertError","_","i","role","React","PermissionWrapper","action","fallback","hasRole","canRead","canWrite","canDelete","isAuthenticated","useAuth","SeguridadPage","activeTab","setActiveTab","passwordData","setPasswordData","passwordLoading","setPasswordLoading","passwordMessage","setPasswordMessage","tabs","handlePasswordChange","renderPasswordTab","renderTabContent","tab"],"mappings":"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"}