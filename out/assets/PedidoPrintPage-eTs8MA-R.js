import{c as p,r as d,j as e}from"./index-Bb3NupjY.js";import{p as h}from"./pedidoService-D09prSNX.js";import{f as r}from"./currency-BmxXlzML.js";function u(){const{id:n}=p(),[s,c]=d.useState(null),[l,o]=d.useState(!0);d.useEffect(()=>{n&&x(parseInt(n))},[n]),d.useEffect(()=>{const t=setTimeout(()=>{window.print()},1e3);return()=>clearTimeout(t)},[s]);const x=async t=>{try{const a=await h.getPedidoById(t);c(a)}catch(a){console.error("Error al cargar pedido:",a)}finally{o(!1)}};return l?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{children:"Cargando pedido..."})]})}):s?e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsxs("div",{className:"print:hidden fixed top-4 right-4 flex gap-2 z-10",children:[e.jsxs("button",{onClick:()=>window.print(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center gap-2",children:[e.jsx("i",{className:"ri-printer-line"}),"Imprimir"]}),e.jsxs("button",{onClick:()=>window.close(),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 flex items-center gap-2",children:[e.jsx("i",{className:"ri-close-line"}),"Cerrar"]})]}),e.jsxs("div",{className:"max-w-4xl mx-auto p-8 print:p-0",children:[e.jsxs("div",{className:"text-center mb-8 pb-6 border-b-2 border-gray-300",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",style:{fontFamily:"Pacifico, serif"},children:"OLO"}),e.jsx("p",{className:"text-gray-600",children:"Sistema de Gestión Empresarial"}),e.jsx("p",{className:"text-sm text-gray-500",children:"San José, Costa Rica • Tel: (506) 2205-2525 • Email: info@olo.cr"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"PEDIDO DE VENTA"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Número:"}),e.jsx("span",{children:s.codigo})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Fecha de emisión:"}),e.jsx("span",{children:new Date(s.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Estado:"}),e.jsx("span",{className:"capitalize font-medium",children:s.estado})]}),s.confirmado_at&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Fecha confirmación:"}),e.jsx("span",{children:new Date(s.confirmado_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Moneda:"}),e.jsx("span",{children:s.moneda})]}),s.tipo_cambio!==1&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Tipo de cambio:"}),e.jsxs("span",{children:["₡",s.tipo_cambio.toFixed(2)]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Información del Cliente"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Nombre:"}),e.jsx("div",{children:s.cliente?.nombre||"Cliente Ejemplo S.A."})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Identificación:"}),e.jsx("div",{children:s.cliente?.identificacion||"3-101-2562-32"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Email:"}),e.jsx("div",{children:s.cliente?.email||"cliente@ejemplo.com"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Teléfono:"}),e.jsx("div",{children:s.cliente?.telefono||"2205-2525"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Dirección:"}),e.jsx("div",{children:s.cliente?.direccion||"San José, Costa Rica"})]})]})]})]}),s.cotizacion&&e.jsx("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Referencia:"})," Pedido generado desde cotización ",s.cotizacion.numero_cotizacion]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Detalle de Productos"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-sm font-medium",children:"Código"}),e.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-sm font-medium",children:"Descripción"}),e.jsx("th",{className:"border border-gray-300 px-3 py-2 text-center text-sm font-medium",children:"Unidad"}),e.jsx("th",{className:"border border-gray-300 px-3 py-2 text-right text-sm font-medium",children:"Cantidad"}),e.jsx("th",{className:"border border-gray-300 px-3 py-2 text-right text-sm font-medium",children:"Precio Unit."}),e.jsx("th",{className:"border border-gray-300 px-3 py-2 text-right text-sm font-medium",children:"Descuento"}),e.jsx("th",{className:"border border-gray-300 px-3 py-2 text-right text-sm font-medium",children:"Total"})]})}),e.jsxs("tbody",{children:[s.items.map((t,a)=>e.jsxs("tr",{className:"product-with-components",children:[e.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm",children:t.codigo_articulo}),e.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm",children:t.descripcion}),e.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm text-center",children:t.unidad}),e.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm text-right",children:t.cantidad}),e.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm text-right",children:r(t.precio_unitario,s.moneda)}),e.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm text-right",children:t.descuento_porcentaje>0?`${t.descuento_porcentaje}%`:"-"}),e.jsx("td",{className:"border border-gray-300 px-3 py-2 text-sm text-right font-medium",children:r(t.total_linea,s.moneda)})]},a)),s.items.map((t,a)=>t.meta_json?.bom_items?.map((i,m)=>e.jsxs("tr",{className:"bg-blue-50 bom-section",children:[e.jsxs("td",{className:"border border-gray-300 px-6 py-1 text-xs text-gray-600",children:["└ ",i.codigo]}),e.jsx("td",{className:"border border-gray-300 px-6 py-1 text-xs text-gray-600",children:i.descripcion}),e.jsx("td",{className:"border border-gray-300 px-3 py-1 text-xs text-gray-600 text-center",children:i.unidad}),e.jsx("td",{className:"border border-gray-300 px-3 py-1 text-xs text-gray-600 text-right",children:i.cantidad_total}),e.jsx("td",{className:"border border-gray-300 px-3 py-1 text-xs text-gray-600 text-right",children:r(i.precio_unitario,s.moneda)}),e.jsx("td",{className:"border border-gray-300 px-3 py-1 text-xs text-gray-600 text-right",children:"-"}),e.jsx("td",{className:"border border-gray-300 px-3 py-1 text-xs text-gray-600 text-right",children:r(i.total,s.moneda)})]},`${a}-bom-${m}`)))]})]})})]}),e.jsx("div",{className:"totals-section mb-8",children:e.jsx("div",{className:"max-w-md ml-auto",children:e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subtotal:"}),e.jsx("span",{children:r(s.subtotal,s.moneda)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Descuento:"}),e.jsxs("span",{children:["-",r(s.descuento_total,s.moneda)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Impuesto:"}),e.jsx("span",{children:r(s.impuesto_total,s.moneda)})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{children:r(s.total,s.moneda)})]})]})})}),s.notas&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Notas"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:s.notas})})]}),e.jsxs("div",{className:"text-center text-xs text-gray-500 border-t pt-4",children:[e.jsx("p",{children:"Este documento fue generado automáticamente por el Sistema OLO"}),e.jsxs("p",{children:["Fecha de impresión: ",new Date().toLocaleString()]})]})]}),e.jsx("style",{jsx:!0,children:`
        @media print {
          .print:hidden {
            display: none !important;
          }
          
          .print:p-0 {
            padding: 0 !important;
          }
          
          body {
            -webkit-print-color-adjust: exact;
            color-adjust: exact;
          }
          
          .product-with-components {
            page-break-inside: avoid;
          }
          
          .bom-section {
            page-break-inside: avoid;
          }
          
          .totals-section {
            page-break-inside: avoid;
          }
          
          .client-info {
            page-break-inside: avoid;
          }
          
          table {
            page-break-inside: auto;
          }
          
          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }
          
          thead {
            display: table-header-group;
          }
          
          tfoot {
            display: table-footer-group;
          }
        }
      `})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-600",children:"Error: No se pudo cargar el pedido"}),e.jsx("button",{onClick:()=>window.close(),className:"mt-4 px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Cerrar"})]})})}export{u as default};
//# sourceMappingURL=PedidoPrintPage-eTs8MA-R.js.map
