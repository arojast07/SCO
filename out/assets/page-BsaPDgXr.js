import{r as i,j as e,s as u,b as F,R as J,a as I}from"./index-Bb3NupjY.js";import{S as W,T as H}from"./TopBar-BP5RF_Jd.js";import{M as Q}from"./MobileNav-Dp72TdL_.js";import{P as $}from"./PermissionButton-DmJRPklx.js";import{N as G}from"./NotificationPopup-Br5iZ8zM.js";function K({children:a}){const[l,d]=i.useState(!1);return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[e.jsx(W,{isOpen:l,onClose:()=>d(!1)}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsx(H,{onMenuClick:()=>d(!0)}),e.jsx("main",{className:"flex-1 p-4 lg:p-6 pb-20 lg:pb-6 overflow-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:a})})]}),e.jsx(Q,{})]})}function X({usuario:a,onClose:l,onSuccess:d}){const[o,g]=i.useState({email:a?.email||"",nombre_completo:a?.nombre_completo||"",rol:a?.rol||"Lectura"}),[p,y]=i.useState([]),[s,h]=i.useState([]),[v,w]=i.useState(""),[f,m]=i.useState(!1),[C,x]=i.useState(null),N=["Admin","Cliente","Compras","Lectura","Operaciones","Pruebas","Vendedor","Ventas"];i.useEffect(()=>{b(),a?.id&&t()},[a]);const b=async()=>{try{const{data:c,error:S}=await u.from("tiendas").select("id, nombre, codigo").eq("activo",!0).order("nombre");if(S)throw S;y(c||[])}catch(c){console.error("Error al cargar tiendas:",c)}},t=async()=>{try{const{data:c,error:S}=await u.from("usuario_tiendas").select(`
          tienda_id,
          tiendas (
            id,
            nombre,
            codigo
          )
        `).eq("usuario_id",a.id).eq("activo",!0);if(S)throw S;const T=c?.map(A=>({id:A.tiendas.id,nombre:A.tiendas.nombre,codigo:A.tiendas.codigo}))||[];h(T)}catch(c){console.error("Error al cargar tiendas asignadas:",c)}},r=()=>{if(!v)return;const c=p.find(S=>S.id===v);if(c){if(s.some(S=>S.id===c.id)){x("Esta tienda ya estÃ¡ asignada");return}h([...s,c]),w(""),x(null)}},E=c=>{h(s.filter(S=>S.id!==c))},k=async c=>{c.preventDefault(),m(!0),x(null);try{if(a){const{error:S}=await u.from("usuarios").update({nombre_completo:o.nombre_completo,rol:o.rol,updated_at:new Date().toISOString()}).eq("id",a.id);if(S)throw S;const{error:T}=await u.from("usuario_tiendas").delete().eq("usuario_id",a.id);if(T)throw T;if(s.length>0){const A=s.map(U=>({usuario_id:a.id,tienda_id:U.id,activo:!0})),{error:L}=await u.from("usuario_tiendas").insert(A);if(L)throw L;const{data:q}=await u.from("usuario_tienda_actual").select("tienda_id").eq("usuario_id",a.id).single();q?s.some(M=>M.id===q.tienda_id)||await u.from("usuario_tienda_actual").update({tienda_id:s[0].id}).eq("usuario_id",a.id):await u.from("usuario_tienda_actual").upsert({usuario_id:a.id,tienda_id:s[0].id})}else await u.from("usuario_tienda_actual").delete().eq("usuario_id",a.id)}else{const{data:S,error:T}=await u.from("usuarios").insert({email:o.email,nombre_completo:o.nombre_completo,rol:o.rol}).select().single();if(T)throw T;if(s.length>0){const A=s.map(q=>({usuario_id:S.id,tienda_id:q.id,activo:!0})),{error:L}=await u.from("usuario_tiendas").insert(A);if(L)throw L;await u.from("usuario_tienda_actual").insert({usuario_id:S.id,tienda_id:s[0].id})}}d(),l()}catch(S){console.error("Error guardando usuario:",S),x(S.message||"Error al guardar el usuario")}finally{m(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:a?"Editar Usuario":"Nuevo Usuario"}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),C&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:C}),e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:o.email,onChange:c=>g({...o,email:c.target.value}),disabled:!!a,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed text-sm",required:!0}),a&&e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"El email no se puede modificar"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Completo"}),e.jsx("input",{type:"text",value:o.nombre_completo,onChange:c=>g({...o,nombre_completo:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),e.jsx("select",{value:o.rol,onChange:c=>g({...o,rol:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm",required:!0,children:N.map(c=>e.jsx("option",{value:c,children:c},c))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tiendas Asignadas"}),s.length>0?e.jsx("div",{className:"mb-3 flex flex-wrap gap-2",children:s.map(c=>e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-teal-50 text-teal-700 rounded-full text-sm",children:[e.jsx("span",{className:"font-medium",children:c.codigo}),e.jsx("span",{className:"text-teal-600",children:"â€¢"}),e.jsx("span",{children:c.nombre}),e.jsx("button",{type:"button",onClick:()=>E(c.id),className:"ml-1 text-teal-600 hover:text-teal-800",children:e.jsx("i",{className:"ri-close-line text-base"})})]},c.id))}):e.jsx("div",{className:"mb-3 p-3 bg-gray-50 rounded-lg text-sm text-gray-500 text-center",children:"No hay tiendas asignadas"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:v,onChange:c=>w(c.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"Seleccionar tienda..."}),p.filter(c=>!s.some(S=>S.id===c.id)).map(c=>e.jsxs("option",{value:c.id,children:[c.codigo," - ",c.nombre]},c.id))]}),e.jsxs("button",{type:"button",onClick:r,disabled:!v,className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-sm whitespace-nowrap",children:[e.jsx("i",{className:"ri-add-line mr-1"}),"Agregar"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 text-sm whitespace-nowrap",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:f,className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-sm whitespace-nowrap",children:f?"Guardando...":a?"Actualizar":"Crear"})]})]})]})})}class Y{async obtenerUsuariosPendientes(){try{console.log("ðŸ” Obteniendo usuarios pendientes...");const{data:l,error:d}=await u.from("usuario_tiendas").select("usuario_id").eq("activo",!0);if(d)throw console.error("âŒ Error obteniendo usuarios con tienda:",d),d;const o=l?.map(h=>h.usuario_id)||[];console.log("ðŸ“‹ IDs con tienda asignada:",o);let g=u.from("usuarios").select(`
          id,
          nombre_completo,
          email,
          activo,
          created_at,
          roles(nombre)
        `).eq("activo",!0);if(o.length>0){const h=o.map(v=>`"${v}"`).join(",");g=g.not("id","in",`(${h})`)}const{data:p,error:y}=await g;if(y)throw console.error("âŒ Error obteniendo usuarios pendientes:",y),y;const s=p?.map(h=>({id:h.id,nombre_completo:h.nombre_completo,email:h.email,rol:h.roles?.nombre||"Sin rol",activo:h.activo,created_at:h.created_at}))||[];return console.log("âœ… Usuarios pendientes obtenidos:",s.length),s}catch(l){throw console.error("âŒ Error en obtenerUsuariosPendientes:",l),new Error(`Error cargando usuarios pendientes: ${JSON.stringify(l)}`)}}async obtenerTiendasDisponibles(){try{console.log("ðŸª Obteniendo tiendas disponibles...");const{data:l,error:d}=await u.from("tiendas").select("id, nombre, codigo, activo").eq("activo",!0).order("nombre");if(d)throw console.error("âŒ Error obteniendo tiendas:",d),d;return console.log("âœ… Tiendas disponibles:",l?.length||0),l||[]}catch(l){throw console.error("âŒ Error en obtenerTiendasDisponibles:",l),new Error(`Error cargando tiendas: ${JSON.stringify(l)}`)}}async asignarTienda(l){try{console.log("ðŸª Asignando tienda:",l);const{data:d,error:o}=await u.from("usuarios").select("id, nombre_completo").eq("id",l.usuario_id).eq("activo",!0).single();if(o||!d)throw new Error("Usuario no encontrado o inactivo");const{data:g,error:p}=await u.from("tiendas").select("id, nombre").eq("id",l.tienda_id).eq("activo",!0).single();if(p||!g)throw new Error("Tienda no encontrada o inactiva");console.log("âœ… Usuario y tienda vÃ¡lidos:",{usuario:d.nombre_completo,tienda:g.nombre});const{error:y}=await u.from("usuario_tiendas").insert({usuario_id:l.usuario_id,tienda_id:l.tienda_id,activo:!0});if(y)throw console.error("âŒ Error creando usuario_tiendas:",y),y;console.log("âœ… Registro usuario_tiendas creado");const{error:s}=await u.from("usuario_tienda_actual").upsert({usuario_id:l.usuario_id,tienda_id:l.tienda_id});if(s)throw console.error("âŒ Error estableciendo tienda actual:",s),await u.from("usuario_tiendas").delete().eq("usuario_id",l.usuario_id).eq("tienda_id",l.tienda_id),s;console.log("âœ… Tienda asignada exitosamente:",{usuario:d.nombre_completo,tienda:g.nombre})}catch(d){throw console.error("âŒ Error en asignarTienda:",d),new Error(`Error asignando tienda: ${JSON.stringify(d)}`)}}}const R=new Y;function V({usuario:a,onClose:l,onSuccess:d}){const[o,g]=i.useState([]),[p,y]=i.useState(""),[s,h]=i.useState(!1),[v,w]=i.useState(!0),{showNotification:f}=F();i.useEffect(()=>{m()},[]);const m=async()=>{try{w(!0);const N=await R.obtenerTiendasDisponibles();g(N),N.length===1&&y(N[0].id)}catch(N){console.error("Error cargando tiendas:",N),f("Error al cargar tiendas disponibles","error")}finally{w(!1)}},C=async()=>{if(!p){f("Por favor selecciona una tienda","error");return}try{h(!0),await R.asignarTienda({usuario_id:a.id,tienda_id:p}),d()}catch(N){console.error("Error asignando tienda:",N),f("Error al asignar la tienda","error")}finally{h(!1)}},x=o.find(N=>N.id===p);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Asignar Tienda a Usuario"}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("i",{className:"ri-close-line text-xl"})})]})}),e.jsxs("div",{className:"px-6 py-4 space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"InformaciÃ³n del Usuario"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-user-line text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Nombre:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 ml-2",children:a.nombre_completo})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-mail-line text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Email:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 ml-2",children:a.email})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-shield-user-line text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Rol:"}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 ml-2",children:a.rol})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-calendar-line text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Registro:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 ml-2",children:new Date(a.created_at).toLocaleDateString()})]})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-time-line text-yellow-600 mt-0.5 mr-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Estado Actual: Pendiente de AsignaciÃ³n de Tienda"}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Este usuario no puede acceder al sistema hasta que se le asigne una tienda."})]})]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tienda",className:"block text-sm font-medium text-gray-700 mb-2",children:"Seleccionar Tienda *"}),v?e.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-400 mr-2"}),"Cargando tiendas..."]})}):o.length===0?e.jsx("div",{className:"w-full px-3 py-2 border border-red-300 rounded-md bg-red-50 text-red-600 text-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-error-warning-line mr-2"}),"No hay tiendas disponibles"]})}):e.jsxs("select",{id:"tienda",value:p,onChange:N=>y(N.target.value),className:"w-full px-3 py-2 pr-8 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:s,children:[e.jsx("option",{value:"",children:"Selecciona una tienda"}),o.map(N=>e.jsxs("option",{value:N.id,children:[N.nombre," (",N.codigo,")"]},N.id))]}),x&&e.jsx("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-md",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-store-line text-blue-600 mt-0.5 mr-2"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-blue-800",children:["Tienda Seleccionada: ",x.nombre]}),e.jsxs("p",{className:"text-sm text-blue-700",children:["CÃ³digo: ",x.codigo]})]})]})})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("i",{className:"ri-information-line text-blue-600 mt-0.5 mr-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-800 mb-1",children:"Â¿QuÃ© sucederÃ¡ al asignar la tienda?"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"â€¢ El usuario podrÃ¡ iniciar sesiÃ³n normalmente"}),e.jsx("li",{children:"â€¢ TendrÃ¡ acceso a todas las funcionalidades del sistema"}),e.jsx("li",{children:"â€¢ La tienda seleccionada serÃ¡ su tienda por defecto"}),e.jsx("li",{children:"â€¢ PodrÃ¡ cambiar de tienda si tiene permisos"})]})]})]})})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end space-x-3",children:[e.jsx("button",{onClick:l,disabled:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 whitespace-nowrap",children:"Cancelar"}),e.jsx("button",{onClick:C,disabled:s||!p||v||o.length===0,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:s?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Asignando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-check-line mr-2"}),"Asignar Tienda"]})})]})]})})}function Z(){const[a,l]=i.useState([]),[d,o]=i.useState(!0),[g,p]=i.useState(!1),[y,s]=i.useState(null),[h,v]=i.useState(!1),[w,f]=i.useState(null);i.useEffect(()=>{m()},[]);const m=async()=>{try{o(!0);const{data:t,error:r}=await u.from("usuarios").select(`
          *,
          usuario_tienda_actual(
            tienda_id,
            tiendas(
              id,
              nombre
            )
          ),
          usuario_tiendas(
            tienda_id,
            tiendas(
              id,
              nombre,
              codigo
            )
          )
        `).order("created_at",{ascending:!1});if(r)throw console.error("Error en query:",r),r;console.log("ðŸ“Š Datos crudos de Supabase:",t);const E=(t||[]).map(k=>{console.log("ðŸ‘¤ Usuario:",k.email),console.log("ðŸ“¦ usuario_tiendas raw:",k.usuario_tiendas);let c=null;if(k.usuario_tienda_actual){const T=Array.isArray(k.usuario_tienda_actual)?k.usuario_tienda_actual[0]:k.usuario_tienda_actual;T?.tiendas&&(c=Array.isArray(T.tiendas)?T.tiendas[0]?.nombre:T.tiendas?.nombre)}let S=[];return k.usuario_tiendas&&Array.isArray(k.usuario_tiendas)&&(S=k.usuario_tiendas.filter(T=>T.tiendas).map(T=>(console.log("ðŸª Procesando tienda:",T.tiendas),{id:T.tiendas.id,nombre:T.tiendas.nombre,codigo:T.tiendas.codigo}))),console.log("âœ… Tiendas asignadas procesadas:",S),{...k,tienda_nombre:c,tiendas_asignadas:S}});console.log("âœ… Usuarios procesados:",E),l(E)}catch(t){console.error("Error cargando usuarios:",t);try{const{data:r,error:E}=await u.from("usuarios").select("*").order("created_at",{ascending:!1});!E&&r&&l(r.map(k=>({...k,tienda_nombre:null,tiendas_asignadas:[]})))}catch(r){console.error("Error en fallback:",r)}}finally{o(!1)}},C=t=>{s(t),p(!0)},x=async t=>{if(confirm("Â¿EstÃ¡ seguro de eliminar este usuario?"))try{const{error:r}=await u.from("usuarios").delete().eq("id",t);if(r)throw r;m()}catch(r){console.error("Error eliminando usuario:",r),alert("Error al eliminar el usuario")}},N=async t=>{try{const{error:r}=await u.from("usuarios").update({activo:!t.activo}).eq("id",t.id);if(r)throw r;m()}catch(r){console.error("Error actualizando estado:",r),alert("Error al actualizar el estado del usuario")}},b=t=>{f(t),v(!0)};return d?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Usuarios del Sistema"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Gestiona los usuarios y sus permisos"})]}),e.jsxs("button",{onClick:()=>{s(null),p(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center cursor-pointer whitespace-nowrap",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Nuevo Usuario"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuario"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rol"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tiendas Asignadas"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha Registro"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"ri-user-line text-blue-600 text-lg"})}),e.jsx("div",{className:"ml-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.nombre_completo||"Sin nombre"})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:t.email})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-purple-100 text-purple-800",children:t.rol||"Sin rol"})}),e.jsx("td",{className:"px-6 py-4",children:t.tiendas_asignadas&&t.tiendas_asignadas.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:t.tiendas_asignadas.map(r=>e.jsxs("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-teal-100 text-teal-800",title:r.nombre,children:[e.jsx("i",{className:"ri-store-2-line mr-1"}),r.codigo]},r.id))}):e.jsxs("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-600",children:[e.jsx("i",{className:"ri-alert-line mr-1"}),"Sin tiendas"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>N(t),className:"cursor-pointer",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${t.activo?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.activo?"Activo":"Inactivo"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>b(t),className:"text-teal-600 hover:text-teal-900 cursor-pointer",title:"Asignar Tienda",children:e.jsx("i",{className:"ri-store-2-line text-lg"})}),e.jsx("button",{onClick:()=>C(t),className:"text-blue-600 hover:text-blue-900 cursor-pointer",title:"Editar",children:e.jsx("i",{className:"ri-edit-line text-lg"})}),e.jsx("button",{onClick:()=>x(t.id),className:"text-red-600 hover:text-red-900 cursor-pointer",title:"Eliminar",children:e.jsx("i",{className:"ri-delete-bin-line text-lg"})})]})})]},t.id))})]})}),a.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-user-line text-gray-400 text-5xl mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No hay usuarios registrados"})]})]}),g&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:y?"Editar Usuario":"Nuevo Usuario"}),e.jsx("button",{onClick:()=>{p(!1),s(null)},className:"text-gray-400 hover:text-gray-600 cursor-pointer",children:e.jsx("i",{className:"ri-close-line text-2xl"})})]}),e.jsx(X,{usuario:y,onClose:()=>{p(!1),s(null)},onSuccess:()=>{m(),p(!1),s(null)}})]})})}),h&&w&&e.jsx(V,{usuario:w,onClose:()=>{v(!1),f(null)},onSuccess:()=>{v(!1),f(null),m()}})]})}function ee(){const[a,l]=i.useState([]),[d,o]=i.useState(!0),[g,p]=i.useState(""),[y,s]=i.useState(!1),[h,v]=i.useState(null),{showNotification:w}=F();i.useEffect(()=>{f()},[]);const f=async()=>{try{o(!0);const b=await R.obtenerUsuariosPendientes();l(b)}catch(b){console.error("Error cargando usuarios pendientes:",b),w("Error al cargar usuarios pendientes","error")}finally{o(!1)}},m=b=>{v(b),s(!0)},C=async b=>{if(confirm(`Â¿EstÃ¡s seguro de que deseas rechazar el registro de ${b.nombre_completo}?`))try{await R.rechazarRegistro(b.id),w("Registro rechazado exitosamente","success"),await f()}catch(t){console.error("Error rechazando registro:",t),w("Error al rechazar el registro","error")}},x=()=>{s(!1),v(null),f(),w("Tienda asignada exitosamente","success")},N=a.filter(b=>b.nombre_completo.toLowerCase().includes(g.toLowerCase())||b.email.toLowerCase().includes(g.toLowerCase()));return d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Usuarios Pendientes"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Usuarios que necesitan asignaciÃ³n de tienda para acceder al sistema"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar usuarios...",value:g,onChange:b=>p(b.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),e.jsx("button",{onClick:f,className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-md text-sm font-medium whitespace-nowrap",title:"Actualizar lista",children:e.jsx("i",{className:"ri-refresh-line"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("i",{className:"ri-time-line text-yellow-600 text-xl"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Usuarios Pendientes"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:a.length})]})]})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("i",{className:"ri-user-add-line text-blue-600 text-xl"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Registros Hoy"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:a.filter(b=>{const t=new Date().toDateString(),r=new Date(b.created_at).toDateString();return t===r}).length})]})]})}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("i",{className:"ri-check-line text-green-600 text-xl"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Usuarios Activos"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:a.filter(b=>b.activo).length})]})]})})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuario"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rol"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha Registro"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map(b=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:b.nombre_completo}),e.jsx("div",{className:"text-sm text-gray-500",children:b.email})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:b.rol})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-2 w-2 bg-yellow-400 rounded-full mr-2"}),e.jsx("span",{className:"text-sm text-yellow-700 font-medium",children:"Pendiente de tienda"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{children:[e.jsx("div",{children:new Date(b.created_at).toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-400",children:new Date(b.created_at).toLocaleTimeString()})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx($,{permission:"seguridad:usuarios:asignar_tienda",onClick:()=>m(b),className:"text-green-600 hover:text-green-900",title:"Asignar tienda",children:e.jsx("i",{className:"ri-store-line"})}),e.jsx($,{permission:"seguridad:usuarios:rechazar_registro",onClick:()=>C(b),className:"text-red-600 hover:text-red-900",title:"Rechazar registro",children:e.jsx("i",{className:"ri-close-line"})})]})})]},b.id))})]})}),N.length===0&&e.jsx("div",{className:"text-center py-12",children:a.length===0?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-check-double-line text-green-400 text-4xl mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Â¡Excelente! No hay usuarios pendientes"}),e.jsx("p",{className:"text-gray-500",children:"Todos los usuarios registrados tienen tienda asignada."})]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-search-line text-gray-400 text-4xl mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron usuarios"}),e.jsx("p",{className:"text-gray-500",children:"No hay usuarios que coincidan con tu bÃºsqueda."})]})})]}),y&&h&&e.jsx(V,{usuario:h,onClose:()=>{s(!1),v(null)},onSuccess:x})]})}function se({rol:a,onClose:l,onSave:d}){const[o,g]=i.useState({nombre:"",descripcion:""}),[p,y]=i.useState([]),[s,h]=i.useState([]),[v,w]=i.useState(!1),[f,m]=i.useState("");i.useEffect(()=>{C(),a&&(g({nombre:a.nombre,descripcion:a.descripcion}),x(a.id))},[a]);const C=async()=>{try{const{data:t,error:r}=await u.from("permisos").select("*").order("nombre");if(r)throw r;y(t||[])}catch(t){console.error("Error cargando permisos:",t)}},x=async t=>{try{const{data:r,error:E}=await u.from("rol_permisos").select("permiso_id").eq("rol_id",t);if(E)throw E;const k=r?.map(c=>c.permiso_id)||[];h(k)}catch(r){console.error("Error cargando permisos del rol:",r)}},N=(t,r)=>{h(r?[...s,t]:s.filter(E=>E!==t))},b=async t=>{t.preventDefault(),m(""),w(!0);try{let r;if(a){const{error:E}=await u.from("roles").update({nombre:o.nombre,descripcion:o.descripcion}).eq("id",a.id);if(E)throw E;r=a.id}else{const{data:E,error:k}=await u.from("roles").insert([{nombre:o.nombre,descripcion:o.descripcion}]).select().single();if(k)throw k;r=E.id}if(a&&await u.from("rol_permisos").delete().eq("rol_id",r),s.length>0){const E=s.map(c=>({rol_id:r,permiso_id:c})),{error:k}=await u.from("rol_permisos").insert(E);if(k)throw k}d()}catch(r){console.error("Error guardando rol:",r),m(r.message||"Error al guardar el rol")}finally{w(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:a?"Editar Rol":"Nuevo Rol"}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[f&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:f}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Rol"}),e.jsx("input",{type:"text",required:!0,value:o.nombre,onChange:t=>g({...o,nombre:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"DescripciÃ³n"}),e.jsx("input",{type:"text",value:o.descripcion,onChange:t=>g({...o,descripcion:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Permisos"}),e.jsx("div",{className:"border border-gray-200 rounded-md p-4 max-h-60 overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:p.map(t=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("input",{type:"checkbox",id:`permiso-${t.id}`,checked:s.includes(t.id),onChange:r=>N(t.id,r.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded mt-0.5"}),e.jsxs("label",{htmlFor:`permiso-${t.id}`,className:"ml-2 block text-sm",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.nombre}),t.descripcion&&e.jsx("div",{className:"text-gray-500 text-xs",children:t.descripcion})]})]},t.id))})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md whitespace-nowrap",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:v,className:`px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-7

              00 rounded-md disabled:opacity-50 whitespace-nowrap`,children:v?"Guardando...":"Guardar"})]})]})]})})}function re(){const[a,l]=i.useState([]),[d,o]=i.useState(!0),[g,p]=i.useState(!1),[y,s]=i.useState(null),[h,v]=i.useState("");i.useEffect(()=>{w()},[]);const w=async()=>{try{const{data:x,error:N}=await u.from("roles").select("*").order("nombre");if(N)throw N;l(x||[])}catch(x){console.error("Error cargando roles:",x)}finally{o(!1)}},f=x=>{s(x),p(!0)},m=async x=>{if(confirm("Â¿EstÃ¡s seguro de que deseas eliminar este rol?"))try{const{data:N}=await u.from("usuarios").select("id").eq("rol",a.find(t=>t.id===x)?.nombre);if(N&&N.length>0){alert("No se puede eliminar este rol porque hay usuarios asignados a Ã©l.");return}const{error:b}=await u.from("roles").delete().eq("id",x);if(b)throw b;await w()}catch(N){console.error("Error eliminando rol:",N),alert("Error al eliminar el rol")}},C=a.filter(x=>x.nombre.toLowerCase().includes(h.toLowerCase())||x.descripcion.toLowerCase().includes(h.toLowerCase()));return d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar roles...",value:h,onChange:x=>v(x.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),e.jsxs("button",{onClick:()=>{s(null),p(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium whitespace-nowrap",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Nuevo Rol"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map(x=>e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:e.jsx("i",{className:"ri-shield-user-line text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:x.nombre}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Creado: ",new Date(x.created_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>f(x),className:"text-blue-600 hover:text-blue-900",title:"Editar",children:e.jsx("i",{className:"ri-edit-line"})}),e.jsx("button",{onClick:()=>m(x.id),className:"text-red-600 hover:text-red-900",title:"Eliminar",children:e.jsx("i",{className:"ri-delete-bin-line"})})]})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:x.descripcion||"Sin descripciÃ³n"}),e.jsx("div",{className:"flex items-center justify-between text-sm",children:e.jsxs("span",{className:"text-gray-500",children:["Ãšltima actualizaciÃ³n: ",new Date(x.updated_at).toLocaleDateString()]})})]},x.id))}),C.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-shield-user-line text-gray-400 text-4xl mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay roles"}),e.jsx("p",{className:"text-gray-500",children:"No se encontraron roles con los filtros aplicados."})]}),g&&e.jsx(se,{rol:y,onClose:()=>{p(!1),s(null)},onSave:()=>{p(!1),s(null),w()}})]})}function ae({permiso:a,onClose:l,onSave:d}){const[o,g]=i.useState({nombre:"",descripcion:""}),[p,y]=i.useState(!1),[s,h]=i.useState("");i.useEffect(()=>{a&&g({nombre:a.nombre,descripcion:a.descripcion})},[a]);const v=async w=>{w.preventDefault(),h(""),y(!0);try{if(a){const{error:f}=await u.from("permisos").update({nombre:o.nombre,descripcion:o.descripcion,updated_at:new Date().toISOString()}).eq("id",a.id);if(f)throw f}else{const{error:f}=await u.from("permisos").insert([{nombre:o.nombre,descripcion:o.descripcion,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]);if(f)throw f}d()}catch(f){console.error("Error guardando permiso:",f),h(f.message||"Error al guardar el permiso")}finally{y(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:a?"Editar Permiso":"Nuevo Permiso"}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[s&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:s}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Permiso"}),e.jsx("input",{type:"text",required:!0,value:o.nombre,onChange:w=>g({...o,nombre:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"ej: dashboard:read, users:write"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Usa formato mÃ³dulo:acciÃ³n (ej: dashboard:read, users:write)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"DescripciÃ³n"}),e.jsx("textarea",{value:o.descripcion,onChange:w=>g({...o,descripcion:w.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Describe quÃ© permite hacer este permiso..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md whitespace-nowrap",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:p,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md disabled:opacity-50 whitespace-nowrap",children:p?"Guardando...":"Guardar"})]})]})]})})}function te(){const[a,l]=i.useState([]),[d,o]=i.useState(!0),[g,p]=i.useState(!1),[y,s]=i.useState(null),[h,v]=i.useState(""),{notification:w,showSuccess:f,showError:m,hideNotification:C}=F();i.useEffect(()=>{x()},[]);const x=async()=>{try{const{data:r,error:E}=await u.from("permisos").select("*").order("nombre");if(E)throw E;l(r||[])}catch(r){console.error("Error cargando permisos:",r)}finally{o(!1)}},N=r=>{s(r),p(!0)},b=async r=>{if(confirm("Â¿EstÃ¡s seguro de que deseas eliminar este permiso?"))try{const{data:E}=await u.from("rol_permisos").select("id").eq("permiso_id",r);if(E&&E.length>0){m("Error","No se puede eliminar este permiso porque estÃ¡ asignado a uno o mÃ¡s roles.");return}const{error:k}=await u.from("permisos").delete().eq("id",r);if(k)throw k;f("Ã‰xito","Permiso eliminado correctamente"),await x()}catch(E){console.error("Error eliminando permiso:",E),m("Error","Error al eliminar el permiso")}},t=a.filter(r=>r.nombre.toLowerCase().includes(h.toLowerCase())||r.descripcion.toLowerCase().includes(h.toLowerCase()));return d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar permisos...",value:h,onChange:r=>v(r.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),e.jsxs("button",{onClick:()=>{s(null),p(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium whitespace-nowrap",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Nuevo Permiso"]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Permiso"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"DescripciÃ³n"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha CreaciÃ³n"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(r=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:e.jsx("i",{className:"ri-key-line text-green-600"})}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:r.nombre})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-900",children:r.descripcion||"Sin descripciÃ³n"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(r.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("button",{onClick:()=>N(r),className:"text-blue-600 hover:text-blue-900",title:"Editar",children:e.jsx("i",{className:"ri-edit-line"})}),e.jsx("button",{onClick:()=>b(r.id),className:"text-red-600 hover:text-red-900",title:"Eliminar",children:e.jsx("i",{className:"ri-delete-bin-line"})})]})})]},r.id))})]})}),t.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-key-line text-gray-400 text-4xl mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay permisos"}),e.jsx("p",{className:"text-gray-500",children:"No se encontraron permisos con los filtros aplicados."})]})]}),g&&e.jsx(ae,{permiso:y,onClose:()=>{p(!1),s(null)},onSave:()=>{p(!1),s(null),x()}}),e.jsx(G,{isOpen:w.isOpen,type:w.type,message:w.message,onClose:C})]})}function ie({onSave:a,className:l=""}){const[d,o]=i.useState([]),[g,p]=i.useState([]),[y,s]=i.useState([]),[h,v]=i.useState(!0),[w,f]=i.useState(!1),[m,C]=i.useState(""),[x,N]=i.useState("all"),[b,t]=i.useState(""),{notification:r,showNotification:E,hideNotification:k}=F();i.useEffect(()=>{c()},[]);const c=async()=>{try{v(!0),t("");const{data:n,error:j}=await u.from("roles").select("*").order("nombre");if(j)throw j;const{data:_,error:D}=await u.from("permisos").select("*").order("nombre");if(D)throw D;const{data:P,error:z}=await u.from("rol_permisos").select("rol_id, permiso_id");if(z)throw z;o(n||[]),p(_||[]),s(P||[])}catch(n){console.error("Error al cargar datos:",n),t("Error al cargar los datos de permisos")}finally{v(!1)}},S=i.useMemo(()=>{const n=new Map;return g.forEach(j=>{const _=j.nombre.split(":")[0];n.has(_)||n.set(_,[]),n.get(_).push(j)}),Array.from(n.entries()).map(([j,_])=>({module:j,permissions:_.sort((D,P)=>D.nombre.localeCompare(P.nombre))}))},[g]),T=i.useMemo(()=>{let n=S;return x!=="all"&&(n=n.filter(j=>j.module===x)),m&&(n=n.map(j=>({...j,permissions:j.permissions.filter(_=>_.nombre.toLowerCase().includes(m.toLowerCase())||_.descripcion.toLowerCase().includes(m.toLowerCase()))})).filter(j=>j.permissions.length>0)),n},[S,x,m]),A=(n,j)=>y.some(_=>_.rol_id===n&&_.permiso_id===j),L=(n,j)=>{const _=A(n,j);s(_?D=>D.filter(P=>!(P.rol_id===n&&P.permiso_id===j)):D=>[...D,{rol_id:n,permiso_id:j}])},q=(n,j)=>{const _=S.find(P=>P.module===j)?.permissions||[];if(_.every(P=>A(n,P.id)))s(P=>P.filter(z=>z.rol_id!==n||!_.some(B=>B.id===z.permiso_id)));else{const P=_.filter(z=>!A(n,z.id)).map(z=>({rol_id:n,permiso_id:z.id}));s(z=>[...z,...P])}},U=(n,j)=>{s(P=>P.filter(z=>z.rol_id!==n));let _=[];switch(j){case"admin":_=g.map(P=>P.nombre);break;case"vendedor":_=["dashboard:view","clientes:view:own","clientes:create","clientes:edit:own","cotizaciones:view:own","cotizaciones:create","cotizaciones:edit:own","cotizaciones:print","pedidos:view:own","pedidos:create","pedidos:edit:own","pedidos:print","productos:view","inventario:view","seguimiento:view:own"];break;case"supervisor":_=["dashboard:view","dashboard:analytics","clientes:view","clientes:create","clientes:edit","clientes:export","cotizaciones:view","cotizaciones:create","cotizaciones:edit","cotizaciones:approve","cotizaciones:reject","cotizaciones:convert","cotizaciones:print","cotizaciones:export","pedidos:view","pedidos:create","pedidos:edit","pedidos:confirm","pedidos:print","productos:view","inventario:view","seguimiento:view","seguimiento:edit","tareas:view","tareas:create","tareas:edit","tareas:assign"];break;case"contador":_=["dashboard:view","dashboard:analytics","dashboard:reports","clientes:view","clientes:export","cotizaciones:view","cotizaciones:export","pedidos:view","pedidos:invoice","pedidos:print","facturas:view","facturas:create","facturas:edit","facturas:send","facturas:cancel","facturas:print","facturas:export","facturas:config","seguimiento:view"];break;case"inventario":_=["dashboard:view","productos:view","productos:create","productos:edit","productos:bom","productos:export","inventario:view","inventario:create","inventario:edit","inventario:adjust","inventario:transfer","inventario:import","inventario:export","inventario:categories","inventario:thresholds","mantenimiento:view","mantenimiento:alerts","mantenimiento:thresholds","mantenimiento:replenishment","mantenimiento:predictions","optimizador:view","optimizador:create","optimizador:optimize","optimizador:export"];break;case"produccion":_=["dashboard:view","pedidos:view","pedidos:print","productos:view","productos:bom","inventario:view","inventario:adjust","seguimiento:view","seguimiento:edit","tareas:view","tareas:edit","tareas:complete","optimizador:view","optimizador:create","optimizador:optimize","optimizador:export"];break;case"lectura":_=["dashboard:view","clientes:view","clientes:export","cotizaciones:view","cotizaciones:print","cotizaciones:export","pedidos:view","pedidos:print","productos:view","inventario:view","facturas:view","facturas:print","facturas:export","seguimiento:view","tareas:view","mantenimiento:view"];break}const D=g.filter(P=>_.includes(P.nombre)).map(P=>({rol_id:n,permiso_id:P.id}));s(P=>[...P,...D])},M=async()=>{try{f(!0),t("");const{error:n}=await u.from("rol_permisos").delete().neq("id",0);if(n)throw n;if(y.length>0){const{error:j}=await u.from("rol_permisos").insert(y);if(j)throw j}E("Permisos guardados correctamente","success"),a?.()}catch(n){console.error("Error al guardar permisos:",n),t("Error al guardar los cambios"),E("Error al guardar los permisos","error")}finally{f(!1)}};return h?e.jsx("div",{className:`bg-white rounded-lg shadow p-6 ${l}`,children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4 mb-4"}),e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((n,j)=>e.jsx("div",{className:"h-4 bg-gray-200 rounded"},j))})]})}):e.jsxs(e.Fragment,{children:[e.jsx(G,{message:r.message,type:r.type,isVisible:r.isVisible,onClose:k}),e.jsxs("div",{className:`bg-white rounded-lg shadow ${l}`,children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Matriz de Permisos"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Gestiona los permisos por rol de forma visual"})]}),e.jsx("button",{onClick:M,disabled:w,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center whitespace-nowrap",children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Guardando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-save-line mr-2"}),"Guardar Cambios"]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Buscar permisos...",value:m,onChange:n=>C(n.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})}),e.jsx("div",{className:"sm:w-48",children:e.jsxs("select",{value:x,onChange:n=>N(n.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"all",children:"Todos los mÃ³dulos"}),S.map(n=>e.jsx("option",{value:n.module,children:n.module.charAt(0).toUpperCase()+n.module.slice(1)},n.module))]})})]}),b&&e.jsx("div",{className:"mt-4 bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-error-warning-line text-red-500 mr-2"}),e.jsx("span",{className:"text-red-700 text-sm",children:b})]})})]}),e.jsxs("div",{className:"p-6 border-b border-gray-200 bg-gray-50",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Plantillas RÃ¡pidas"}),e.jsx("div",{className:"space-y-3",children:d.map(n=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 min-w-[120px]",children:[n.nombre,":"]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>U(n.id,"admin"),className:"px-3 py-1.5 text-xs bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 whitespace-nowrap",title:"Acceso total al sistema",children:[e.jsx("i",{className:"ri-admin-line mr-1"}),"Admin"]}),e.jsxs("button",{onClick:()=>U(n.id,"vendedor"),className:"px-3 py-1.5 text-xs bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 whitespace-nowrap",title:"Ventas y cotizaciones propias",children:[e.jsx("i",{className:"ri-user-line mr-1"}),"Vendedor"]}),e.jsxs("button",{onClick:()=>U(n.id,"supervisor"),className:"px-3 py-1.5 text-xs bg-green-100 text-green-700 rounded-lg hover:bg-green-200 whitespace-nowrap",title:"SupervisiÃ³n de ventas y operaciones",children:[e.jsx("i",{className:"ri-shield-user-line mr-1"}),"Supervisor"]}),e.jsxs("button",{onClick:()=>U(n.id,"contador"),className:"px-3 py-1.5 text-xs bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200 whitespace-nowrap",title:"FacturaciÃ³n y reportes financieros",children:[e.jsx("i",{className:"ri-calculator-line mr-1"}),"Contador"]}),e.jsxs("button",{onClick:()=>U(n.id,"inventario"),className:"px-3 py-1.5 text-xs bg-orange-100 text-orange-700 rounded-lg hover:bg-orange-200 whitespace-nowrap",title:"GestiÃ³n de inventario y productos",children:[e.jsx("i",{className:"ri-archive-line mr-1"}),"Inventario"]}),e.jsxs("button",{onClick:()=>U(n.id,"produccion"),className:"px-3 py-1.5 text-xs bg-indigo-100 text-indigo-700 rounded-lg hover:bg-indigo-200 whitespace-nowrap",title:"ProducciÃ³n, tareas y optimizador",children:[e.jsx("i",{className:"ri-tools-line mr-1"}),"ProducciÃ³n"]}),e.jsxs("button",{onClick:()=>U(n.id,"lectura"),className:"px-3 py-1.5 text-xs bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 whitespace-nowrap",title:"Solo visualizaciÃ³n de datos",children:[e.jsx("i",{className:"ri-eye-line mr-1"}),"Solo Lectura"]})]})]},n.id))})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sticky left-0 bg-gray-50 z-10",children:"Permiso"}),d.map(n=>e.jsx("th",{className:"px-3 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[100px]",children:n.nombre},n.id))]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T.map(n=>e.jsxs(J.Fragment,{children:[e.jsxs("tr",{className:"bg-blue-50",children:[e.jsx("td",{className:"px-6 py-3 text-sm font-medium text-blue-900 sticky left-0 bg-blue-50 z-10",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-folder-line mr-2"}),n.module.charAt(0).toUpperCase()+n.module.slice(1)]})}),d.map(j=>e.jsx("td",{className:"px-3 py-3 text-center",children:e.jsx("button",{onClick:()=>q(j.id,n.module),className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded hover:bg-blue-200 whitespace-nowrap",children:"Todo"})},j.id))]}),n.permissions.map(j=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-3 sticky left-0 bg-white z-10",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:j.nombre}),e.jsx("div",{className:"text-xs text-gray-500",children:j.descripcion})]})}),d.map(_=>e.jsx("td",{className:"px-3 py-3 text-center",children:e.jsx("input",{type:"checkbox",checked:A(_.id,j.id),onChange:()=>L(_.id,j.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer"})},_.id))]},j.id))]},n.module))})]})}),T.length===0&&e.jsxs("div",{className:"p-6 text-center text-gray-500",children:[e.jsx("i",{className:"ri-search-line text-2xl mb-2"}),e.jsx("p",{children:"No se encontraron permisos que coincidan con los filtros"})]})]})]})}function O({permission:a,role:l,module:d,action:o,children:g,fallback:p=null}){const{hasPermission:y,hasRole:s,canRead:h,canWrite:v,canDelete:w,isAuthenticated:f,loading:m}=I();return!f||m?e.jsx(e.Fragment,{children:p}):(()=>{if(l&&!s(l)||a&&!y(a))return!1;if(d&&o)switch(o){case"read":return h(d);case"write":return v(d);case"delete":return w(d);default:return!1}return!0})()?e.jsx(e.Fragment,{children:g}):e.jsx(e.Fragment,{children:p})}function me(){const[a,l]=i.useState("usuarios"),[d,o]=i.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[g,p]=i.useState(!1),[y,s]=i.useState(null),h=[{id:"usuarios",name:"Usuarios",icon:"ri-user-line"},{id:"pendientes",name:"Usuarios Pendientes",icon:"ri-time-line",permission:"seguridad:usuarios:view_pendientes"},{id:"roles",name:"Roles",icon:"ri-shield-user-line"},{id:"permisos",name:"Permisos",icon:"ri-key-line"},{id:"matriz",name:"Matriz de Permisos",icon:"ri-grid-line"},{id:"password",name:"Cambiar ContraseÃ±a",icon:"ri-lock-password-line"}],v=async m=>{if(m.preventDefault(),s(null),!d.newPassword||!d.confirmPassword){s({type:"error",text:"Por favor complete todos los campos"});return}if(d.newPassword.length<6){s({type:"error",text:"La contraseÃ±a debe tener al menos 6 caracteres"});return}if(d.newPassword!==d.confirmPassword){s({type:"error",text:"Las contraseÃ±as no coinciden"});return}p(!0);try{const{error:C}=await u.auth.updateUser({password:d.newPassword});if(C)throw C;s({type:"success",text:"ContraseÃ±a actualizada exitosamente"}),o({currentPassword:"",newPassword:"",confirmPassword:""})}catch(C){console.error("Error cambiando contraseÃ±a:",C),s({type:"error",text:C.message||"Error al cambiar la contraseÃ±a"})}finally{p(!1)}},w=()=>e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Cambiar ContraseÃ±a"}),y&&e.jsx("div",{className:`p-4 rounded-lg mb-4 ${y.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:`${y.type==="success"?"ri-check-line":"ri-error-warning-line"} mr-2`}),y.text]})}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nueva ContraseÃ±a"}),e.jsx("input",{type:"password",value:d.newPassword,onChange:m=>o(C=>({...C,newPassword:m.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ingrese la nueva contraseÃ±a",minLength:6}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"MÃ­nimo 6 caracteres"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Nueva ContraseÃ±a"}),e.jsx("input",{type:"password",value:d.confirmPassword,onChange:m=>o(C=>({...C,confirmPassword:m.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Confirme la nueva contraseÃ±a"})]}),e.jsx("button",{type:"submit",disabled:g,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors cursor-pointer whitespace-nowrap",children:g?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Actualizando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-lock-password-line mr-2"}),"Cambiar ContraseÃ±a"]})})]})]})}),f=()=>{switch(a){case"usuarios":return e.jsx(Z,{});case"pendientes":return e.jsx(O,{permission:"seguridad:usuarios:view_pendientes",children:e.jsx(ee,{})});case"roles":return e.jsx(re,{});case"permisos":return e.jsx(te,{});case"matriz":return e.jsx(ie,{onSave:()=>{console.log("Permisos guardados exitosamente")}});case"password":return w();default:return null}};return e.jsx(K,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Seguridad"}),e.jsx("p",{className:"text-gray-600",children:"Gestiona usuarios, roles y permisos del sistema"})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8 overflow-x-auto",children:h.map(m=>m.permission?e.jsx(O,{permission:m.permission,children:e.jsxs("button",{onClick:()=>l(m.id),className:`py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap flex items-center cursor-pointer ${a===m.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("i",{className:`${m.icon} mr-2`}),m.name]})},m.id):e.jsxs("button",{onClick:()=>l(m.id),className:`py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap flex items-center cursor-pointer ${a===m.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("i",{className:`${m.icon} mr-2`}),m.name]},m.id))})}),e.jsx("div",{className:"mt-6",children:f()})]})})}export{me as default};
//# sourceMappingURL=page-BsaPDgXr.js.map
